{"version":3,"sources":["ThreeEditor/js/libs/ui.js","ThreeEditor/js/Command.js","ThreeEditor/js/libs/ui.three.js","ThreeEditor/js/libs/loaders/RGBELoader.js","ThreeEditor/js/commands/MoveObjectCommand.js","ThreeEditor/js/libs/loaders/TGALoader.js","ThreeEditor/js/Sidebar.Geometry.BufferGeometry.js","ThreeEditor/js/Sidebar.Geometry.Modifiers.js","ThreeEditor/js/commands/SetGeometryCommand.js","ThreeEditor/js lazy /^/Sidebar/.Geometry/..*/.js$/ groupOptions: {} namespace object","ThreeEditor/js/Config.js","ThreeEditor/js/commands/AddObjectCommand.js","ThreeEditor/js/commands/SetUuidCommand.js","ThreeEditor/js/commands/SetValueCommand.js","ThreeEditor/js/commands/SetSceneCommand.js","ThreeEditor/js/LoaderUtils.js","ThreeEditor/js/Loader.js","ThreeEditor/js/commands/AddScriptCommand.js","ThreeEditor/js/commands/MultiCmdsCommand.js","ThreeEditor/js/commands/RemoveObjectCommand.js","ThreeEditor/js/commands/RemoveScriptCommand.js","ThreeEditor/js/commands/SetColorCommand.js","ThreeEditor/js/commands/SetGeometryValueCommand.js","ThreeEditor/js/commands/SetMaterialColorCommand.js","ThreeEditor/js/commands/SetMaterialCommand.js","ThreeEditor/js/commands/SetMaterialMapCommand.js","ThreeEditor/js/commands/SetMaterialValueCommand.js","ThreeEditor/js/commands/SetMaterialVectorCommand.js","ThreeEditor/js/commands/SetPositionCommand.js","ThreeEditor/js/commands/SetRotationCommand.js","ThreeEditor/js/commands/SetScaleCommand.js","ThreeEditor/js/commands/SetScriptValueCommand.js","ThreeEditor/js/History.js","ThreeEditor/js/Strings.js","ThreeEditor/js/Storage.js","ThreeEditor/js/Editor.js","ThreeEditor/js/libs/controls/TransformControls.js","ThreeEditor/js/EditorControls.js","ThreeEditor/js/Viewport.Camera.js","ThreeEditor/js/Viewport.Info.js","ThreeEditor/js/Viewport.ViewHelper.js","ThreeEditor/js/libs/environments/RoomEnvironment.js","ThreeEditor/js/Viewport.js","ThreeEditor/js/Toolbar.js","ThreeEditor/js/Sidebar.Scene.js","ThreeEditor/js/Sidebar.Object.js","ThreeEditor/js/libs/helpers/VertexNormalsHelper.js","ThreeEditor/js/Sidebar.Geometry.js","ThreeEditor/js/Sidebar.Material.BooleanProperty.js","ThreeEditor/js/Sidebar.Material.ColorProperty.js","ThreeEditor/js/Sidebar.Material.ConstantProperty.js","ThreeEditor/js/Sidebar.Material.MapProperty.js","ThreeEditor/js/Sidebar.Material.NumberProperty.js","ThreeEditor/js/Sidebar.Material.Program.js","ThreeEditor/js/Sidebar.Material.js","ThreeEditor/js/Sidebar.Properties.js","ThreeEditor/js/Sidebar.Animation.js","ThreeEditor/js/Sidebar.Project.Renderer.js","ThreeEditor/js/Sidebar.Project.js","ThreeEditor/js/Sidebar.Settings.Viewport.js","ThreeEditor/js/Sidebar.Settings.Shortcuts.js","ThreeEditor/js/Sidebar.Settings.History.js","ThreeEditor/js/Sidebar.Settings.js","ThreeEditor/js/Sidebar.js","ThreeEditor/js/Menubar.Add.js","ThreeEditor/js/Menubar.Edit.js","ThreeEditor/js/Menubar.View.js","ThreeEditor/js/Menubar.File.js","ThreeEditor/js/Menubar.Help.js","ThreeEditor/js/Menubar.Status.js","ThreeEditor/js/Menubar.js","ThreeEditor/js/Resizer.js","ThreeEditor/components/SampleComponent.tsx","ThreeEditor/js/libs/csg/csg-lib.js","ThreeEditor/js/libs/csg/three-csg.js","util/parseZone/ZoneConstructorController.ts","util/parseZone/parseZone.ts","components/ZoneManagerPanel/GeometryInput.tsx","components/ZoneManagerPanel/OperationInput.tsx","components/ZoneManagerPanel/BooleanAlgebraRow.tsx","components/ZoneManagerPanel/ZoneManagerPanel.tsx","ThreeEditor/ThreeEditor.tsx","ThreeEditor/main.js","App.tsx","reportWebVitals.ts","index.tsx"],"names":["UIElement","dom","this","i","arguments","length","argument","appendChild","console","error","removeChild","children","lastChild","id","name","className","classList","add","remove","style","array","value","disabled","textContent","innerHTML","element","Array","prototype","indexOf","call","forEach","property","method","substr","toUpperCase","setStyle","event","callback","addEventListener","toLowerCase","bind","UISpan","document","createElement","UIDiv","UIRow","UIPanel","UIText","text","cursor","display","setValue","undefined","UIInput","padding","border","setAttribute","stopPropagation","UITextArea","spellcheck","keyCode","preventDefault","selectionStart","substring","selectionEnd","UISelect","boolean","multiple","options","selected","firstChild","key","option","String","UICheckbox","type","checked","UIColor","width","height","backgroundColor","exception","parseInt","hex","toString","slice","UINumber","number","min","Infinity","max","precision","step","unit","nudge","scope","changeEvent","createEvent","initEvent","distance","onMouseDownValue","pointer","x","y","prevPointer","onMouseMove","currentValue","clientX","clientY","shiftKey","Math","dispatchEvent","onMouseUp","removeEventListener","abs","focus","select","onTouchMove","touches","pageX","pageY","onTouchEnd","onBlur","blur","getValue","parseFloat","toFixed","UIInteger","UIBreak","UIHorizontalRule","UIButton","UITabbedPanel","tabs","panels","tabsDiv","setClass","panelsDiv","tab","panel","find","item","removeClass","setDisplay","addClass","label","items","UITab","setId","push","parent","Command","editor","inMemory","updatable","output","json","renderer","RGBELoader","manager","HalfFloatType","buffer","rgbe_error","rgbe_error_code","msg","fgets","lineLimit","consume","p","pos","len","s","chunk","fromCharCode","apply","Uint16Array","subarray","byteLength","RGBEByteToRGBFloat","sourceArray","sourceOffset","destArray","destOffset","e","scale","pow","RGBEByteToRGBHalf","DataUtils","toHalfFloat","byteArray","Uint8Array","rgbe_header_info","line","match","gamma_re","exposure_re","format_re","dimensions_re","header","valid","string","comments","programtype","format","gamma","exposure","charAt","RGBE_ReadHeader","w","h","image_rgba_data","scanline_width","data_rgba","offset","ptr_end","rgbeStart","scanline_buffer","num_scanlines","ptr","count","isEncodedRun","byteValue","set","l","off","RGBE_ReadPixels_RLE","data","numElements","UnsignedByteType","RGBEFormat","FloatType","floatArray","Float32Array","j","RGBFormat","halfArray","url","onLoad","onProgress","onError","texture","texData","encoding","RGBEEncoding","minFilter","NearestFilter","magFilter","generateMipmaps","flipY","LinearEncoding","LinearFilter","DataTextureLoader","UITexture","mapping","form","input","loadFile","target","files","canvas","file","extension","split","pop","reader","FileReader","setDataType","THREE","load","result","hdrTexture","sourceFile","isHDRTexture","onChangeCallback","readAsDataURL","TGALoader","parse","readAsArrayBuffer","image","needsUpdate","src","reset","marginRight","click","dataTransfer","context","getContext","clearRect","title","drawImage","canvas2","outputEncoding","setSize","scene","camera","material","map","quad","mesh","render","domElement","renderToCanvas","UIOutliner","tabIndex","selectIndex","selectedIndex","selectedValue","index","currentDrag","onClick","onDrag","onDragStart","setData","onDragOver","area","offsetY","clientHeight","onDragLeave","onDrop","object","getObjectById","nextObject","moveObject","nextSibling","newParent","newParentIsChild","traverse","child","execute","MoveObjectCommand","div","draggable","offsetTop","minScroll","offsetHeight","scrollTop","UIPoints","pointsList","pointsUI","lastPointIdx","update","deletePointRow","idx","dontUpdate","row","splice","UIPoints2","addPointButton","createPointRow","point","points","pointUI","lbl","clear","pointRow","setWidth","txtX","onChange","txtY","btn","isEditing","getIndexOfChild","UIPoints3","z","txtZ","UIBoolean","setMarginRight","checkbox","setMarginLeft","newBefore","oldParent","oldIndex","newIndex","signals","sceneGraphChanged","dispatch","objectUuid","uuid","newParentUuid","oldParentUuid","objectByUuid","TGA_TYPE_NO_DATA","TGA_TYPE_INDEXED","TGA_TYPE_RGB","TGA_TYPE_GREY","TGA_TYPE_RLE_INDEXED","TGA_TYPE_RLE_RGB","TGA_TYPE_RLE_GREY","TGA_ORIGIN_MASK","TGA_ORIGIN_SHIFT","TGA_ORIGIN_BL","TGA_ORIGIN_BR","TGA_ORIGIN_UL","TGA_ORIGIN_UR","content","id_length","colormap_type","image_type","colormap_index","colormap_length","colormap_size","origin","pixel_size","flags","tgaCheckHeader","use_rle","use_pal","use_grey","imageData","pixel_data","palettes","pixel_total","c","shift","pixels","tgaParse","palette","x_start","y_start","x_step","y_step","x_end","y_end","color","tgaGetImageDataGrey8bits","tgaGetImageDataGrey16bits","colormap","tgaGetImageData8bits","tgaGetImageData16bits","tgaGetImageData24bits","tgaGetImageData32bits","getTgaRGBA","LinearMipmapLinearFilter","SidebarGeometryBufferGeometry","strings","container","geometry","isBufferGeometry","getKey","container2","setVerticalAlign","setFontSize","attributes","attribute","itemSize","objectSelected","geometryChanged","SidebarGeometryModifiers","setPaddingLeft","button","computeVertexNormals","normal","SetGeometryCommand","newGeometry","oldGeometry","dispose","computeBoundingSphere","cmd","toJSON","parseGeometry","ObjectLoader","parseGeometries","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","Error","code","ids","all","keys","Object","module","exports","Config","storage","window","localStorage","JSON","stringify","setKey","log","exec","Date","AddObjectCommand","addObject","removeObject","deselect","loader","SetUuidCommand","newUuid","oldUuid","objectChanged","SetValueCommand","attributeName","newValue","oldValue","SetSceneCommand","cmdArray","userData","active","undo","cmds","fromJSON","LoaderUtils","onDone","itemsCount","itemsTotal","filesMap","onEntryHandled","handleEntry","entry","isDirectory","createReader","readEntries","entries","isFile","fullPath","kind","webkitGetAsEntry","Loader","handleJSON","metadata","formatVersion","version","setResourcePath","texturePath","isScene","loadItemList","loadFiles","setURLModifier","replace","URL","createObjectURL","addHandler","filename","size","floor","total","progress","loaded","contents","blob","Blob","worker","Worker","onmessage","postMessage","now","alert","readAsText","AddScriptCommand","script","scripts","scriptAdded","scriptRemoved","MultiCmdsCommand","RemoveObjectCommand","parentUuid","RemoveScriptCommand","SetColorCommand","getHex","setHex","SetGeometryValueCommand","SetMaterialColorCommand","materialSlot","getObjectMaterial","materialChanged","SetMaterialCommand","newMaterial","oldMaterial","setObjectMaterial","parseMaterial","images","parseImages","textures","parseTextures","parseMaterials","SetMaterialMapCommand","mapName","newMap","oldMap","serializeMap","meta","geometries","materials","cache","values","extractFromCache","parseTexture","SetMaterialValueCommand","SetMaterialVectorCommand","toArray","fromArray","SetPositionCommand","newPosition","optionalOldPosition","oldPosition","position","clone","copy","updateMatrixWorld","command","Vector3","SetRotationCommand","newRotation","optionalOldRotation","oldRotation","rotation","Euler","SetScaleCommand","newScale","optionalOldScale","oldScale","SetScriptValueCommand","scriptChanged","History","undos","redos","lastCmdTime","idCounter","historyDisabled","config","startPlayer","stopPlayer","Strings","language","en","fr","zh","Storage","indexedDB","mozIndexedDB","webkitIndexedDB","msIndexedDB","warn","init","get","database","request","open","onupgradeneeded","db","objectStoreNames","contains","createObjectStore","onsuccess","onerror","transaction","objectStore","start","performance","put","optionalName","lastCmd","timeDifference","getTime","isUpdatableCmd","historyChanged","redo","history","hasOwnProperty","cmdJSON","Commands","goToState","enableSerialization","_DEFAULT_CAMERA","Editor","editScript","Signal","toggleVR","exitedVR","editorCleared","savingStarted","savingFinished","transformModeChanged","snapChanged","spaceChanged","rendererCreated","rendererUpdated","sceneBackgroundChanged","sceneEnvironmentChanged","sceneFogChanged","sceneFogSettingsChanged","sceneRendered","cameraChanged","cameraResetted","objectFocused","objectAdded","objectRemoved","cameraAdded","cameraRemoved","helperAdded","helperRemoved","materialAdded","materialRemoved","windowResize","showGridChanged","showHelpersChanged","refreshSidebarObject3D","viewportCameraChanged","animationStopped","_History","_Storage","sceneHelpers","materialsRefCounter","Map","mixer","helpers","cameras","viewportCamera","addCamera","lookAt","setScene","background","environment","fog","addGeometry","addMaterial","addHelper","before","nameObject","removeCamera","removeHelper","removeMaterial","setGeometryName","isArray","addMaterialToRefCounter","removeMaterialFromRefCounter","delete","getMaterialById","setMaterialName","addTexture","isCamera","visible","helper","isPointLight","isDirectionalLight","isSpotLight","isHemisphereLight","isSkinnedMesh","skeleton","bones","picker","addScript","removeScript","slot","setViewportCamera","selectById","selectByUuid","focusById","objects","animations","stopAllAction","a","parseAsync","getObjectByProperty","project","shadows","shadowType","vr","physicallyCorrectLights","toneMapping","toneMappingExposure","_raycaster","Raycaster","_tempVector","_tempVector2","_tempQuaternion","Quaternion","_unit","X","Y","Z","_changeEvent","_mouseDownEvent","_mouseUpEvent","mode","_objectChangeEvent","TransformControls","touchAction","_gizmo","TransformControlsGizmo","_plane","TransformControlsPlane","defineProperty","propName","defaultValue","propValue","worldPosition","worldPositionStart","worldQuaternion","worldQuaternionStart","cameraPosition","cameraQuaternion","pointStart","pointEnd","rotationAxis","eye","_offset","_startNorm","_endNorm","_cameraScale","_parentPosition","_parentQuaternion","_parentQuaternionInv","_parentScale","_worldScaleStart","_worldQuaternionInv","_worldScale","_positionStart","_quaternionStart","_scaleStart","_getPointer","getPointer","_onPointerDown","onPointerDown","_onPointerHover","onPointerHover","_onPointerMove","onPointerMove","_onPointerUp","onPointerUp","matrixWorld","decompose","invert","sub","normalize","dragging","setFromCamera","intersect","intersectObjectWithRay","axis","planeIntersect","space","snap","rotationSnap","round","quaternion","applyQuaternion","divide","translationSnap","search","setFromMatrixPosition","d","dot","multiply","scaleSnap","ROTATION_SPEED","distanceTo","rotationAngle","angleTo","cross","setFromAxisAngle","Object3D","ownerDocument","pointerLockElement","rect","getBoundingClientRect","left","top","enabled","pointerType","pointerHover","setPointerCapture","pointerId","pointerDown","pointerMove","releasePointerCapture","pointerUp","raycaster","includeInvisible","allIntersections","intersectObject","isTransformControls","_tempEuler","_alignVector","_zeroVector","_lookAtMatrix","Matrix4","_tempQuaternion2","_identityQuaternion","_dirVector","_tempMatrix","_unitX","_unitY","_unitZ","_v1","_v2","_v3","gizmoMaterial","MeshBasicMaterial","depthTest","depthWrite","toneMapped","transparent","gizmoLineMaterial","LineBasicMaterial","matInvisible","opacity","matHelper","matRed","matGreen","matBlue","matRedTransparent","matGreenTransparent","matBlueTransparent","matWhiteTransparent","matYellowTransparent","matGray","arrowGeometry","CylinderGeometry","translate","scaleHandleGeometry","BoxGeometry","lineGeometry","BufferGeometry","Float32BufferAttribute","lineGeometry2","CircleGeometry","radius","arc","TorusGeometry","PI","rotateY","rotateX","gizmoTranslate","Mesh","XYZ","OctahedronGeometry","XY","YZ","XZ","pickerTranslate","helperTranslate","START","END","DELTA","Line","TranslateHelperGeometry","gizmoRotate","XYZE","E","helperRotate","AXIS","pickerRotate","SphereGeometry","gizmoScale","pickerScale","helperScale","setupGizmo","gizmoMap","gizmo","tag","updateMatrix","tempGeometry","applyMatrix4","matrix","renderOrder","force","handles","concat","handle","factor","isOrthographicCamera","bottom","zoom","tan","fov","multiplyScalar","setFromEuler","setFromRotationMatrix","AXIS_HIDE_TRESHOLD","atan2","multiplyQuaternions","showX","showY","showZ","_color","_opacity","some","isTransformControlsGizmo","PlaneGeometry","wireframe","side","DoubleSide","isTransformControlsPlane","EditorControls","center","panSpeed","zoomSpeed","rotationSpeed","vector","delta","box","STATE","state","normalMatrix","pointerOld","spherical","sphere","onMouseDown","movementX","movementY","rotate","pan","onMouseWheel","deltaY","contextmenu","setFromObject","isEmpty","getCenter","getBoundingSphere","applyMatrix3","getNormalMatrix","setFromVector3","theta","phi","makeSafe","setFromSpherical","touchStart","touchMove","prevTouches","prevDistance","divideScalar","devicePixelRatio","getClosest","offset0","offset1","touch","closest","ViewportCamera","cameraSelect","setOptions","setPosition","setRight","setTop","ViewportInfo","setLeft","setBottom","setColor","objectsText","verticesText","trianglesText","frametimeText","vertices","triangles","traverseVisible","isMesh","isGeometry","faces","setTextTransform","frametime","Number","create","constructor","ViewHelper","editorCamera","animating","controls","setHeight","handleClick","color1","color2","color3","interactiveObjects","mouse","dummy","xAxis","getAxisMaterial","yAxis","zAxis","posXAxisHelper","getSpriteMaterial","posYAxisHelper","posZAxisHelper","negXAxisHelper","negYAxisHelper","negZAxisHelper","setScalar","dim","turnRate","offsetWidth","clearDepth","setViewport","targetPosition","targetQuaternion","q1","q2","beginPath","closePath","fillStyle","getStyle","fill","font","textAlign","fillText","offsetX","intersects","intersectObjects","focusPoint","prepareAnimationData","rotateTowards","isViewHelper","RoomEnvironment","deleteAttribute","roomMaterial","MeshStandardMaterial","BackSide","boxMaterial","mainLight","PointLight","room","box1","box2","box3","box4","box5","box6","light1","createAreaLightMaterial","light2","light3","light4","light5","light6","Scene","intensity","Viewport","pmremGenerator","showSceneHelpers","grid","grid1","vertexColors","grid2","depthFunc","viewHelper","selectionBox","objectPositionOnDown","objectRotationOnDown","objectScaleOnDown","transformControls","isSkeletonHelper","getMode","equals","updateAspectRatio","aspect","updateProjectionMatrix","getIntersects","filter","onDownPosition","onUpPosition","onDoubleClickPosition","getMousePosition","changedTouches","setMode","dist","setTranslationSnap","setSpace","newRenderer","setAnimationLoop","animate","setClearColor","matchMedia","mediaQuery","addListener","matches","updateGridColors","setPixelRatio","compileEquirectangularShader","detach","attach","isPerspectiveCamera","getObjectByName","backgroundType","backgroundTexture","backgroundEquirectangularTexture","environmentType","environmentEquirectangularTexture","fromScene","fogType","fogColor","fogNear","fogFar","fogDensity","near","far","density","projectionMatrix","showGrid","showHelpers","clock","getDelta","stats","actions","inUse","startTime","endTime","autoClear","colors","Toolbar","translateIcon","rotateIcon","scaleIcon","local","SidebarScene","setBorderTop","setPaddingTop","nodeStates","WeakMap","buildOption","html","isLight","isLine","isPoints","getObjectType","escapeHTML","join","getMaterialName","getScript","buildHTML","has","opener","refreshUI","insertBefore","ignoreObjectSelectedSignal","outliner","onDblClick","backgroundRow","onBackgroundChanged","refreshBackgroundUI","onInput","getHexValue","environmentRow","onEnvironmentChanged","refreshEnvironmentUI","onFogSettingsChanged","fogTypeRow","refreshFogUI","fogPropertiesRow","setRange","setStep","setPrecision","addObjects","pad","paddingLeft","isColor","setHexValue","isTexture","isFog","isFogExp2","needsRefresh","SidebarObject","objectTypeRow","objectType","objectUUIDRow","objectUUID","setDisabled","objectUUIDRenew","generateUUID","objectNameRow","objectName","objectPositionRow","objectPositionX","objectPositionY","objectPositionZ","objectRotationRow","objectRotationX","setNudge","setUnit","objectRotationY","objectRotationZ","objectScaleRow","objectScaleX","objectScaleY","objectScaleZ","objectFovRow","objectFov","objectLeftRow","objectLeft","objectRightRow","objectRight","objectTopRow","objectTop","objectBottomRow","objectBottom","objectNearRow","objectNear","objectFarRow","objectFar","objectIntensityRow","objectIntensity","objectColorRow","objectColor","objectGroundColorRow","objectGroundColor","objectDistanceRow","objectDistance","objectAngleRow","objectAngle","objectPenumbraRow","objectPenumbra","objectDecayRow","objectDecay","objectShadowRow","objectCastShadow","objectReceiveShadow","objectShadowBiasRow","objectShadowBias","objectShadowNormalBiasRow","objectShadowNormalBias","objectShadowRadiusRow","objectShadowRadius","objectVisibleRow","objectVisible","objectFrustumCulledRow","objectFrustumCulled","objectRenderOrderRow","objectRenderOrder","objectUserDataRow","objectUserData","DEG2RAD","toVector3","right","groundColor","angle","penumbra","decay","frustumCulled","castShadow","receiveShadow","shadow","bias","normalBias","updateUI","RAD2DEG","getHexString","setBorderColor","setBackgroundColor","isObject3D","targetInverse","updateTransformRows","onKeyUp","properties","uiElement","isAmbientLight","updateRows","_normalMatrix","Matrix3","VertexNormalsHelper","nNormals","objGeometry","positions","matrixAutoUpdate","objPos","objNorm","jl","getX","getY","getZ","setXYZ","LineSegments","SidebarGeometry","currentGeometryType","geometryTypeRow","geometryType","geometryUUIDRow","geometryUUID","geometryUUIDRenew","geometryNameRow","geometryName","parameters","geometryBoundingBox","helpersRow","setMarginTop","vertexNormalsButton","build","GeometryParametersPanel","boundingBox","computeBoundingBox","setInnerHTML","SidebarMaterialBooleanProperty","SidebarMaterialColorProperty","SidebarMaterialConstantProperty","constant","SidebarMaterialMapProperty","isDataTexture","scaleX","scaleY","mapType","onScaleXYChange","uv","SidebarMaterialNumberProperty","range","SidebarMaterialProgram","programInfo","programVertex","programFragment","SidebarMaterial","currentObject","currentMaterialSlot","materialSlotRow","materialSlotSelect","materialClassRow","materialClass","materialUUIDRow","materialUUID","materialUUIDRenew","materialNameRow","materialName","materialProgram","materialColor","materialSpecular","materialShininess","materialEmissive","materialReflectivity","materialRoughness","materialMetalness","materialClearcoat","materialClearcoatRoughness","materialTransmission","materialAttenuationDistance","materialAttenuationTint","materialThickness","materialVertexColors","materialDepthPackingOptions","materialDepthPacking","materialMap","materialSpecularMap","materialEmissiveMap","materialMatcapMap","materialAlphaMap","materialBumpMap","materialNormalMap","materialClearcoatNormalMap","materialDisplacementMap","materialRoughnessMap","materialMetalnessMap","materialEnvMap","materialLightMap","materialAOMap","materialGradientMap","materialSide","materialSize","materialSizeAttenuation","materialFlatShading","materialBlending","materialOpacity","materialTransparent","materialAlphaTest","materialDepthTest","materialDepthWrite","materialWireframe","previousSelectedSlot","materialClasses","vertexShader","vertexShaderVariables","slotOptions","meshMaterialOptions","isSprite","spriteMaterialOptions","pointsMaterialOptions","lineMaterialOptions","setRowVisibility","hasMaterial","SidebarProperties","addTab","SidebarAnimation","firstAnimation","animation","clipAction","animationsSelect","mixerTimeScaleNumber","timeScale","uncacheRoot","animationsRow","play","stop","mixerTimeScaleRow","SidebarProjectRenderer","currentRenderer","headerRow","antialiasRow","antialiasBoolean","createRenderer","physicallyCorrectLightsRow","physicallyCorrectLightsBoolean","shadowsRow","shadowsBoolean","updateShadows","shadowTypeSelect","shadowMap","toneMappingRow","toneMappingSelect","updateToneMapping","antialias","SidebarProject","settings","titleRow","editableRow","editable","vrRow","SidebarSettingsViewport","showGridRow","showHelpersRow","SidebarSettingsShortcuts","IS_MAC","navigator","platform","isValidKeyBinding","shortcuts","createShortcutInput","configName","shortcutRow","shortcutInput","setTextAlign","maxLength","metaKey","ctrlKey","SidebarSettingsHistory","persistent","lastUndoCmd","lastUndoId","SidebarSettings","languageRow","Sidebar","MenubarAdd","setTextContent","MenubarEdit","confirm","fixColorMap","colorMaps","obj","fixMaterial","MenubarView","fullscreenElement","documentElement","requestFullscreen","exitFullscreen","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","xr","isSessionSupported","supported","MenubarFile","body","fileInput","saveString","link","save","href","revokeObjectURL","download","MouseEvent","MenubarHelp","MenubarStatus","autosave","setTextDecoration","setOpacity","Menubar","Resizer","isPrimary","getElementById","SampleComponent","props","useState","setObjectName","useCallback","useEffect","signal","CSG","polygons","csg","Node","b","clipTo","allPolygons","fromPolygons","flip","Vector","v","t","tv0","times","dividedBy","sqrt","ax","ay","az","bx","by","bz","tv1","Vertex","negate","other","lerp","Plane","polygon","coplanarFront","coplanarBack","front","back","polygonType","types","EPSILON","plane","f","ti","tj","vi","vj","interpolate","Polygon","shared","fromPoints","n","reverse","node","temp","splitPolygon","clipPolygons","bsp","fromGeometry","geom","objectIndex","polys","fs","vs","fm","vertexNormals","faceVertexUvs","posattr","normalattr","uvattr","colorattr","triCount","pli","vp","vt","nx","ny","nz","u","ttvv0","tmpm3","fromMesh","nbuf3","ct","write","toMesh","toMatrix","toMaterial","toGeometry","m","setFromQuaternion","ps","normals","uvs","grps","pvs","pvlen","gbase","gi","addGroup","setIndex","inv","ZoneConstructorController","prefix","tails","commonPrefix","getDimension","every","el","op","extendPrefix","shiftTails","reduce","prev","el2","reduceRight","prev2","prev3","el3","prev1","el1","parseZone","zoneOperationRows","zoneOperationRow","controller","operations","nextGeo","parseOperation","parseRow","GeometryInput","setSelected","Select","labelId","displayEmpty","MenuItem","geo","OperationInput","canClear","alt","BooleanAlgebraRow","algebraRow","setAlgebraRow","pushGeometry","possibleObjects","elIndex","removeOperation","change","pushOperation","Button","del","ZoneManagerPanel","rows","setRows","allObjects","setAllObjects","refreshObjectsList","removeId","newRows","rowId","ThreeEditor","containerEl","useRef","setEditor","current","webkitURL","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","viewport","toolbar","sidebar","menubar","resizer","onWindowResize","timeout","saveState","clearTimeout","setTimeout","isLoadingFromHash","dropEffect","hash","location","crossOrigin","initEditor","meshA","meshB","bspA","bspB","bspResult","subtract","meshResult","ref","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.18c8a925.chunk.js","sourcesContent":["class UIElement {\r\n\r\n\tconstructor( dom ) {\r\n\r\n\t\tthis.dom = dom;\r\n\r\n\t}\r\n\r\n\tadd() {\r\n\r\n\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\tconst argument = arguments[ i ];\r\n\r\n\t\t\tif ( argument instanceof UIElement ) {\r\n\r\n\t\t\t\tthis.dom.appendChild( argument.dom );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( 'UIElement:', argument, 'is not an instance of UIElement.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tremove() {\r\n\r\n\t\tfor ( let i = 0; i < arguments.length; i ++ ) {\r\n\r\n\t\t\tconst argument = arguments[ i ];\r\n\r\n\t\t\tif ( argument instanceof UIElement ) {\r\n\r\n\t\t\t\tthis.dom.removeChild( argument.dom );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( 'UIElement:', argument, 'is not an instance of UIElement.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tclear() {\r\n\r\n\t\twhile ( this.dom.children.length ) {\r\n\r\n\t\t\tthis.dom.removeChild( this.dom.lastChild );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tsetId( id ) {\r\n\r\n\t\tthis.dom.id = id;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tgetId() {\r\n\r\n\t\treturn this.dom.id;\r\n\r\n\t}\r\n\r\n\tsetClass( name ) {\r\n\r\n\t\tthis.dom.className = name;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\taddClass( name ) {\r\n\r\n\t\tthis.dom.classList.add( name );\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tremoveClass( name ) {\r\n\r\n\t\tthis.dom.classList.remove( name );\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetStyle( style, array ) {\r\n\r\n\t\tfor ( let i = 0; i < array.length; i ++ ) {\r\n\r\n\t\t\tthis.dom.style[ style ] = array[ i ];\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetDisabled( value ) {\r\n\r\n\t\tthis.dom.disabled = value;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetTextContent( value ) {\r\n\r\n\t\tthis.dom.textContent = value;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetInnerHTML( value ) {\r\n\r\n\t\tthis.dom.innerHTML = value;\r\n\r\n\t}\r\n\r\n\tgetIndexOfChild( element ) {\r\n\r\n\t\treturn Array.prototype.indexOf.call( this.dom.children, element.dom );\r\n\r\n\t}\r\n\r\n}\r\n\r\n// properties\r\n\r\nconst properties = [ 'position', 'left', 'top', 'right', 'bottom', 'width', 'height', 'border', 'borderLeft',\r\n\t'borderTop', 'borderRight', 'borderBottom', 'borderColor', 'display', 'overflow', 'margin', 'marginLeft', 'marginTop', 'marginRight', 'marginBottom', 'padding', 'paddingLeft', 'paddingTop', 'paddingRight', 'paddingBottom', 'verticalAlign', 'color',\r\n\t'background', 'backgroundColor', 'opacity', 'fontSize', 'fontWeight', 'textAlign', 'textDecoration', 'textTransform', 'cursor', 'zIndex' ];\r\n\r\nproperties.forEach( function ( property ) {\r\n\r\n\tconst method = 'set' + property.substr( 0, 1 ).toUpperCase() + property.substr( 1, property.length );\r\n\r\n\tUIElement.prototype[ method ] = function () {\r\n\r\n\t\tthis.setStyle( property, arguments );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n} );\r\n\r\n// events\r\n\r\nconst events = [ 'KeyUp', 'KeyDown', 'MouseOver', 'MouseOut', 'Click', 'DblClick', 'Change', 'Input' ];\r\n\r\nevents.forEach( function ( event ) {\r\n\r\n\tconst method = 'on' + event;\r\n\r\n\tUIElement.prototype[ method ] = function ( callback ) {\r\n\r\n\t\tthis.dom.addEventListener( event.toLowerCase(), callback.bind( this ), false );\r\n\r\n\t\treturn this;\r\n\r\n\t};\r\n\r\n} );\r\n\r\nclass UISpan extends UIElement {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper( document.createElement( 'span' ) );\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIDiv extends UIElement {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper( document.createElement( 'div' ) );\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIRow extends UIDiv {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.dom.className = 'Row';\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIPanel extends UIDiv {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.dom.className = 'Panel';\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIText extends UISpan {\r\n\r\n\tconstructor( text ) {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.dom.className = 'Text';\r\n\t\tthis.dom.style.cursor = 'default';\r\n\t\tthis.dom.style.display = 'inline-block';\r\n\r\n\t\tthis.setValue( text );\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.dom.textContent;\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\tif ( value !== undefined ) {\r\n\r\n\t\t\tthis.dom.textContent = value;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\n\r\nclass UIInput extends UIElement {\r\n\r\n\tconstructor( text ) {\r\n\r\n\t\tsuper( document.createElement( 'input' ) );\r\n\r\n\t\tthis.dom.className = 'Input';\r\n\t\tthis.dom.style.padding = '2px';\r\n\t\tthis.dom.style.border = '1px solid transparent';\r\n\r\n\t\tthis.dom.setAttribute( 'autocomplete', 'off' );\r\n\r\n\t\tthis.dom.addEventListener( 'keydown', function ( event ) {\r\n\r\n\t\t\tevent.stopPropagation();\r\n\r\n\t\t}, false );\r\n\r\n\t\tthis.setValue( text );\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.dom.value;\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\tthis.dom.value = value;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UITextArea extends UIElement {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper( document.createElement( 'textarea' ) );\r\n\r\n\t\tthis.dom.className = 'TextArea';\r\n\t\tthis.dom.style.padding = '2px';\r\n\t\tthis.dom.spellcheck = false;\r\n\r\n\t\tthis.dom.setAttribute( 'autocomplete', 'off' );\r\n\r\n\t\tthis.dom.addEventListener( 'keydown', ( event ) => {\r\n\r\n\t\t\tevent.stopPropagation();\r\n\r\n\t\t\tif ( event.keyCode === 9 ) {\r\n\r\n\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t\tconst cursor = this.dom.selectionStart;\r\n\r\n\t\t\t\tthis.dom.value = this.dom.value.substring( 0, cursor ) + '\\t' + this.dom.value.substring( cursor );\r\n\t\t\t\tthis.dom.selectionStart = cursor + 1;\r\n\t\t\t\tthis.dom.selectionEnd = this.dom.selectionStart;\r\n\r\n\t\t\t}\r\n\r\n\t\t}, false );\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.dom.value;\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\tthis.dom.value = value;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UISelect extends UIElement {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper( document.createElement( 'select' ) );\r\n\r\n\t\tthis.dom.className = 'Select';\r\n\t\tthis.dom.style.padding = '2px';\r\n\r\n\t\tthis.dom.setAttribute( 'autocomplete', 'off' );\r\n\r\n\t}\r\n\r\n\tsetMultiple( boolean ) {\r\n\r\n\t\tthis.dom.multiple = boolean;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetOptions( options ) {\r\n\r\n\t\tconst selected = this.dom.value;\r\n\r\n\t\twhile ( this.dom.children.length > 0 ) {\r\n\r\n\t\t\tthis.dom.removeChild( this.dom.firstChild );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( const key in options ) {\r\n\r\n\t\t\tconst option = document.createElement( 'option' );\r\n\t\t\toption.value = key;\r\n\t\t\toption.innerHTML = options[ key ];\r\n\t\t\tthis.dom.appendChild( option );\r\n\r\n\t\t}\r\n\r\n\t\tthis.dom.value = selected;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.dom.value;\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\tvalue = String( value );\r\n\r\n\t\tif ( this.dom.value !== value ) {\r\n\r\n\t\t\tthis.dom.value = value;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UICheckbox extends UIElement {\r\n\r\n\tconstructor( boolean ) {\r\n\r\n\t\tsuper( document.createElement( 'input' ) );\r\n\r\n\t\tthis.dom.className = 'Checkbox';\r\n\t\tthis.dom.type = 'checkbox';\r\n\r\n\t\tthis.setValue( boolean );\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.dom.checked;\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\tif ( value !== undefined ) {\r\n\r\n\t\t\tthis.dom.checked = value;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\n\r\nclass UIColor extends UIElement {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper( document.createElement( 'input' ) );\r\n\r\n\t\tthis.dom.className = 'Color';\r\n\t\tthis.dom.style.width = '32px';\r\n\t\tthis.dom.style.height = '16px';\r\n\t\tthis.dom.style.border = '0px';\r\n\t\tthis.dom.style.padding = '2px';\r\n\t\tthis.dom.style.backgroundColor = 'transparent';\r\n\r\n\t\tthis.dom.setAttribute( 'autocomplete', 'off' );\r\n\r\n\t\ttry {\r\n\r\n\t\t\tthis.dom.type = 'color';\r\n\t\t\tthis.dom.value = '#ffffff';\r\n\r\n\t\t} catch ( exception ) {}\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.dom.value;\r\n\r\n\t}\r\n\r\n\tgetHexValue() {\r\n\r\n\t\treturn parseInt( this.dom.value.substr( 1 ), 16 );\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\tthis.dom.value = value;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetHexValue( hex ) {\r\n\r\n\t\tthis.dom.value = '#' + ( '000000' + hex.toString( 16 ) ).slice( - 6 );\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UINumber extends UIElement {\r\n\r\n\tconstructor( number ) {\r\n\r\n\t\tsuper( document.createElement( 'input' ) );\r\n\r\n\t\tthis.dom.style.cursor = 'ns-resize';\r\n\t\tthis.dom.className = 'Number';\r\n\t\tthis.dom.value = '0.00';\r\n\r\n\t\tthis.dom.setAttribute( 'autocomplete', 'off' );\r\n\r\n\t\tthis.value = 0;\r\n\r\n\t\tthis.min = - Infinity;\r\n\t\tthis.max = Infinity;\r\n\r\n\t\tthis.precision = 2;\r\n\t\tthis.step = 1;\r\n\t\tthis.unit = '';\r\n\t\tthis.nudge = 0.01;\r\n\r\n\t\tthis.setValue( number );\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\tconst changeEvent = document.createEvent( 'HTMLEvents' );\r\n\t\tchangeEvent.initEvent( 'change', true, true );\r\n\r\n\t\tlet distance = 0;\r\n\t\tlet onMouseDownValue = 0;\r\n\r\n\t\tconst pointer = { x: 0, y: 0 };\r\n\t\tconst prevPointer = { x: 0, y: 0 };\r\n\r\n\t\tfunction onMouseDown( event ) {\r\n\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tdistance = 0;\r\n\r\n\t\t\tonMouseDownValue = scope.value;\r\n\r\n\t\t\tprevPointer.x = event.clientX;\r\n\t\t\tprevPointer.y = event.clientY;\r\n\r\n\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\r\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\r\n\r\n\t\t}\r\n\r\n\t\tfunction onMouseMove( event ) {\r\n\r\n\t\t\tconst currentValue = scope.value;\r\n\r\n\t\t\tpointer.x = event.clientX;\r\n\t\t\tpointer.y = event.clientY;\r\n\r\n\t\t\tdistance += ( pointer.x - prevPointer.x ) - ( pointer.y - prevPointer.y );\r\n\r\n\t\t\tlet value = onMouseDownValue + ( distance / ( event.shiftKey ? 5 : 50 ) ) * scope.step;\r\n\t\t\tvalue = Math.min( scope.max, Math.max( scope.min, value ) );\r\n\r\n\t\t\tif ( currentValue !== value ) {\r\n\r\n\t\t\t\tscope.setValue( value );\r\n\t\t\t\tscope.dom.dispatchEvent( changeEvent );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprevPointer.x = event.clientX;\r\n\t\t\tprevPointer.y = event.clientY;\r\n\r\n\t\t}\r\n\r\n\t\tfunction onMouseUp() {\r\n\r\n\t\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\r\n\t\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\r\n\r\n\t\t\tif ( Math.abs( distance ) < 2 ) {\r\n\r\n\t\t\t\tscope.dom.focus();\r\n\t\t\t\tscope.dom.select();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction onTouchStart( event ) {\r\n\r\n\t\t\tif ( event.touches.length === 1 ) {\r\n\r\n\t\t\t\tdistance = 0;\r\n\r\n\t\t\t\tonMouseDownValue = scope.value;\r\n\r\n\t\t\t\tprevPointer.x = event.touches[ 0 ].pageX;\r\n\t\t\t\tprevPointer.y = event.touches[ 0 ].pageY;\r\n\r\n\t\t\t\tdocument.addEventListener( 'touchmove', onTouchMove, false );\r\n\t\t\t\tdocument.addEventListener( 'touchend', onTouchEnd, false );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction onTouchMove( event ) {\r\n\r\n\t\t\tconst currentValue = scope.value;\r\n\r\n\t\t\tpointer.x = event.touches[ 0 ].pageX;\r\n\t\t\tpointer.y = event.touches[ 0 ].pageY;\r\n\r\n\t\t\tdistance += ( pointer.x - prevPointer.x ) - ( pointer.y - prevPointer.y );\r\n\r\n\t\t\tlet value = onMouseDownValue + ( distance / ( event.shiftKey ? 5 : 50 ) ) * scope.step;\r\n\t\t\tvalue = Math.min( scope.max, Math.max( scope.min, value ) );\r\n\r\n\t\t\tif ( currentValue !== value ) {\r\n\r\n\t\t\t\tscope.setValue( value );\r\n\t\t\t\tscope.dom.dispatchEvent( changeEvent );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprevPointer.x = event.touches[ 0 ].pageX;\r\n\t\t\tprevPointer.y = event.touches[ 0 ].pageY;\r\n\r\n\t\t}\r\n\r\n\t\tfunction onTouchEnd( event ) {\r\n\r\n\t\t\tif ( event.touches.length === 0 ) {\r\n\r\n\t\t\t\tdocument.removeEventListener( 'touchmove', onTouchMove, false );\r\n\t\t\t\tdocument.removeEventListener( 'touchend', onTouchEnd, false );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction onChange() {\r\n\r\n\t\t\tscope.setValue( scope.dom.value );\r\n\r\n\t\t}\r\n\r\n\t\tfunction onFocus() {\r\n\r\n\t\t\tscope.dom.style.backgroundColor = '';\r\n\t\t\tscope.dom.style.cursor = '';\r\n\r\n\t\t}\r\n\r\n\t\tfunction onBlur() {\r\n\r\n\t\t\tscope.dom.style.backgroundColor = 'transparent';\r\n\t\t\tscope.dom.style.cursor = 'ns-resize';\r\n\r\n\t\t}\r\n\r\n\t\tfunction onKeyDown( event ) {\r\n\r\n\t\t\tevent.stopPropagation();\r\n\r\n\t\t\tswitch ( event.keyCode ) {\r\n\r\n\t\t\t\tcase 13: // enter\r\n\t\t\t\t\tscope.dom.blur();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 38: // up\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tscope.setValue( scope.getValue() + scope.nudge );\r\n\t\t\t\t\tscope.dom.dispatchEvent( changeEvent );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 40: // down\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tscope.setValue( scope.getValue() - scope.nudge );\r\n\t\t\t\t\tscope.dom.dispatchEvent( changeEvent );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tonBlur();\r\n\r\n\t\tthis.dom.addEventListener( 'keydown', onKeyDown, false );\r\n\t\tthis.dom.addEventListener( 'mousedown', onMouseDown, false );\r\n\t\tthis.dom.addEventListener( 'touchstart', onTouchStart, false );\r\n\t\tthis.dom.addEventListener( 'change', onChange, false );\r\n\t\tthis.dom.addEventListener( 'focus', onFocus, false );\r\n\t\tthis.dom.addEventListener( 'blur', onBlur, false );\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.value;\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\tif ( value !== undefined ) {\r\n\r\n\t\t\tvalue = parseFloat( value );\r\n\r\n\t\t\tif ( value < this.min ) value = this.min;\r\n\t\t\tif ( value > this.max ) value = this.max;\r\n\r\n\t\t\tthis.value = value;\r\n\t\t\tthis.dom.value = value.toFixed( this.precision );\r\n\r\n\t\t\tif ( this.unit !== '' ) this.dom.value += ' ' + this.unit;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetPrecision( precision ) {\r\n\r\n\t\tthis.precision = precision;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetStep( step ) {\r\n\r\n\t\tthis.step = step;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetNudge( nudge ) {\r\n\r\n\t\tthis.nudge = nudge;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetRange( min, max ) {\r\n\r\n\t\tthis.min = min;\r\n\t\tthis.max = max;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetUnit( unit ) {\r\n\r\n\t\tthis.unit = unit;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIInteger extends UIElement {\r\n\r\n\tconstructor( number ) {\r\n\r\n\t\tsuper( document.createElement( 'input' ) );\r\n\r\n\t\tthis.dom.style.cursor = 'ns-resize';\r\n\t\tthis.dom.className = 'Number';\r\n\t\tthis.dom.value = '0';\r\n\r\n\t\tthis.dom.setAttribute( 'autocomplete', 'off' );\r\n\r\n\t\tthis.value = 0;\r\n\r\n\t\tthis.min = - Infinity;\r\n\t\tthis.max = Infinity;\r\n\r\n\t\tthis.step = 1;\r\n\t\tthis.nudge = 1;\r\n\r\n\t\tthis.setValue( number );\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\tconst changeEvent = document.createEvent( 'HTMLEvents' );\r\n\t\tchangeEvent.initEvent( 'change', true, true );\r\n\r\n\t\tlet distance = 0;\r\n\t\tlet onMouseDownValue = 0;\r\n\r\n\t\tconst pointer = { x: 0, y: 0 };\r\n\t\tconst prevPointer = { x: 0, y: 0 };\r\n\r\n\t\tfunction onMouseDown( event ) {\r\n\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tdistance = 0;\r\n\r\n\t\t\tonMouseDownValue = scope.value;\r\n\r\n\t\t\tprevPointer.x = event.clientX;\r\n\t\t\tprevPointer.y = event.clientY;\r\n\r\n\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\r\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\r\n\r\n\t\t}\r\n\r\n\t\tfunction onMouseMove( event ) {\r\n\r\n\t\t\tconst currentValue = scope.value;\r\n\r\n\t\t\tpointer.x = event.clientX;\r\n\t\t\tpointer.y = event.clientY;\r\n\r\n\t\t\tdistance += ( pointer.x - prevPointer.x ) - ( pointer.y - prevPointer.y );\r\n\r\n\t\t\tlet value = onMouseDownValue + ( distance / ( event.shiftKey ? 5 : 50 ) ) * scope.step;\r\n\t\t\tvalue = Math.min( scope.max, Math.max( scope.min, value ) ) | 0;\r\n\r\n\t\t\tif ( currentValue !== value ) {\r\n\r\n\t\t\t\tscope.setValue( value );\r\n\t\t\t\tscope.dom.dispatchEvent( changeEvent );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tprevPointer.x = event.clientX;\r\n\t\t\tprevPointer.y = event.clientY;\r\n\r\n\t\t}\r\n\r\n\t\tfunction onMouseUp() {\r\n\r\n\t\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\r\n\t\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\r\n\r\n\t\t\tif ( Math.abs( distance ) < 2 ) {\r\n\r\n\t\t\t\tscope.dom.focus();\r\n\t\t\t\tscope.dom.select();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction onChange() {\r\n\r\n\t\t\tscope.setValue( scope.dom.value );\r\n\r\n\t\t}\r\n\r\n\t\tfunction onFocus() {\r\n\r\n\t\t\tscope.dom.style.backgroundColor = '';\r\n\t\t\tscope.dom.style.cursor = '';\r\n\r\n\t\t}\r\n\r\n\t\tfunction onBlur() {\r\n\r\n\t\t\tscope.dom.style.backgroundColor = 'transparent';\r\n\t\t\tscope.dom.style.cursor = 'ns-resize';\r\n\r\n\t\t}\r\n\r\n\t\tfunction onKeyDown( event ) {\r\n\r\n\t\t\tevent.stopPropagation();\r\n\r\n\t\t\tswitch ( event.keyCode ) {\r\n\r\n\t\t\t\tcase 13: // enter\r\n\t\t\t\t\tscope.dom.blur();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 38: // up\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tscope.setValue( scope.getValue() + scope.nudge );\r\n\t\t\t\t\tscope.dom.dispatchEvent( changeEvent );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 40: // down\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tscope.setValue( scope.getValue() - scope.nudge );\r\n\t\t\t\t\tscope.dom.dispatchEvent( changeEvent );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tonBlur();\r\n\r\n\t\tthis.dom.addEventListener( 'keydown', onKeyDown, false );\r\n\t\tthis.dom.addEventListener( 'mousedown', onMouseDown, false );\r\n\t\tthis.dom.addEventListener( 'change', onChange, false );\r\n\t\tthis.dom.addEventListener( 'focus', onFocus, false );\r\n\t\tthis.dom.addEventListener( 'blur', onBlur, false );\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.value;\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\tif ( value !== undefined ) {\r\n\r\n\t\t\tvalue = parseInt( value );\r\n\r\n\t\t\tthis.value = value;\r\n\t\t\tthis.dom.value = value;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetStep( step ) {\r\n\r\n\t\tthis.step = parseInt( step );\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetNudge( nudge ) {\r\n\r\n\t\tthis.nudge = nudge;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tsetRange( min, max ) {\r\n\r\n\t\tthis.min = min;\r\n\t\tthis.max = max;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIBreak extends UIElement {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper( document.createElement( 'br' ) );\r\n\r\n\t\tthis.dom.className = 'Break';\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIHorizontalRule extends UIElement {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper( document.createElement( 'hr' ) );\r\n\r\n\t\tthis.dom.className = 'HorizontalRule';\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIButton extends UIElement {\r\n\r\n\tconstructor( value ) {\r\n\r\n\t\tsuper( document.createElement( 'button' ) );\r\n\r\n\t\tthis.dom.className = 'Button';\r\n\t\tthis.dom.textContent = value;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIProgress extends UIElement {\r\n\r\n\tconstructor( value ) {\r\n\r\n\t\tsuper( document.createElement( 'progress' ) );\r\n\r\n\t\tthis.dom.value = value;\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\tthis.dom.value = value;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UITabbedPanel extends UIDiv {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.dom.className = 'TabbedPanel';\r\n\r\n\t\tthis.tabs = [];\r\n\t\tthis.panels = [];\r\n\r\n\t\tthis.tabsDiv = new UIDiv();\r\n\t\tthis.tabsDiv.setClass( 'Tabs' );\r\n\r\n\t\tthis.panelsDiv = new UIDiv();\r\n\t\tthis.panelsDiv.setClass( 'Panels' );\r\n\r\n\t\tthis.add( this.tabsDiv );\r\n\t\tthis.add( this.panelsDiv );\r\n\r\n\t\tthis.selected = '';\r\n\r\n\t}\r\n\r\n\tselect( id ) {\r\n\r\n\t\tlet tab;\r\n\t\tlet panel;\r\n\t\tconst scope = this;\r\n\r\n\t\t// Deselect current selection\r\n\t\tif ( this.selected && this.selected.length ) {\r\n\r\n\t\t\ttab = this.tabs.find( function ( item ) {\r\n\r\n\t\t\t\treturn item.dom.id === scope.selected;\r\n\r\n\t\t\t} );\r\n\t\t\tpanel = this.panels.find( function ( item ) {\r\n\r\n\t\t\t\treturn item.dom.id === scope.selected;\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tif ( tab ) {\r\n\r\n\t\t\t\ttab.removeClass( 'selected' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( panel ) {\r\n\r\n\t\t\t\tpanel.setDisplay( 'none' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\ttab = this.tabs.find( function ( item ) {\r\n\r\n\t\t\treturn item.dom.id === id;\r\n\r\n\t\t} );\r\n\t\tpanel = this.panels.find( function ( item ) {\r\n\r\n\t\t\treturn item.dom.id === id;\r\n\r\n\t\t} );\r\n\r\n\t\tif ( tab ) {\r\n\r\n\t\t\ttab.addClass( 'selected' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( panel ) {\r\n\r\n\t\t\tpanel.setDisplay( '' );\r\n\r\n\t\t}\r\n\r\n\t\tthis.selected = id;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\taddTab( id, label, items ) {\r\n\r\n\t\tconst tab = new UITab( label, this );\r\n\t\ttab.setId( id );\r\n\t\tthis.tabs.push( tab );\r\n\t\tthis.tabsDiv.add( tab );\r\n\r\n\t\tconst panel = new UIDiv();\r\n\t\tpanel.setId( id );\r\n\t\tpanel.add( items );\r\n\t\tpanel.setDisplay( 'none' );\r\n\t\tthis.panels.push( panel );\r\n\t\tthis.panelsDiv.add( panel );\r\n\r\n\t\tthis.select( id );\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UITab extends UIText {\r\n\r\n\tconstructor( text, parent ) {\r\n\r\n\t\tsuper( text );\r\n\r\n\t\tthis.dom.className = 'Tab';\r\n\r\n\t\tthis.parent = parent;\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\tthis.dom.addEventListener( 'click', function () {\r\n\r\n\t\t\tscope.parent.select( scope.dom.id );\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIListbox extends UIDiv {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.dom.className = 'Listbox';\r\n\t\tthis.dom.tabIndex = 0;\r\n\r\n\t\tthis.items = [];\r\n\t\tthis.listitems = [];\r\n\t\tthis.selectedIndex = 0;\r\n\t\tthis.selectedValue = null;\r\n\r\n\t}\r\n\r\n\tsetItems( items ) {\r\n\r\n\t\tif ( Array.isArray( items ) ) {\r\n\r\n\t\t\tthis.items = items;\r\n\r\n\t\t}\r\n\r\n\t\tthis.render();\r\n\r\n\t}\r\n\r\n\trender( ) {\r\n\r\n\t\twhile ( this.listitems.length ) {\r\n\r\n\t\t\tconst item = this.listitems[ 0 ];\r\n\r\n\t\t\titem.dom.remove();\r\n\r\n\t\t\tthis.listitems.splice( 0, 1 );\r\n\r\n\t\t}\r\n\r\n\t\tfor ( let i = 0; i < this.items.length; i ++ ) {\r\n\r\n\t\t\tconst item = this.items[ i ];\r\n\r\n\t\t\tconst listitem = new UIListbox.ListboxItem( this );\r\n\t\t\tlistitem.setId( item.id || `Listbox-${i}` );\r\n\t\t\tlistitem.setTextContent( item.name || item.type );\r\n\t\t\tthis.add( listitem );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tadd() {\r\n\r\n\t\tconst items = Array.from( arguments );\r\n\r\n\t\tthis.listitems = this.listitems.concat( items );\r\n\r\n\t\tUIElement.prototype.add.apply( this, items );\r\n\r\n\t}\r\n\r\n\tselectIndex( index ) {\r\n\r\n\t\tif ( index >= 0 && index < this.items.length ) {\r\n\r\n\t\t\tthis.setValue( this.listitems[ index ].getId() );\r\n\r\n\t\t}\r\n\r\n\t\tthis.selectedIndex = index;\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.selectedValue;\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\tfor ( let i = 0; i < this.listitems.length; i ++ ) {\r\n\r\n\t\t\tconst element = this.listitems[ i ];\r\n\r\n\t\t\tif ( element.getId() === value ) {\r\n\r\n\t\t\t\telement.addClass( 'active' );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\telement.removeClass( 'active' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.selectedValue = value;\r\n\r\n\t\tconst changeEvent = document.createEvent( 'HTMLEvents' );\r\n\t\tchangeEvent.initEvent( 'change', true, true );\r\n\t\tthis.dom.dispatchEvent( changeEvent );\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass ListboxItem extends UIDiv {\r\n\r\n\tconstructor( parent ) {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.dom.className = 'ListboxItem';\r\n\r\n\t\tthis.parent = parent;\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\tfunction onClick() {\r\n\r\n\t\t\tif ( scope.parent ) {\r\n\r\n\t\t\t\tscope.parent.setValue( scope.getId( ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.dom.addEventListener( 'click', onClick, false );\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { UIElement, UISpan, UIDiv, UIRow, UIPanel, UIText, UIInput, UITextArea, UISelect, UICheckbox, UIColor, UINumber, UIInteger, UIBreak, UIHorizontalRule, UIButton, UIProgress, UITabbedPanel, UIListbox, ListboxItem };\r\n","/**\r\n * @param editor pointer to main editor object used to initialize\r\n *        each command object with a reference to the editor\r\n * @constructor\r\n */\r\n\r\nclass Command {\r\n\r\n\tconstructor( editor ) {\r\n\r\n\t\tthis.id = - 1;\r\n\t\tthis.inMemory = false;\r\n\t\tthis.updatable = false;\r\n\t\tthis.type = '';\r\n\t\tthis.name = '';\r\n\t\tthis.editor = editor;\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = {};\r\n\t\toutput.type = this.type;\r\n\t\toutput.id = this.id;\r\n\t\toutput.name = this.name;\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tthis.inMemory = true;\r\n\t\tthis.type = json.type;\r\n\t\tthis.id = json.id;\r\n\t\tthis.name = json.name;\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { Command };\r\n","import * as THREE from 'three';\r\n\r\nimport { RGBELoader } from './loaders/RGBELoader.js';\r\nimport { TGALoader } from './loaders/TGALoader.js';\r\n\r\nimport { UIElement, UISpan, UIDiv, UIRow, UIButton, UICheckbox, UIText, UINumber } from './ui.js';\r\nimport { MoveObjectCommand } from '../commands/MoveObjectCommand.js';\r\n\r\nclass UITexture extends UISpan {\r\n\r\n\tconstructor( mapping ) {\r\n\r\n\t\tsuper();\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\tconst form = document.createElement( 'form' );\r\n\r\n\t\tconst input = document.createElement( 'input' );\r\n\t\tinput.type = 'file';\r\n\t\tinput.addEventListener( 'change', function ( event ) {\r\n\r\n\t\t\tloadFile( event.target.files[ 0 ] );\r\n\r\n\t\t} );\r\n\t\tform.appendChild( input );\r\n\r\n\t\tconst canvas = document.createElement( 'canvas' );\r\n\t\tcanvas.width = 32;\r\n\t\tcanvas.height = 16;\r\n\t\tcanvas.style.cursor = 'pointer';\r\n\t\tcanvas.style.marginRight = '5px';\r\n\t\tcanvas.style.border = '1px solid #888';\r\n\t\tcanvas.addEventListener( 'click', function () {\r\n\r\n\t\t\tinput.click();\r\n\r\n\t\t}, false );\r\n\t\tcanvas.addEventListener( 'drop', function ( event ) {\r\n\r\n\t\t\tevent.preventDefault();\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tloadFile( event.dataTransfer.files[ 0 ] );\r\n\r\n\t\t}, false );\r\n\t\tthis.dom.appendChild( canvas );\r\n\r\n\t\tfunction loadFile( file ) {\r\n\r\n\t\t\tconst extension = file.name.split( '.' ).pop().toLowerCase();\r\n\t\t\tconst reader = new FileReader();\r\n\r\n\t\t\tif ( extension === 'hdr' ) {\r\n\r\n\t\t\t\treader.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\t\t\t// assuming RGBE/Radiance HDR iamge format\r\n\r\n\t\t\t\t\tconst loader = new RGBELoader().setDataType( THREE.FloatType );\r\n\t\t\t\t\tloader.load( event.target.result, function ( hdrTexture ) {\r\n\r\n\t\t\t\t\t\thdrTexture.sourceFile = file.name;\r\n\t\t\t\t\t\thdrTexture.isHDRTexture = true;\r\n\r\n\t\t\t\t\t\tscope.setValue( hdrTexture );\r\n\r\n\t\t\t\t\t\tif ( scope.onChangeCallback ) scope.onChangeCallback( hdrTexture );\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\treader.readAsDataURL( file );\r\n\r\n\t\t\t} else if ( extension === 'tga' ) {\r\n\r\n\t\t\t\treader.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\t\t\tconst canvas = new TGALoader().parse( event.target.result );\r\n\r\n\t\t\t\t\tconst texture = new THREE.CanvasTexture( canvas, mapping );\r\n\t\t\t\t\ttexture.sourceFile = file.name;\r\n\r\n\t\t\t\t\tscope.setValue( texture );\r\n\r\n\t\t\t\t\tif ( scope.onChangeCallback ) scope.onChangeCallback( texture );\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\treader.readAsArrayBuffer( file );\r\n\r\n\t\t\t} else if ( file.type.match( 'image.*' ) ) {\r\n\r\n\t\t\t\treader.addEventListener( 'load', function ( event ) {\r\n\r\n\t\t\t\t\tconst image = document.createElement( 'img' );\r\n\t\t\t\t\timage.addEventListener( 'load', function () {\r\n\r\n\t\t\t\t\t\tconst texture = new THREE.Texture( this, mapping );\r\n\t\t\t\t\t\ttexture.sourceFile = file.name;\r\n\t\t\t\t\t\ttexture.format = file.type === 'image/jpeg' ? THREE.RGBFormat : THREE.RGBAFormat;\r\n\t\t\t\t\t\ttexture.needsUpdate = true;\r\n\r\n\t\t\t\t\t\tscope.setValue( texture );\r\n\r\n\t\t\t\t\t\tif ( scope.onChangeCallback ) scope.onChangeCallback( texture );\r\n\r\n\t\t\t\t\t}, false );\r\n\r\n\t\t\t\t\timage.src = event.target.result;\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\treader.readAsDataURL( file );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tform.reset();\r\n\r\n\t\t}\r\n\r\n\t\tthis.texture = null;\r\n\t\tthis.onChangeCallback = null;\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.texture;\r\n\r\n\t}\r\n\r\n\tsetValue( texture ) {\r\n\r\n\t\tconst canvas = this.dom.children[ 0 ];\r\n\t\tconst context = canvas.getContext( '2d' );\r\n\r\n\t\t// Seems like context can be null if the canvas is not visible\r\n\t\tif ( context ) {\r\n\r\n\t\t\t// Always clear the context before set new texture, because new texture may has transparency\r\n\t\t\tcontext.clearRect( 0, 0, canvas.width, canvas.height );\r\n\r\n\t\t}\r\n\r\n\t\tif ( texture !== null ) {\r\n\r\n\t\t\tconst image = texture.image;\r\n\r\n\t\t\tif ( image !== undefined && image.width > 0 ) {\r\n\r\n\t\t\t\tcanvas.title = texture.sourceFile;\r\n\t\t\t\tconst scale = canvas.width / image.width;\r\n\r\n\t\t\t\tif ( image.data === undefined ) {\r\n\r\n\t\t\t\t\tcontext.drawImage( image, 0, 0, image.width * scale, image.height * scale );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconst canvas2 = renderToCanvas( texture );\r\n\t\t\t\t\tcontext.drawImage( canvas2, 0, 0, image.width * scale, image.height * scale );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcanvas.title = texture.sourceFile + ' (error)';\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcanvas.title = 'empty';\r\n\r\n\t\t}\r\n\r\n\t\tthis.texture = texture;\r\n\r\n\t}\r\n\r\n\tsetEncoding( encoding ) {\r\n\r\n\t\tconst texture = this.getValue();\r\n\r\n\t\tif ( texture !== null ) {\r\n\r\n\t\t\ttexture.encoding = encoding;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tonChange( callback ) {\r\n\r\n\t\tthis.onChangeCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UICubeTexture extends UIElement {\r\n\r\n\tconstructor() {\r\n\r\n\t\tconst container = new UIDiv();\r\n\r\n\t\tsuper( container.dom );\r\n\r\n\t\tthis.cubeTexture = null;\r\n\t\tthis.onChangeCallback = null;\r\n\r\n\t\tthis.textures = [];\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\tconst pRow = new UIRow();\r\n\t\tconst nRow = new UIRow();\r\n\r\n\t\tpRow.add( new UIText( 'P:' ).setWidth( '35px' ) );\r\n\t\tnRow.add( new UIText( 'N:' ).setWidth( '35px' ) );\r\n\r\n\t\tconst posXTexture = new UITexture().onChange( onTextureChanged );\r\n\t\tconst negXTexture = new UITexture().onChange( onTextureChanged );\r\n\t\tconst posYTexture = new UITexture().onChange( onTextureChanged );\r\n\t\tconst negYTexture = new UITexture().onChange( onTextureChanged );\r\n\t\tconst posZTexture = new UITexture().onChange( onTextureChanged );\r\n\t\tconst negZTexture = new UITexture().onChange( onTextureChanged );\r\n\r\n\t\tthis.textures.push( posXTexture, negXTexture, posYTexture, negYTexture, posZTexture, negZTexture );\r\n\r\n\t\tpRow.add( posXTexture );\r\n\t\tpRow.add( posYTexture );\r\n\t\tpRow.add( posZTexture );\r\n\r\n\t\tnRow.add( negXTexture );\r\n\t\tnRow.add( negYTexture );\r\n\t\tnRow.add( negZTexture );\r\n\r\n\t\tcontainer.add( pRow, nRow );\r\n\r\n\t\tfunction onTextureChanged() {\r\n\r\n\t\t\tconst images = [];\r\n\r\n\t\t\tfor ( let i = 0; i < scope.textures.length; i ++ ) {\r\n\r\n\t\t\t\tconst texture = scope.textures[ i ].getValue();\r\n\r\n\t\t\t\tif ( texture !== null ) {\r\n\r\n\t\t\t\t\timages.push( texture.isHDRTexture ? texture : texture.image );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( images.length === 6 ) {\r\n\r\n\t\t\t\tconst cubeTexture = new THREE.CubeTexture( images );\r\n\t\t\t\tcubeTexture.needsUpdate = true;\r\n\r\n\t\t\t\tif ( images[ 0 ].isHDRTexture ) cubeTexture.isHDRTexture = true;\r\n\r\n\t\t\t\tscope.cubeTexture = cubeTexture;\r\n\r\n\t\t\t\tif ( scope.onChangeCallback ) scope.onChangeCallback( cubeTexture );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tsetEncoding( encoding ) {\r\n\r\n\t\tconst cubeTexture = this.getValue();\r\n\t\tif ( cubeTexture !== null ) {\r\n\r\n\t\t\tcubeTexture.encoding = encoding;\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.cubeTexture;\r\n\r\n\t}\r\n\r\n\tsetValue( cubeTexture ) {\r\n\r\n\t\tthis.cubeTexture = cubeTexture;\r\n\r\n\t\tif ( cubeTexture !== null ) {\r\n\r\n\t\t\tconst images = cubeTexture.image;\r\n\r\n\t\t\tif ( Array.isArray( images ) === true && images.length === 6 ) {\r\n\r\n\t\t\t\tfor ( let i = 0; i < images.length; i ++ ) {\r\n\r\n\t\t\t\t\tconst image = images[ i ];\r\n\r\n\t\t\t\t\tconst texture = new THREE.Texture( image );\r\n\t\t\t\t\tthis.textures[ i ].setValue( texture );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconst textures = this.textures;\r\n\r\n\t\t\tfor ( let i = 0; i < textures.length; i ++ ) {\r\n\r\n\t\t\t\ttextures[ i ].setValue( null );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tonChange( callback ) {\r\n\r\n\t\tthis.onChangeCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIOutliner extends UIDiv {\r\n\r\n\tconstructor( editor ) {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.dom.className = 'Outliner';\r\n\t\tthis.dom.tabIndex = 0;\t// keyup event is ignored without setting tabIndex\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\t// hack\r\n\t\tthis.scene = editor.scene;\r\n\r\n\t\t// Prevent native scroll behavior\r\n\t\tthis.dom.addEventListener( 'keydown', function ( event ) {\r\n\r\n\t\t\tswitch ( event.keyCode ) {\r\n\r\n\t\t\t\tcase 38: // up\r\n\t\t\t\tcase 40: // down\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}, false );\r\n\r\n\t\t// Keybindings to support arrow navigation\r\n\t\tthis.dom.addEventListener( 'keyup', function ( event ) {\r\n\r\n\t\t\tswitch ( event.keyCode ) {\r\n\r\n\t\t\t\tcase 38: // up\r\n\t\t\t\t\tscope.selectIndex( scope.selectedIndex - 1 );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 40: // down\r\n\t\t\t\t\tscope.selectIndex( scope.selectedIndex + 1 );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}, false );\r\n\r\n\t\tthis.editor = editor;\r\n\r\n\t\tthis.options = [];\r\n\t\tthis.selectedIndex = - 1;\r\n\t\tthis.selectedValue = null;\r\n\r\n\t}\r\n\r\n\tselectIndex( index ) {\r\n\r\n\t\tif ( index >= 0 && index < this.options.length ) {\r\n\r\n\t\t\tthis.setValue( this.options[ index ].value );\r\n\r\n\t\t\tconst changeEvent = document.createEvent( 'HTMLEvents' );\r\n\t\t\tchangeEvent.initEvent( 'change', true, true );\r\n\t\t\tthis.dom.dispatchEvent( changeEvent );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tsetOptions( options ) {\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\twhile ( scope.dom.children.length > 0 ) {\r\n\r\n\t\t\tscope.dom.removeChild( scope.dom.firstChild );\r\n\r\n\t\t}\r\n\r\n\t\tfunction onClick() {\r\n\r\n\t\t\tscope.setValue( this.value );\r\n\r\n\t\t\tconst changeEvent = document.createEvent( 'HTMLEvents' );\r\n\t\t\tchangeEvent.initEvent( 'change', true, true );\r\n\t\t\tscope.dom.dispatchEvent( changeEvent );\r\n\r\n\t\t}\r\n\r\n\t\t// Drag\r\n\r\n\t\tlet currentDrag;\r\n\r\n\t\tfunction onDrag() {\r\n\r\n\t\t\tcurrentDrag = this;\r\n\r\n\t\t}\r\n\r\n\t\tfunction onDragStart( event ) {\r\n\r\n\t\t\tevent.dataTransfer.setData( 'text', 'foo' );\r\n\r\n\t\t}\r\n\r\n\t\tfunction onDragOver( event ) {\r\n\r\n\t\t\tif ( this === currentDrag ) return;\r\n\r\n\t\t\tconst area = event.offsetY / this.clientHeight;\r\n\r\n\t\t\tif ( area < 0.25 ) {\r\n\r\n\t\t\t\tthis.className = 'option dragTop';\r\n\r\n\t\t\t} else if ( area > 0.75 ) {\r\n\r\n\t\t\t\tthis.className = 'option dragBottom';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.className = 'option drag';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction onDragLeave() {\r\n\r\n\t\t\tif ( this === currentDrag ) return;\r\n\r\n\t\t\tthis.className = 'option';\r\n\r\n\t\t}\r\n\r\n\t\tfunction onDrop( event ) {\r\n\r\n\t\t\tif ( this === currentDrag || currentDrag === undefined ) return;\r\n\r\n\t\t\tthis.className = 'option';\r\n\r\n\t\t\tconst scene = scope.scene;\r\n\t\t\tconst object = scene.getObjectById( currentDrag.value );\r\n\r\n\t\t\tconst area = event.offsetY / this.clientHeight;\r\n\r\n\t\t\tif ( area < 0.25 ) {\r\n\r\n\t\t\t\tconst nextObject = scene.getObjectById( this.value );\r\n\t\t\t\tmoveObject( object, nextObject.parent, nextObject );\r\n\r\n\t\t\t} else if ( area > 0.75 ) {\r\n\r\n\t\t\t\tlet nextObject, parent;\r\n\r\n\t\t\t\tif ( this.nextSibling !== null ) {\r\n\r\n\t\t\t\t\tnextObject = scene.getObjectById( this.nextSibling.value );\r\n\t\t\t\t\tparent = nextObject.parent;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// end of list (no next object)\r\n\r\n\t\t\t\t\tnextObject = null;\r\n\t\t\t\t\tparent = scene.getObjectById( this.value ).parent;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmoveObject( object, parent, nextObject );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst parentObject = scene.getObjectById( this.value );\r\n\t\t\t\tmoveObject( object, parentObject );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction moveObject( object, newParent, nextObject ) {\r\n\r\n\t\t\tif ( nextObject === null ) nextObject = undefined;\r\n\r\n\t\t\tlet newParentIsChild = false;\r\n\r\n\t\t\tobject.traverse( function ( child ) {\r\n\r\n\t\t\t\tif ( child === newParent ) newParentIsChild = true;\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tif ( newParentIsChild ) return;\r\n\r\n\t\t\tconst editor = scope.editor;\r\n\t\t\teditor.execute( new MoveObjectCommand( editor, object, newParent, nextObject ) );\r\n\r\n\t\t\tconst changeEvent = document.createEvent( 'HTMLEvents' );\r\n\t\t\tchangeEvent.initEvent( 'change', true, true );\r\n\t\t\tscope.dom.dispatchEvent( changeEvent );\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tscope.options = [];\r\n\r\n\t\tfor ( let i = 0; i < options.length; i ++ ) {\r\n\r\n\t\t\tconst div = options[ i ];\r\n\t\t\tdiv.className = 'option';\r\n\t\t\tscope.dom.appendChild( div );\r\n\r\n\t\t\tscope.options.push( div );\r\n\r\n\t\t\tdiv.addEventListener( 'click', onClick );\r\n\r\n\t\t\tif ( div.draggable === true ) {\r\n\r\n\t\t\t\tdiv.addEventListener( 'drag', onDrag );\r\n\t\t\t\tdiv.addEventListener( 'dragstart', onDragStart ); // Firefox needs this\r\n\r\n\t\t\t\tdiv.addEventListener( 'dragover', onDragOver );\r\n\t\t\t\tdiv.addEventListener( 'dragleave', onDragLeave );\r\n\t\t\t\tdiv.addEventListener( 'drop', onDrop );\r\n\r\n\t\t\t}\r\n\r\n\r\n\t\t}\r\n\r\n\t\treturn scope;\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.selectedValue;\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\tfor ( let i = 0; i < this.options.length; i ++ ) {\r\n\r\n\t\t\tconst element = this.options[ i ];\r\n\r\n\t\t\tif ( element.value === value ) {\r\n\r\n\t\t\t\telement.classList.add( 'active' );\r\n\r\n\t\t\t\t// scroll into view\r\n\r\n\t\t\t\tconst y = element.offsetTop - this.dom.offsetTop;\r\n\t\t\t\tconst bottomY = y + element.offsetHeight;\r\n\t\t\t\tconst minScroll = bottomY - this.dom.offsetHeight;\r\n\r\n\t\t\t\tif ( this.dom.scrollTop > y ) {\r\n\r\n\t\t\t\t\tthis.dom.scrollTop = y;\r\n\r\n\t\t\t\t} else if ( this.dom.scrollTop < minScroll ) {\r\n\r\n\t\t\t\t\tthis.dom.scrollTop = minScroll;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.selectedIndex = i;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\telement.classList.remove( 'active' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.selectedValue = value;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIPoints extends UISpan {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.dom.style.display = 'inline-block';\r\n\r\n\t\tthis.pointsList = new UIDiv();\r\n\t\tthis.add( this.pointsList );\r\n\r\n\t\tthis.pointsUI = [];\r\n\t\tthis.lastPointIdx = 0;\r\n\t\tthis.onChangeCallback = null;\r\n\r\n\t\t// TODO Remove this bind() stuff\r\n\r\n\t\tthis.update = function () {\r\n\r\n\t\t\tif ( this.onChangeCallback !== null ) {\r\n\r\n\t\t\t\tthis.onChangeCallback();\r\n\r\n\t\t\t}\r\n\r\n\t\t}.bind( this );\r\n\r\n\t}\r\n\r\n\tonChange( callback ) {\r\n\r\n\t\tthis.onChangeCallback = callback;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tclear() {\r\n\r\n\t\tfor ( let i = 0; i < this.pointsUI.length; ++ i ) {\r\n\r\n\t\t\tif ( this.pointsUI[ i ] ) {\r\n\r\n\t\t\t\tthis.deletePointRow( i, true );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.lastPointIdx = 0;\r\n\r\n\t}\r\n\r\n\tdeletePointRow( idx, dontUpdate ) {\r\n\r\n\t\tif ( ! this.pointsUI[ idx ] ) return;\r\n\r\n\t\tthis.pointsList.remove( this.pointsUI[ idx ].row );\r\n\r\n\t\tthis.pointsUI.splice( idx, 1 );\r\n\r\n\t\tif ( dontUpdate !== true ) {\r\n\r\n\t\t\tthis.update();\r\n\r\n\t\t}\r\n\r\n\t\tthis.lastPointIdx --;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIPoints2 extends UIPoints {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper();\r\n\r\n\t\tconst row = new UIRow();\r\n\t\tthis.add( row );\r\n\r\n\t\tconst addPointButton = new UIButton( '+' );\r\n\t\taddPointButton.onClick( () => {\r\n\r\n\t\t\tif ( this.pointsUI.length === 0 ) {\r\n\r\n\t\t\t\tthis.pointsList.add( this.createPointRow( 0, 0 ) );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst point = this.pointsUI[ this.pointsUI.length - 1 ];\r\n\r\n\t\t\t\tthis.pointsList.add( this.createPointRow( point.x.getValue(), point.y.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.update();\r\n\r\n\t\t} );\r\n\t\trow.add( addPointButton );\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\tconst points = [];\r\n\r\n\t\tlet count = 0;\r\n\r\n\t\tfor ( let i = 0; i < this.pointsUI.length; i ++ ) {\r\n\r\n\t\t\tconst pointUI = this.pointsUI[ i ];\r\n\r\n\t\t\tif ( ! pointUI ) continue;\r\n\r\n\t\t\tpoints.push( new THREE.Vector2( pointUI.x.getValue(), pointUI.y.getValue() ) );\r\n\t\t\t++ count;\r\n\t\t\tpointUI.lbl.setValue( count );\r\n\r\n\t\t}\r\n\r\n\t\treturn points;\r\n\r\n\t}\r\n\r\n\tsetValue( points ) {\r\n\r\n\t\tthis.clear();\r\n\r\n\t\tfor ( let i = 0; i < points.length; i ++ ) {\r\n\r\n\t\t\tconst point = points[ i ];\r\n\t\t\tthis.pointsList.add( this.createPointRow( point.x, point.y ) );\r\n\r\n\t\t}\r\n\r\n\t\tthis.update();\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tcreatePointRow( x, y ) {\r\n\r\n\t\tconst pointRow = new UIDiv();\r\n\t\tconst lbl = new UIText( this.lastPointIdx + 1 ).setWidth( '20px' );\r\n\t\tconst txtX = new UINumber( x ).setWidth( '30px' ).onChange( this.update );\r\n\t\tconst txtY = new UINumber( y ).setWidth( '30px' ).onChange( this.update );\r\n\r\n\t\tconst scope = this;\r\n\t\tconst btn = new UIButton( '-' ).onClick( function () {\r\n\r\n\t\t\tif ( scope.isEditing ) return;\r\n\r\n\t\t\tconst idx = scope.pointsList.getIndexOfChild( pointRow );\r\n\t\t\tscope.deletePointRow( idx );\r\n\r\n\t\t} );\r\n\r\n\t\tthis.pointsUI.push( { row: pointRow, lbl: lbl, x: txtX, y: txtY } );\r\n\t\t++ this.lastPointIdx;\r\n\t\tpointRow.add( lbl, txtX, txtY, btn );\r\n\r\n\t\treturn pointRow;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIPoints3 extends UIPoints {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper();\r\n\r\n\t\tconst row = new UIRow();\r\n\t\tthis.add( row );\r\n\r\n\t\tconst addPointButton = new UIButton( '+' );\r\n\t\taddPointButton.onClick( () => {\r\n\r\n\t\t\tif ( this.pointsUI.length === 0 ) {\r\n\r\n\t\t\t\tthis.pointsList.add( this.createPointRow( 0, 0, 0 ) );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst point = this.pointsUI[ this.pointsUI.length - 1 ];\r\n\r\n\t\t\t\tthis.pointsList.add( this.createPointRow( point.x.getValue(), point.y.getValue(), point.z.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.update();\r\n\r\n\t\t} );\r\n\t\trow.add( addPointButton );\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\tconst points = [];\r\n\t\tlet count = 0;\r\n\r\n\t\tfor ( let i = 0; i < this.pointsUI.length; i ++ ) {\r\n\r\n\t\t\tconst pointUI = this.pointsUI[ i ];\r\n\r\n\t\t\tif ( ! pointUI ) continue;\r\n\r\n\t\t\tpoints.push( new THREE.Vector3( pointUI.x.getValue(), pointUI.y.getValue(), pointUI.z.getValue() ) );\r\n\t\t\t++ count;\r\n\t\t\tpointUI.lbl.setValue( count );\r\n\r\n\t\t}\r\n\r\n\t\treturn points;\r\n\r\n\t}\r\n\r\n\tsetValue( points ) {\r\n\r\n\t\tthis.clear();\r\n\r\n\t\tfor ( let i = 0; i < points.length; i ++ ) {\r\n\r\n\t\t\tconst point = points[ i ];\r\n\t\t\tthis.pointsList.add( this.createPointRow( point.x, point.y, point.z ) );\r\n\r\n\t\t}\r\n\r\n\t\tthis.update();\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tcreatePointRow( x, y, z ) {\r\n\r\n\t\tconst pointRow = new UIDiv();\r\n\t\tconst lbl = new UIText( this.lastPointIdx + 1 ).setWidth( '20px' );\r\n\t\tconst txtX = new UINumber( x ).setWidth( '30px' ).onChange( this.update );\r\n\t\tconst txtY = new UINumber( y ).setWidth( '30px' ).onChange( this.update );\r\n\t\tconst txtZ = new UINumber( z ).setWidth( '30px' ).onChange( this.update );\r\n\r\n\t\tconst scope = this;\r\n\t\tconst btn = new UIButton( '-' ).onClick( function () {\r\n\r\n\t\t\tif ( scope.isEditing ) return;\r\n\r\n\t\t\tconst idx = scope.pointsList.getIndexOfChild( pointRow );\r\n\t\t\tscope.deletePointRow( idx );\r\n\r\n\t\t} );\r\n\r\n\t\tthis.pointsUI.push( { row: pointRow, lbl: lbl, x: txtX, y: txtY, z: txtZ } );\r\n\t\t++ this.lastPointIdx;\r\n\t\tpointRow.add( lbl, txtX, txtY, txtZ, btn );\r\n\r\n\t\treturn pointRow;\r\n\r\n\t}\r\n\r\n}\r\n\r\nclass UIBoolean extends UISpan {\r\n\r\n\tconstructor( boolean, text ) {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.setMarginRight( '4px' );\r\n\r\n\t\tthis.checkbox = new UICheckbox( boolean );\r\n\t\tthis.text = new UIText( text ).setMarginLeft( '3px' );\r\n\r\n\t\tthis.add( this.checkbox );\r\n\t\tthis.add( this.text );\r\n\r\n\t}\r\n\r\n\tgetValue() {\r\n\r\n\t\treturn this.checkbox.getValue();\r\n\r\n\t}\r\n\r\n\tsetValue( value ) {\r\n\r\n\t\treturn this.checkbox.setValue( value );\r\n\r\n\t}\r\n\r\n}\r\n\r\nlet renderer;\r\n\r\nfunction renderToCanvas( texture ) {\r\n\r\n\tif ( renderer === undefined ) {\r\n\r\n\t\trenderer = new THREE.WebGLRenderer();\r\n\t\trenderer.outputEncoding = THREE.sRGBEncoding;\r\n\r\n\t}\r\n\r\n\tconst image = texture.image;\r\n\r\n\trenderer.setSize( image.width, image.height, false );\r\n\r\n\tconst scene = new THREE.Scene();\r\n\tconst camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );\r\n\r\n\tconst material = new THREE.MeshBasicMaterial( { map: texture } );\r\n\tconst quad = new THREE.PlaneGeometry( 2, 2 );\r\n\tconst mesh = new THREE.Mesh( quad, material );\r\n\tscene.add( mesh );\r\n\r\n\trenderer.render( scene, camera );\r\n\r\n\treturn renderer.domElement;\r\n\r\n}\r\n\r\nexport { UITexture, UICubeTexture, UIOutliner, UIPoints, UIPoints2, UIPoints3, UIBoolean };\r\n","import {\r\n\tDataTextureLoader,\r\n\tDataUtils,\r\n\tFloatType,\r\n\tHalfFloatType,\r\n\tLinearEncoding,\r\n\tLinearFilter,\r\n\tNearestFilter,\r\n\tRGBEEncoding,\r\n\tRGBEFormat,\r\n\tRGBFormat,\r\n\tUnsignedByteType\r\n} from 'three';\r\n\r\n// https://github.com/mrdoob/three.js/issues/5552\r\n// http://en.wikipedia.org/wiki/RGBE_image_format\r\n\r\nclass RGBELoader extends DataTextureLoader {\r\n\r\n\tconstructor( manager ) {\r\n\r\n\t\tsuper( manager );\r\n\r\n\t\tthis.type = HalfFloatType;\r\n\r\n\t}\r\n\r\n\t// adapted from http://www.graphics.cornell.edu/~bjw/rgbe.html\r\n\r\n\tparse( buffer ) {\r\n\r\n\t\tconst\r\n\t\t\t/* return codes for rgbe routines */\r\n\t\t\t//RGBE_RETURN_SUCCESS = 0,\r\n\t\t\tRGBE_RETURN_FAILURE = - 1,\r\n\r\n\t\t\t/* default error routine.  change this to change error handling */\r\n\t\t\trgbe_read_error = 1,\r\n\t\t\trgbe_write_error = 2,\r\n\t\t\trgbe_format_error = 3,\r\n\t\t\trgbe_memory_error = 4,\r\n\t\t\trgbe_error = function ( rgbe_error_code, msg ) {\r\n\r\n\t\t\t\tswitch ( rgbe_error_code ) {\r\n\r\n\t\t\t\t\tcase rgbe_read_error: console.error( 'THREE.RGBELoader Read Error: ' + ( msg || '' ) );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase rgbe_write_error: console.error( 'THREE.RGBELoader Write Error: ' + ( msg || '' ) );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase rgbe_format_error: console.error( 'THREE.RGBELoader Bad File Format: ' + ( msg || '' ) );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\tcase rgbe_memory_error: console.error( 'THREE.RGBELoader: Error: ' + ( msg || '' ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn RGBE_RETURN_FAILURE;\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/* offsets to red, green, and blue components in a data (float) pixel */\r\n\t\t\t//RGBE_DATA_RED = 0,\r\n\t\t\t//RGBE_DATA_GREEN = 1,\r\n\t\t\t//RGBE_DATA_BLUE = 2,\r\n\r\n\t\t\t/* number of floats per pixel, use 4 since stored in rgba image format */\r\n\t\t\t//RGBE_DATA_SIZE = 4,\r\n\r\n\t\t\t/* flags indicating which fields in an rgbe_header_info are valid */\r\n\t\t\tRGBE_VALID_PROGRAMTYPE = 1,\r\n\t\t\tRGBE_VALID_FORMAT = 2,\r\n\t\t\tRGBE_VALID_DIMENSIONS = 4,\r\n\r\n\t\t\tNEWLINE = '\\n',\r\n\r\n\t\t\tfgets = function ( buffer, lineLimit, consume ) {\r\n\r\n\t\t\t\tconst chunkSize = 128;\r\n\r\n\t\t\t\tlineLimit = ! lineLimit ? 1024 : lineLimit;\r\n\t\t\t\tlet p = buffer.pos,\r\n\t\t\t\t\ti = - 1, len = 0, s = '',\r\n\t\t\t\t\tchunk = String.fromCharCode.apply( null, new Uint16Array( buffer.subarray( p, p + chunkSize ) ) );\r\n\r\n\t\t\t\twhile ( ( 0 > ( i = chunk.indexOf( NEWLINE ) ) ) && ( len < lineLimit ) && ( p < buffer.byteLength ) ) {\r\n\r\n\t\t\t\t\ts += chunk; len += chunk.length;\r\n\t\t\t\t\tp += chunkSize;\r\n\t\t\t\t\tchunk += String.fromCharCode.apply( null, new Uint16Array( buffer.subarray( p, p + chunkSize ) ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( - 1 < i ) {\r\n\r\n\t\t\t\t\t/*for (i=l-1; i>=0; i--) {\r\n\t\t\t\t\t\tbyteCode = m.charCodeAt(i);\r\n\t\t\t\t\t\tif (byteCode > 0x7f && byteCode <= 0x7ff) byteLen++;\r\n\t\t\t\t\t\telse if (byteCode > 0x7ff && byteCode <= 0xffff) byteLen += 2;\r\n\t\t\t\t\t\tif (byteCode >= 0xDC00 && byteCode <= 0xDFFF) i--; //trail surrogate\r\n\t\t\t\t\t}*/\r\n\t\t\t\t\tif ( false !== consume ) buffer.pos += len + i + 1;\r\n\t\t\t\t\treturn s + chunk.slice( 0, i );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/* minimal header reading.  modify if you want to parse more information */\r\n\t\t\tRGBE_ReadHeader = function ( buffer ) {\r\n\r\n\r\n\t\t\t\t// regexes to parse header info fields\r\n\t\t\t\tconst magic_token_re = /^#\\?(\\S+)/,\r\n\t\t\t\t\tgamma_re = /^\\s*GAMMA\\s*=\\s*(\\d+(\\.\\d+)?)\\s*$/,\r\n\t\t\t\t\texposure_re = /^\\s*EXPOSURE\\s*=\\s*(\\d+(\\.\\d+)?)\\s*$/,\r\n\t\t\t\t\tformat_re = /^\\s*FORMAT=(\\S+)\\s*$/,\r\n\t\t\t\t\tdimensions_re = /^\\s*\\-Y\\s+(\\d+)\\s+\\+X\\s+(\\d+)\\s*$/,\r\n\r\n\t\t\t\t\t// RGBE format header struct\r\n\t\t\t\t\theader = {\r\n\r\n\t\t\t\t\t\tvalid: 0, /* indicate which fields are valid */\r\n\r\n\t\t\t\t\t\tstring: '', /* the actual header string */\r\n\r\n\t\t\t\t\t\tcomments: '', /* comments found in header */\r\n\r\n\t\t\t\t\t\tprogramtype: 'RGBE', /* listed at beginning of file to identify it after \"#?\". defaults to \"RGBE\" */\r\n\r\n\t\t\t\t\t\tformat: '', /* RGBE format, default 32-bit_rle_rgbe */\r\n\r\n\t\t\t\t\t\tgamma: 1.0, /* image has already been gamma corrected with given gamma. defaults to 1.0 (no correction) */\r\n\r\n\t\t\t\t\t\texposure: 1.0, /* a value of 1.0 in an image corresponds to <exposure> watts/steradian/m^2. defaults to 1.0 */\r\n\r\n\t\t\t\t\t\twidth: 0, height: 0 /* image dimensions, width/height */\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\tlet line, match;\r\n\r\n\t\t\t\tif ( buffer.pos >= buffer.byteLength || ! ( line = fgets( buffer ) ) ) {\r\n\r\n\t\t\t\t\treturn rgbe_error( rgbe_read_error, 'no header found' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/* if you want to require the magic token then uncomment the next line */\r\n\t\t\t\tif ( ! ( match = line.match( magic_token_re ) ) ) {\r\n\r\n\t\t\t\t\treturn rgbe_error( rgbe_format_error, 'bad initial token' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\theader.valid |= RGBE_VALID_PROGRAMTYPE;\r\n\t\t\t\theader.programtype = match[ 1 ];\r\n\t\t\t\theader.string += line + '\\n';\r\n\r\n\t\t\t\twhile ( true ) {\r\n\r\n\t\t\t\t\tline = fgets( buffer );\r\n\t\t\t\t\tif ( false === line ) break;\r\n\t\t\t\t\theader.string += line + '\\n';\r\n\r\n\t\t\t\t\tif ( '#' === line.charAt( 0 ) ) {\r\n\r\n\t\t\t\t\t\theader.comments += line + '\\n';\r\n\t\t\t\t\t\tcontinue; // comment line\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( match = line.match( gamma_re ) ) {\r\n\r\n\t\t\t\t\t\theader.gamma = parseFloat( match[ 1 ], 10 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( match = line.match( exposure_re ) ) {\r\n\r\n\t\t\t\t\t\theader.exposure = parseFloat( match[ 1 ], 10 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( match = line.match( format_re ) ) {\r\n\r\n\t\t\t\t\t\theader.valid |= RGBE_VALID_FORMAT;\r\n\t\t\t\t\t\theader.format = match[ 1 ];//'32-bit_rle_rgbe';\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( match = line.match( dimensions_re ) ) {\r\n\r\n\t\t\t\t\t\theader.valid |= RGBE_VALID_DIMENSIONS;\r\n\t\t\t\t\t\theader.height = parseInt( match[ 1 ], 10 );\r\n\t\t\t\t\t\theader.width = parseInt( match[ 2 ], 10 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( ( header.valid & RGBE_VALID_FORMAT ) && ( header.valid & RGBE_VALID_DIMENSIONS ) ) break;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! ( header.valid & RGBE_VALID_FORMAT ) ) {\r\n\r\n\t\t\t\t\treturn rgbe_error( rgbe_format_error, 'missing format specifier' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( ! ( header.valid & RGBE_VALID_DIMENSIONS ) ) {\r\n\r\n\t\t\t\t\treturn rgbe_error( rgbe_format_error, 'missing image size specifier' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn header;\r\n\r\n\t\t\t},\r\n\r\n\t\t\tRGBE_ReadPixels_RLE = function ( buffer, w, h ) {\r\n\r\n\t\t\t\tconst scanline_width = w;\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\t// run length encoding is not allowed so read flat\r\n\t\t\t\t\t( ( scanline_width < 8 ) || ( scanline_width > 0x7fff ) ) ||\r\n\t\t\t\t\t// this file is not run length encoded\r\n\t\t\t\t\t( ( 2 !== buffer[ 0 ] ) || ( 2 !== buffer[ 1 ] ) || ( buffer[ 2 ] & 0x80 ) )\r\n\t\t\t\t) {\r\n\r\n\t\t\t\t\t// return the flat buffer\r\n\t\t\t\t\treturn new Uint8Array( buffer );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( scanline_width !== ( ( buffer[ 2 ] << 8 ) | buffer[ 3 ] ) ) {\r\n\r\n\t\t\t\t\treturn rgbe_error( rgbe_format_error, 'wrong scanline width' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst data_rgba = new Uint8Array( 4 * w * h );\r\n\r\n\t\t\t\tif ( ! data_rgba.length ) {\r\n\r\n\t\t\t\t\treturn rgbe_error( rgbe_memory_error, 'unable to allocate buffer space' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet offset = 0, pos = 0;\r\n\r\n\t\t\t\tconst ptr_end = 4 * scanline_width;\r\n\t\t\t\tconst rgbeStart = new Uint8Array( 4 );\r\n\t\t\t\tconst scanline_buffer = new Uint8Array( ptr_end );\r\n\t\t\t\tlet num_scanlines = h;\r\n\r\n\t\t\t\t// read in each successive scanline\r\n\t\t\t\twhile ( ( num_scanlines > 0 ) && ( pos < buffer.byteLength ) ) {\r\n\r\n\t\t\t\t\tif ( pos + 4 > buffer.byteLength ) {\r\n\r\n\t\t\t\t\t\treturn rgbe_error( rgbe_read_error );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trgbeStart[ 0 ] = buffer[ pos ++ ];\r\n\t\t\t\t\trgbeStart[ 1 ] = buffer[ pos ++ ];\r\n\t\t\t\t\trgbeStart[ 2 ] = buffer[ pos ++ ];\r\n\t\t\t\t\trgbeStart[ 3 ] = buffer[ pos ++ ];\r\n\r\n\t\t\t\t\tif ( ( 2 != rgbeStart[ 0 ] ) || ( 2 != rgbeStart[ 1 ] ) || ( ( ( rgbeStart[ 2 ] << 8 ) | rgbeStart[ 3 ] ) != scanline_width ) ) {\r\n\r\n\t\t\t\t\t\treturn rgbe_error( rgbe_format_error, 'bad rgbe scanline format' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// read each of the four channels for the scanline into the buffer\r\n\t\t\t\t\t// first red, then green, then blue, then exponent\r\n\t\t\t\t\tlet ptr = 0, count;\r\n\r\n\t\t\t\t\twhile ( ( ptr < ptr_end ) && ( pos < buffer.byteLength ) ) {\r\n\r\n\t\t\t\t\t\tcount = buffer[ pos ++ ];\r\n\t\t\t\t\t\tconst isEncodedRun = count > 128;\r\n\t\t\t\t\t\tif ( isEncodedRun ) count -= 128;\r\n\r\n\t\t\t\t\t\tif ( ( 0 === count ) || ( ptr + count > ptr_end ) ) {\r\n\r\n\t\t\t\t\t\t\treturn rgbe_error( rgbe_format_error, 'bad scanline data' );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( isEncodedRun ) {\r\n\r\n\t\t\t\t\t\t\t// a (encoded) run of the same value\r\n\t\t\t\t\t\t\tconst byteValue = buffer[ pos ++ ];\r\n\t\t\t\t\t\t\tfor ( let i = 0; i < count; i ++ ) {\r\n\r\n\t\t\t\t\t\t\t\tscanline_buffer[ ptr ++ ] = byteValue;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t//ptr += count;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// a literal-run\r\n\t\t\t\t\t\t\tscanline_buffer.set( buffer.subarray( pos, pos + count ), ptr );\r\n\t\t\t\t\t\t\tptr += count; pos += count;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t// now convert data from buffer into rgba\r\n\t\t\t\t\t// first red, then green, then blue, then exponent (alpha)\r\n\t\t\t\t\tconst l = scanline_width; //scanline_buffer.byteLength;\r\n\t\t\t\t\tfor ( let i = 0; i < l; i ++ ) {\r\n\r\n\t\t\t\t\t\tlet off = 0;\r\n\t\t\t\t\t\tdata_rgba[ offset ] = scanline_buffer[ i + off ];\r\n\t\t\t\t\t\toff += scanline_width; //1;\r\n\t\t\t\t\t\tdata_rgba[ offset + 1 ] = scanline_buffer[ i + off ];\r\n\t\t\t\t\t\toff += scanline_width; //1;\r\n\t\t\t\t\t\tdata_rgba[ offset + 2 ] = scanline_buffer[ i + off ];\r\n\t\t\t\t\t\toff += scanline_width; //1;\r\n\t\t\t\t\t\tdata_rgba[ offset + 3 ] = scanline_buffer[ i + off ];\r\n\t\t\t\t\t\toffset += 4;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tnum_scanlines --;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn data_rgba;\r\n\r\n\t\t\t};\r\n\r\n\t\tconst RGBEByteToRGBFloat = function ( sourceArray, sourceOffset, destArray, destOffset ) {\r\n\r\n\t\t\tconst e = sourceArray[ sourceOffset + 3 ];\r\n\t\t\tconst scale = Math.pow( 2.0, e - 128.0 ) / 255.0;\r\n\r\n\t\t\tdestArray[ destOffset + 0 ] = sourceArray[ sourceOffset + 0 ] * scale;\r\n\t\t\tdestArray[ destOffset + 1 ] = sourceArray[ sourceOffset + 1 ] * scale;\r\n\t\t\tdestArray[ destOffset + 2 ] = sourceArray[ sourceOffset + 2 ] * scale;\r\n\r\n\t\t};\r\n\r\n\t\tconst RGBEByteToRGBHalf = function ( sourceArray, sourceOffset, destArray, destOffset ) {\r\n\r\n\t\t\tconst e = sourceArray[ sourceOffset + 3 ];\r\n\t\t\tconst scale = Math.pow( 2.0, e - 128.0 ) / 255.0;\r\n\r\n\t\t\tdestArray[ destOffset + 0 ] = DataUtils.toHalfFloat( sourceArray[ sourceOffset + 0 ] * scale );\r\n\t\t\tdestArray[ destOffset + 1 ] = DataUtils.toHalfFloat( sourceArray[ sourceOffset + 1 ] * scale );\r\n\t\t\tdestArray[ destOffset + 2 ] = DataUtils.toHalfFloat( sourceArray[ sourceOffset + 2 ] * scale );\r\n\r\n\t\t};\r\n\r\n\t\tconst byteArray = new Uint8Array( buffer );\r\n\t\tbyteArray.pos = 0;\r\n\t\tconst rgbe_header_info = RGBE_ReadHeader( byteArray );\r\n\r\n\t\tif ( RGBE_RETURN_FAILURE !== rgbe_header_info ) {\r\n\r\n\t\t\tconst w = rgbe_header_info.width,\r\n\t\t\t\th = rgbe_header_info.height,\r\n\t\t\t\timage_rgba_data = RGBE_ReadPixels_RLE( byteArray.subarray( byteArray.pos ), w, h );\r\n\r\n\t\t\tif ( RGBE_RETURN_FAILURE !== image_rgba_data ) {\r\n\r\n\t\t\t\tlet data, format, type;\r\n\t\t\t\tlet numElements;\r\n\r\n\t\t\t\tswitch ( this.type ) {\r\n\r\n\t\t\t\t\tcase UnsignedByteType:\r\n\r\n\t\t\t\t\t\tdata = image_rgba_data;\r\n\t\t\t\t\t\tformat = RGBEFormat; // handled as THREE.RGBAFormat in shaders\r\n\t\t\t\t\t\ttype = UnsignedByteType;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase FloatType:\r\n\r\n\t\t\t\t\t\tnumElements = ( image_rgba_data.length / 4 ) * 3;\r\n\t\t\t\t\t\tconst floatArray = new Float32Array( numElements );\r\n\r\n\t\t\t\t\t\tfor ( let j = 0; j < numElements; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tRGBEByteToRGBFloat( image_rgba_data, j * 4, floatArray, j * 3 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdata = floatArray;\r\n\t\t\t\t\t\tformat = RGBFormat;\r\n\t\t\t\t\t\ttype = FloatType;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase HalfFloatType:\r\n\r\n\t\t\t\t\t\tnumElements = ( image_rgba_data.length / 4 ) * 3;\r\n\t\t\t\t\t\tconst halfArray = new Uint16Array( numElements );\r\n\r\n\t\t\t\t\t\tfor ( let j = 0; j < numElements; j ++ ) {\r\n\r\n\t\t\t\t\t\t\tRGBEByteToRGBHalf( image_rgba_data, j * 4, halfArray, j * 3 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tdata = halfArray;\r\n\t\t\t\t\t\tformat = RGBFormat;\r\n\t\t\t\t\t\ttype = HalfFloatType;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.RGBELoader: unsupported type: ', this.type );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\twidth: w, height: h,\r\n\t\t\t\t\tdata: data,\r\n\t\t\t\t\theader: rgbe_header_info.string,\r\n\t\t\t\t\tgamma: rgbe_header_info.gamma,\r\n\t\t\t\t\texposure: rgbe_header_info.exposure,\r\n\t\t\t\t\tformat: format,\r\n\t\t\t\t\ttype: type\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\tsetDataType( value ) {\r\n\r\n\t\tthis.type = value;\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tload( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tfunction onLoadCallback( texture, texData ) {\r\n\r\n\t\t\tswitch ( texture.type ) {\r\n\r\n\t\t\t\tcase UnsignedByteType:\r\n\r\n\t\t\t\t\ttexture.encoding = RGBEEncoding;\r\n\t\t\t\t\ttexture.minFilter = NearestFilter;\r\n\t\t\t\t\ttexture.magFilter = NearestFilter;\r\n\t\t\t\t\ttexture.generateMipmaps = false;\r\n\t\t\t\t\ttexture.flipY = true;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase FloatType:\r\n\r\n\t\t\t\t\ttexture.encoding = LinearEncoding;\r\n\t\t\t\t\ttexture.minFilter = LinearFilter;\r\n\t\t\t\t\ttexture.magFilter = LinearFilter;\r\n\t\t\t\t\ttexture.generateMipmaps = false;\r\n\t\t\t\t\ttexture.flipY = true;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase HalfFloatType:\r\n\r\n\t\t\t\t\ttexture.encoding = LinearEncoding;\r\n\t\t\t\t\ttexture.minFilter = LinearFilter;\r\n\t\t\t\t\ttexture.magFilter = LinearFilter;\r\n\t\t\t\t\ttexture.generateMipmaps = false;\r\n\t\t\t\t\ttexture.flipY = true;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( onLoad ) onLoad( texture, texData );\r\n\r\n\t\t}\r\n\r\n\t\treturn super.load( url, onLoadCallback, onProgress, onError );\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { RGBELoader };\r\n","import { Command } from '../Command.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param newParent THREE.Object3D\r\n * @param newBefore THREE.Object3D\r\n * @constructor\r\n */\r\nclass MoveObjectCommand extends Command {\r\n\r\n\tconstructor( editor, object, newParent, newBefore ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'MoveObjectCommand';\r\n\t\tthis.name = 'Move Object';\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.oldParent = ( object !== undefined ) ? object.parent : undefined;\r\n\t\tthis.oldIndex = ( this.oldParent !== undefined ) ? this.oldParent.children.indexOf( this.object ) : undefined;\r\n\t\tthis.newParent = newParent;\r\n\r\n\t\tif ( newBefore !== undefined ) {\r\n\r\n\t\t\tthis.newIndex = ( newParent !== undefined ) ? newParent.children.indexOf( newBefore ) : undefined;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.newIndex = ( newParent !== undefined ) ? newParent.children.length : undefined;\r\n\r\n\t\t}\r\n\r\n\t\tif ( this.oldParent === this.newParent && this.newIndex > this.oldIndex ) {\r\n\r\n\t\t\tthis.newIndex --;\r\n\r\n\t\t}\r\n\r\n\t\tthis.newBefore = newBefore;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.oldParent.remove( this.object );\r\n\r\n\t\tconst children = this.newParent.children;\r\n\t\tchildren.splice( this.newIndex, 0, this.object );\r\n\t\tthis.object.parent = this.newParent;\r\n\r\n\t\tthis.object.dispatchEvent( { type: 'added' } );\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.newParent.remove( this.object );\r\n\r\n\t\tconst children = this.oldParent.children;\r\n\t\tchildren.splice( this.oldIndex, 0, this.object );\r\n\t\tthis.object.parent = this.oldParent;\r\n\r\n\t\tthis.object.dispatchEvent( { type: 'added' } );\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.newParentUuid = this.newParent.uuid;\r\n\t\toutput.oldParentUuid = this.oldParent.uuid;\r\n\t\toutput.newIndex = this.newIndex;\r\n\t\toutput.oldIndex = this.oldIndex;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\t\tthis.oldParent = this.editor.objectByUuid( json.oldParentUuid );\r\n\t\tif ( this.oldParent === undefined ) {\r\n\r\n\t\t\tthis.oldParent = this.editor.scene;\r\n\r\n\t\t}\r\n\r\n\t\tthis.newParent = this.editor.objectByUuid( json.newParentUuid );\r\n\r\n\t\tif ( this.newParent === undefined ) {\r\n\r\n\t\t\tthis.newParent = this.editor.scene;\r\n\r\n\t\t}\r\n\r\n\t\tthis.newIndex = json.newIndex;\r\n\t\tthis.oldIndex = json.oldIndex;\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { MoveObjectCommand };\r\n","import {\r\n\tDataTextureLoader,\r\n\tLinearMipmapLinearFilter\r\n} from 'three';\r\n\r\nclass TGALoader extends DataTextureLoader {\r\n\r\n\tconstructor( manager ) {\r\n\r\n\t\tsuper( manager );\r\n\r\n\t}\r\n\r\n\tparse( buffer ) {\r\n\r\n\t\t// reference from vthibault, https://github.com/vthibault/roBrowser/blob/master/src/Loaders/Targa.js\r\n\r\n\t\tfunction tgaCheckHeader( header ) {\r\n\r\n\t\t\tswitch ( header.image_type ) {\r\n\r\n\t\t\t\t// check indexed type\r\n\r\n\t\t\t\tcase TGA_TYPE_INDEXED:\r\n\t\t\t\tcase TGA_TYPE_RLE_INDEXED:\r\n\t\t\t\t\tif ( header.colormap_length > 256 || header.colormap_size !== 24 || header.colormap_type !== 1 ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.TGALoader: Invalid type colormap data for indexed type.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t// check colormap type\r\n\r\n\t\t\t\tcase TGA_TYPE_RGB:\r\n\t\t\t\tcase TGA_TYPE_GREY:\r\n\t\t\t\tcase TGA_TYPE_RLE_RGB:\r\n\t\t\t\tcase TGA_TYPE_RLE_GREY:\r\n\t\t\t\t\tif ( header.colormap_type ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.TGALoader: Invalid type colormap data for colormap type.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t// What the need of a file without data ?\r\n\r\n\t\t\t\tcase TGA_TYPE_NO_DATA:\r\n\t\t\t\t\tconsole.error( 'THREE.TGALoader: No data.' );\r\n\r\n\t\t\t\t\t// Invalid type ?\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.error( 'THREE.TGALoader: Invalid type \"%s\".', header.image_type );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// check image width and height\r\n\r\n\t\t\tif ( header.width <= 0 || header.height <= 0 ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.TGALoader: Invalid image size.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// check image pixel size\r\n\r\n\t\t\tif ( header.pixel_size !== 8 && header.pixel_size !== 16 &&\r\n\t\t\t\theader.pixel_size !== 24 && header.pixel_size !== 32 ) {\r\n\r\n\t\t\t\tconsole.error( 'THREE.TGALoader: Invalid pixel size \"%s\".', header.pixel_size );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// parse tga image buffer\r\n\r\n\t\tfunction tgaParse( use_rle, use_pal, header, offset, data ) {\r\n\r\n\t\t\tlet pixel_data,\r\n\t\t\t\tpalettes;\r\n\r\n\t\t\tconst pixel_size = header.pixel_size >> 3;\r\n\t\t\tconst pixel_total = header.width * header.height * pixel_size;\r\n\r\n\t\t\t // read palettes\r\n\r\n\t\t\t if ( use_pal ) {\r\n\r\n\t\t\t\t palettes = data.subarray( offset, offset += header.colormap_length * ( header.colormap_size >> 3 ) );\r\n\r\n\t\t\t }\r\n\r\n\t\t\t // read RLE\r\n\r\n\t\t\t if ( use_rle ) {\r\n\r\n\t\t\t\t pixel_data = new Uint8Array( pixel_total );\r\n\r\n\t\t\t\tlet c, count, i;\r\n\t\t\t\tlet shift = 0;\r\n\t\t\t\tconst pixels = new Uint8Array( pixel_size );\r\n\r\n\t\t\t\twhile ( shift < pixel_total ) {\r\n\r\n\t\t\t\t\tc = data[ offset ++ ];\r\n\t\t\t\t\tcount = ( c & 0x7f ) + 1;\r\n\r\n\t\t\t\t\t// RLE pixels\r\n\r\n\t\t\t\t\tif ( c & 0x80 ) {\r\n\r\n\t\t\t\t\t\t// bind pixel tmp array\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < pixel_size; ++ i ) {\r\n\r\n\t\t\t\t\t\t\tpixels[ i ] = data[ offset ++ ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// copy pixel array\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < count; ++ i ) {\r\n\r\n\t\t\t\t\t\t\tpixel_data.set( pixels, shift + i * pixel_size );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tshift += pixel_size * count;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// raw pixels\r\n\r\n\t\t\t\t\t\tcount *= pixel_size;\r\n\r\n\t\t\t\t\t\tfor ( i = 0; i < count; ++ i ) {\r\n\r\n\t\t\t\t\t\t\tpixel_data[ shift + i ] = data[ offset ++ ];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tshift += count;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t } else {\r\n\r\n\t\t\t\t// raw pixels\r\n\r\n\t\t\t\tpixel_data = data.subarray(\r\n\t\t\t\t\t offset, offset += ( use_pal ? header.width * header.height : pixel_total )\r\n\t\t\t\t);\r\n\r\n\t\t\t }\r\n\r\n\t\t\t return {\r\n\t\t\t\tpixel_data: pixel_data,\r\n\t\t\t\tpalettes: palettes\r\n\t\t\t };\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageData8bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image, palettes ) {\r\n\r\n\t\t\tconst colormap = palettes;\r\n\t\t\tlet color, i = 0, x, y;\r\n\t\t\tconst width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i ++ ) {\r\n\r\n\t\t\t\t\tcolor = image[ i ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = 255;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = colormap[ ( color * 3 ) + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = colormap[ ( color * 3 ) + 1 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = colormap[ ( color * 3 ) + 2 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageData16bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image ) {\r\n\r\n\t\t\tlet color, i = 0, x, y;\r\n\t\t\tconst width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i += 2 ) {\r\n\r\n\t\t\t\t\tcolor = image[ i + 0 ] + ( image[ i + 1 ] << 8 );\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = ( color & 0x7C00 ) >> 7;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = ( color & 0x03E0 ) >> 2;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = ( color & 0x001F ) << 3;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = ( color & 0x8000 ) ? 0 : 255;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageData24bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image ) {\r\n\r\n\t\t\tlet i = 0, x, y;\r\n\t\t\tconst width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i += 3 ) {\r\n\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = 255;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = image[ i + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = image[ i + 1 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = image[ i + 2 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageData32bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image ) {\r\n\r\n\t\t\tlet i = 0, x, y;\r\n\t\t\tconst width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i += 4 ) {\r\n\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = image[ i + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = image[ i + 1 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = image[ i + 2 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = image[ i + 3 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageDataGrey8bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image ) {\r\n\r\n\t\t\tlet color, i = 0, x, y;\r\n\t\t\tconst width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i ++ ) {\r\n\r\n\t\t\t\t\tcolor = image[ i ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = color;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = color;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = color;\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = 255;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction tgaGetImageDataGrey16bits( imageData, y_start, y_step, y_end, x_start, x_step, x_end, image ) {\r\n\r\n\t\t\tlet i = 0, x, y;\r\n\t\t\tconst width = header.width;\r\n\r\n\t\t\tfor ( y = y_start; y !== y_end; y += y_step ) {\r\n\r\n\t\t\t\tfor ( x = x_start; x !== x_end; x += x_step, i += 2 ) {\r\n\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 0 ] = image[ i + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 1 ] = image[ i + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 2 ] = image[ i + 0 ];\r\n\t\t\t\t\timageData[ ( x + width * y ) * 4 + 3 ] = image[ i + 1 ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn imageData;\r\n\r\n\t\t}\r\n\r\n\t\tfunction getTgaRGBA( data, width, height, image, palette ) {\r\n\r\n\t\t\tlet x_start,\r\n\t\t\t\ty_start,\r\n\t\t\t\tx_step,\r\n\t\t\t\ty_step,\r\n\t\t\t\tx_end,\r\n\t\t\t\ty_end;\r\n\r\n\t\t\tswitch ( ( header.flags & TGA_ORIGIN_MASK ) >> TGA_ORIGIN_SHIFT ) {\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\tcase TGA_ORIGIN_UL:\r\n\t\t\t\t\tx_start = 0;\r\n\t\t\t\t\tx_step = 1;\r\n\t\t\t\t\tx_end = width;\r\n\t\t\t\t\ty_start = 0;\r\n\t\t\t\t\ty_step = 1;\r\n\t\t\t\t\ty_end = height;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase TGA_ORIGIN_BL:\r\n\t\t\t\t\tx_start = 0;\r\n\t\t\t\t\tx_step = 1;\r\n\t\t\t\t\tx_end = width;\r\n\t\t\t\t\ty_start = height - 1;\r\n\t\t\t\t\ty_step = - 1;\r\n\t\t\t\t\ty_end = - 1;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase TGA_ORIGIN_UR:\r\n\t\t\t\t\tx_start = width - 1;\r\n\t\t\t\t\tx_step = - 1;\r\n\t\t\t\t\tx_end = - 1;\r\n\t\t\t\t\ty_start = 0;\r\n\t\t\t\t\ty_step = 1;\r\n\t\t\t\t\ty_end = height;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase TGA_ORIGIN_BR:\r\n\t\t\t\t\tx_start = width - 1;\r\n\t\t\t\t\tx_step = - 1;\r\n\t\t\t\t\tx_end = - 1;\r\n\t\t\t\t\ty_start = height - 1;\r\n\t\t\t\t\ty_step = - 1;\r\n\t\t\t\t\ty_end = - 1;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( use_grey ) {\r\n\r\n\t\t\t\tswitch ( header.pixel_size ) {\r\n\r\n\t\t\t\t\tcase 8:\r\n\t\t\t\t\t\ttgaGetImageDataGrey8bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 16:\r\n\t\t\t\t\t\ttgaGetImageDataGrey16bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.error( 'THREE.TGALoader: Format not supported.' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tswitch ( header.pixel_size ) {\r\n\r\n\t\t\t\t\tcase 8:\r\n\t\t\t\t\t\ttgaGetImageData8bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image, palette );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 16:\r\n\t\t\t\t\t\ttgaGetImageData16bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 24:\r\n\t\t\t\t\t\ttgaGetImageData24bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 32:\r\n\t\t\t\t\t\ttgaGetImageData32bits( data, y_start, y_step, y_end, x_start, x_step, x_end, image );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.error( 'THREE.TGALoader: Format not supported.' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Load image data according to specific method\r\n\t\t\t// let func = 'tgaGetImageData' + (use_grey ? 'Grey' : '') + (header.pixel_size) + 'bits';\r\n\t\t\t// func(data, y_start, y_step, y_end, x_start, x_step, x_end, width, image, palette );\r\n\t\t\treturn data;\r\n\r\n\t\t}\r\n\r\n\t\t// TGA constants\r\n\r\n\t\tconst TGA_TYPE_NO_DATA = 0,\r\n\t\t\tTGA_TYPE_INDEXED = 1,\r\n\t\t\tTGA_TYPE_RGB = 2,\r\n\t\t\tTGA_TYPE_GREY = 3,\r\n\t\t\tTGA_TYPE_RLE_INDEXED = 9,\r\n\t\t\tTGA_TYPE_RLE_RGB = 10,\r\n\t\t\tTGA_TYPE_RLE_GREY = 11,\r\n\r\n\t\t\tTGA_ORIGIN_MASK = 0x30,\r\n\t\t\tTGA_ORIGIN_SHIFT = 0x04,\r\n\t\t\tTGA_ORIGIN_BL = 0x00,\r\n\t\t\tTGA_ORIGIN_BR = 0x01,\r\n\t\t\tTGA_ORIGIN_UL = 0x02,\r\n\t\t\tTGA_ORIGIN_UR = 0x03;\r\n\r\n\t\tif ( buffer.length < 19 ) console.error( 'THREE.TGALoader: Not enough data to contain header.' );\r\n\r\n\t\tlet offset = 0;\r\n\r\n\t\tconst content = new Uint8Array( buffer ),\r\n\t\t\theader = {\r\n\t\t\t\tid_length: content[ offset ++ ],\r\n\t\t\t\tcolormap_type: content[ offset ++ ],\r\n\t\t\t\timage_type: content[ offset ++ ],\r\n\t\t\t\tcolormap_index: content[ offset ++ ] | content[ offset ++ ] << 8,\r\n\t\t\t\tcolormap_length: content[ offset ++ ] | content[ offset ++ ] << 8,\r\n\t\t\t\tcolormap_size: content[ offset ++ ],\r\n\t\t\t\torigin: [\r\n\t\t\t\t\tcontent[ offset ++ ] | content[ offset ++ ] << 8,\r\n\t\t\t\t\tcontent[ offset ++ ] | content[ offset ++ ] << 8\r\n\t\t\t\t],\r\n\t\t\t\twidth: content[ offset ++ ] | content[ offset ++ ] << 8,\r\n\t\t\t\theight: content[ offset ++ ] | content[ offset ++ ] << 8,\r\n\t\t\t\tpixel_size: content[ offset ++ ],\r\n\t\t\t\tflags: content[ offset ++ ]\r\n\t\t\t};\r\n\r\n\t\t// check tga if it is valid format\r\n\r\n\t\ttgaCheckHeader( header );\r\n\r\n\t\tif ( header.id_length + offset > buffer.length ) {\r\n\r\n\t\t\tconsole.error( 'THREE.TGALoader: No data.' );\r\n\r\n\t\t}\r\n\r\n\t\t// skip the needn't data\r\n\r\n\t\toffset += header.id_length;\r\n\r\n\t\t// get targa information about RLE compression and palette\r\n\r\n\t\tlet use_rle = false,\r\n\t\t\tuse_pal = false,\r\n\t\t\tuse_grey = false;\r\n\r\n\t\tswitch ( header.image_type ) {\r\n\r\n\t\t\tcase TGA_TYPE_RLE_INDEXED:\r\n\t\t\t\tuse_rle = true;\r\n\t\t\t\tuse_pal = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase TGA_TYPE_INDEXED:\r\n\t\t\t\tuse_pal = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase TGA_TYPE_RLE_RGB:\r\n\t\t\t\tuse_rle = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase TGA_TYPE_RGB:\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase TGA_TYPE_RLE_GREY:\r\n\t\t\t\tuse_rle = true;\r\n\t\t\t\tuse_grey = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase TGA_TYPE_GREY:\r\n\t\t\t\tuse_grey = true;\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tconst imageData = new Uint8Array( header.width * header.height * 4 );\r\n\t\tconst result = tgaParse( use_rle, use_pal, header, offset, content );\r\n\t\tgetTgaRGBA( imageData, header.width, header.height, result.pixel_data, result.palettes );\r\n\r\n\t\treturn {\r\n\r\n\t\t\tdata: imageData,\r\n\t\t\twidth: header.width,\r\n\t\t\theight: header.height,\r\n\t\t\tflipY: true,\r\n\t\t\tgenerateMipmaps: true,\r\n\t\t\tminFilter: LinearMipmapLinearFilter,\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { TGALoader };\r\n","import { UIRow, UIText, UISpan, UIBreak } from './libs/ui.js';\r\n\r\nfunction SidebarGeometryBufferGeometry( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar signals = editor.signals;\r\n\r\n\tvar container = new UIRow();\r\n\r\n\tfunction update( object ) {\r\n\r\n\t\tif ( object === null ) return; // objectSelected.dispatch( null )\r\n\t\tif ( object === undefined ) return;\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( geometry && geometry.isBufferGeometry ) {\r\n\r\n\t\t\tcontainer.clear();\r\n\t\t\tcontainer.setDisplay( 'block' );\r\n\r\n\t\t\tvar text = new UIText( strings.getKey( 'sidebar/geometry/buffer_geometry/attributes' ) ).setWidth( '90px' );\r\n\t\t\tcontainer.add( text );\r\n\r\n\t\t\tvar container2 = new UISpan().setDisplay( 'inline-block' ).setVerticalAlign( 'middle' ).setWidth( '160px' );\r\n\t\t\tcontainer.add( container2 );\r\n\r\n\t\t\tvar index = geometry.index;\r\n\r\n\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\tcontainer2.add( new UIText( strings.getKey( 'sidebar/geometry/buffer_geometry/index' ) ).setWidth( '80px' ) );\r\n\t\t\t\tcontainer2.add( new UIText( ( index.count ).format() ).setFontSize( '12px' ) );\r\n\t\t\t\tcontainer2.add( new UIBreak() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar attributes = geometry.attributes;\r\n\r\n\t\t\tfor ( var name in attributes ) {\r\n\r\n\t\t\t\tvar attribute = attributes[ name ];\r\n\r\n\t\t\t\tcontainer2.add( new UIText( name ).setWidth( '80px' ) );\r\n\t\t\t\tcontainer2.add( new UIText( ( attribute.count ).format() + ' (' + attribute.itemSize + ')' ).setFontSize( '12px' ) );\r\n\t\t\t\tcontainer2.add( new UIBreak() );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcontainer.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tsignals.objectSelected.add( update );\r\n\tsignals.geometryChanged.add( update );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarGeometryBufferGeometry };\r\n","import { UIRow, UIButton } from './libs/ui.js';\r\n\r\nfunction SidebarGeometryModifiers( editor, object ) {\r\n\r\n\tvar signals = editor.signals;\r\n\r\n\tvar container = new UIRow().setPaddingLeft( '90px' );\r\n\r\n\tvar geometry = object.geometry;\r\n\r\n\t// Compute Vertex Normals\r\n\r\n\tvar button = new UIButton( 'Compute Vertex Normals' );\r\n\tbutton.onClick( function () {\r\n\r\n\t\tgeometry.computeVertexNormals();\r\n\r\n\t\tgeometry.attributes.normal.needsUpdate = true;\r\n\r\n\t\tsignals.geometryChanged.dispatch( object );\r\n\r\n\t} );\r\n\r\n\tcontainer.add( button );\r\n\r\n\t//\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarGeometryModifiers };\r\n","import { Command } from '../Command.js';\r\nimport { ObjectLoader } from 'three';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param newGeometry THREE.Geometry\r\n * @constructor\r\n */\r\n\r\nclass SetGeometryCommand extends Command {\r\n\r\n\tconstructor( editor, object, newGeometry ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetGeometryCommand';\r\n\t\tthis.name = 'Set Geometry';\r\n\t\tthis.updatable = true;\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.oldGeometry = ( object !== undefined ) ? object.geometry : undefined;\r\n\t\tthis.newGeometry = newGeometry;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.object.geometry.dispose();\r\n\t\tthis.object.geometry = this.newGeometry;\r\n\t\tthis.object.geometry.computeBoundingSphere();\r\n\r\n\t\tthis.editor.signals.geometryChanged.dispatch( this.object );\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.object.geometry.dispose();\r\n\t\tthis.object.geometry = this.oldGeometry;\r\n\t\tthis.object.geometry.computeBoundingSphere();\r\n\r\n\t\tthis.editor.signals.geometryChanged.dispatch( this.object );\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\tupdate( cmd ) {\r\n\r\n\t\tthis.newGeometry = cmd.newGeometry;\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.oldGeometry = this.object.geometry.toJSON();\r\n\t\toutput.newGeometry = this.newGeometry.toJSON();\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\r\n\t\tthis.oldGeometry = parseGeometry( json.oldGeometry );\r\n\t\tthis.newGeometry = parseGeometry( json.newGeometry );\r\n\r\n\t\tfunction parseGeometry( data ) {\r\n\r\n\t\t\tconst loader = new ObjectLoader();\r\n\t\t\treturn loader.parseGeometries( [ data ] )[ data.uuid ];\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetGeometryCommand };\r\n","var map = {\n\t\"./Sidebar.Geometry.BoxGeometry.js\": [\n\t\t89,\n\t\t3\n\t],\n\t\"./Sidebar.Geometry.BufferGeometry.js\": [\n\t\t56\n\t],\n\t\"./Sidebar.Geometry.CircleGeometry.js\": [\n\t\t90,\n\t\t4\n\t],\n\t\"./Sidebar.Geometry.CylinderGeometry.js\": [\n\t\t91,\n\t\t5\n\t],\n\t\"./Sidebar.Geometry.DodecahedronGeometry.js\": [\n\t\t92,\n\t\t6\n\t],\n\t\"./Sidebar.Geometry.ExtrudeGeometry.js\": [\n\t\t93,\n\t\t7\n\t],\n\t\"./Sidebar.Geometry.IcosahedronGeometry.js\": [\n\t\t94,\n\t\t8\n\t],\n\t\"./Sidebar.Geometry.LatheGeometry.js\": [\n\t\t95,\n\t\t9\n\t],\n\t\"./Sidebar.Geometry.Modifiers.js\": [\n\t\t57\n\t],\n\t\"./Sidebar.Geometry.OctahedronGeometry.js\": [\n\t\t96,\n\t\t10\n\t],\n\t\"./Sidebar.Geometry.PlaneGeometry.js\": [\n\t\t97,\n\t\t11\n\t],\n\t\"./Sidebar.Geometry.RingGeometry.js\": [\n\t\t98,\n\t\t12\n\t],\n\t\"./Sidebar.Geometry.ShapeGeometry.js\": [\n\t\t99,\n\t\t13\n\t],\n\t\"./Sidebar.Geometry.SphereGeometry.js\": [\n\t\t100,\n\t\t14\n\t],\n\t\"./Sidebar.Geometry.TetrahedronGeometry.js\": [\n\t\t101,\n\t\t15\n\t],\n\t\"./Sidebar.Geometry.TorusGeometry.js\": [\n\t\t102,\n\t\t16\n\t],\n\t\"./Sidebar.Geometry.TorusKnotGeometry.js\": [\n\t\t103,\n\t\t17\n\t],\n\t\"./Sidebar.Geometry.TubeGeometry.js\": [\n\t\t104,\n\t\t18\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 77;\nmodule.exports = webpackAsyncContext;","function Config() {\r\n\r\n\tvar name = 'threejs-editor';\r\n\r\n\tvar storage = {\r\n\t\t'language': 'en',\r\n\r\n\t\t'autosave': true,\r\n\r\n\t\t'project/title': '',\r\n\t\t'project/editable': false,\r\n\t\t'project/vr': false,\r\n\r\n\t\t'project/renderer/antialias': true,\r\n\t\t'project/renderer/shadows': true,\r\n\t\t'project/renderer/shadowType': 1, // PCF\r\n\t\t'project/renderer/physicallyCorrectLights': false,\r\n\t\t'project/renderer/toneMapping': 0, // NoToneMapping\r\n\t\t'project/renderer/toneMappingExposure': 1,\r\n\r\n\t\t'settings/history': false,\r\n\r\n\t\t'settings/shortcuts/translate': 'w',\r\n\t\t'settings/shortcuts/rotate': 'e',\r\n\t\t'settings/shortcuts/scale': 'r',\r\n\t\t'settings/shortcuts/undo': 'z',\r\n\t\t'settings/shortcuts/focus': 'f'\r\n\t};\r\n\r\n\tif ( window.localStorage[ name ] === undefined ) {\r\n\r\n\t\twindow.localStorage[ name ] = JSON.stringify( storage );\r\n\r\n\t} else {\r\n\r\n\t\tvar data = JSON.parse( window.localStorage[ name ] );\r\n\r\n\t\tfor ( var key in data ) {\r\n\r\n\t\t\tstorage[ key ] = data[ key ];\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn {\r\n\r\n\t\tgetKey: function ( key ) {\r\n\r\n\t\t\treturn storage[ key ];\r\n\r\n\t\t},\r\n\r\n\t\tsetKey: function () { // key, value, key, value ...\r\n\r\n\t\t\tfor ( var i = 0, l = arguments.length; i < l; i += 2 ) {\r\n\r\n\t\t\t\tstorage[ arguments[ i ] ] = arguments[ i + 1 ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\twindow.localStorage[ name ] = JSON.stringify( storage );\r\n\r\n\t\t\tconsole.log( '[' + /\\d\\d\\:\\d\\d\\:\\d\\d/.exec( new Date() )[ 0 ] + ']', 'Saved config to LocalStorage.' );\r\n\r\n\t\t},\r\n\r\n\t\tclear: function () {\r\n\r\n\t\t\tdelete window.localStorage[ name ];\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}\r\n\r\nexport { Config };\r\n","import { Command } from '../Command.js';\r\nimport { ObjectLoader } from 'three';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @constructor\r\n */\r\nclass AddObjectCommand extends Command {\r\n\r\n\tconstructor( editor, object ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'AddObjectCommand';\r\n\r\n\t\tthis.object = object;\r\n\t\tif ( object !== undefined ) {\r\n\r\n\t\t\tthis.name = `Add Object: ${object.name}`;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.editor.addObject( this.object );\r\n\t\tthis.editor.select( this.object );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.editor.removeObject( this.object );\r\n\t\tthis.editor.deselect();\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.object = this.object.toJSON();\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.object.object.uuid );\r\n\r\n\t\tif ( this.object === undefined ) {\r\n\r\n\t\t\tconst loader = new ObjectLoader();\r\n\t\t\tthis.object = loader.parse( json.object );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { AddObjectCommand };\r\n","import { Command } from '../Command.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param newUuid string\r\n * @constructor\r\n */\r\nclass SetUuidCommand extends Command {\r\n\r\n\tconstructor( editor, object, newUuid ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetUuidCommand';\r\n\t\tthis.name = 'Update UUID';\r\n\r\n\t\tthis.object = object;\r\n\r\n\t\tthis.oldUuid = ( object !== undefined ) ? object.uuid : undefined;\r\n\t\tthis.newUuid = newUuid;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.object.uuid = this.newUuid;\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.object.uuid = this.oldUuid;\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.oldUuid = this.oldUuid;\r\n\t\toutput.newUuid = this.newUuid;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.oldUuid = json.oldUuid;\r\n\t\tthis.newUuid = json.newUuid;\r\n\t\tthis.object = this.editor.objectByUuid( json.oldUuid );\r\n\r\n\t\tif ( this.object === undefined ) {\r\n\r\n\t\t\tthis.object = this.editor.objectByUuid( json.newUuid );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetUuidCommand };\r\n","import { Command } from '../Command.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param attributeName string\r\n * @param newValue number, string, boolean or object\r\n * @constructor\r\n */\r\nclass SetValueCommand extends Command {\r\n\r\n\tconstructor( editor, object, attributeName, newValue ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetValueCommand';\r\n\t\tthis.name = `Set ${attributeName}`;\r\n\t\tthis.updatable = true;\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.attributeName = attributeName;\r\n\t\tthis.oldValue = ( object !== undefined ) ? object[ attributeName ] : undefined;\r\n\t\tthis.newValue = newValue;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.object[ this.attributeName ] = this.newValue;\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\t\t// this.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.object[ this.attributeName ] = this.oldValue;\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\t\t// this.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\tupdate( cmd ) {\r\n\r\n\t\tthis.newValue = cmd.newValue;\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.attributeName = this.attributeName;\r\n\t\toutput.oldValue = this.oldValue;\r\n\t\toutput.newValue = this.newValue;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.attributeName = json.attributeName;\r\n\t\tthis.oldValue = json.oldValue;\r\n\t\tthis.newValue = json.newValue;\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetValueCommand };\r\n","import { Command } from '../Command.js';\r\nimport { SetUuidCommand } from './SetUuidCommand.js';\r\nimport { SetValueCommand } from './SetValueCommand.js';\r\nimport { AddObjectCommand } from './AddObjectCommand.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param scene containing children to import\r\n * @constructor\r\n */\r\nclass SetSceneCommand extends Command {\r\n\r\n\tconstructor( editor, scene ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetSceneCommand';\r\n\t\tthis.name = 'Set Scene';\r\n\r\n\t\tthis.cmdArray = [];\r\n\r\n\t\tif ( scene !== undefined ) {\r\n\r\n\t\t\tthis.cmdArray.push( new SetUuidCommand( this.editor, this.editor.scene, scene.uuid ) );\r\n\t\t\tthis.cmdArray.push( new SetValueCommand( this.editor, this.editor.scene, 'name', scene.name ) );\r\n\t\t\tthis.cmdArray.push( new SetValueCommand( this.editor, this.editor.scene, 'userData', JSON.parse( JSON.stringify( scene.userData ) ) ) );\r\n\r\n\t\t\twhile ( scene.children.length > 0 ) {\r\n\r\n\t\t\t\tconst child = scene.children.pop();\r\n\t\t\t\tthis.cmdArray.push( new AddObjectCommand( this.editor, child ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = false;\r\n\r\n\t\tfor ( let i = 0; i < this.cmdArray.length; i ++ ) {\r\n\r\n\t\t\tthis.cmdArray[ i ].execute();\r\n\r\n\t\t}\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = true;\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = false;\r\n\r\n\t\tfor ( let i = this.cmdArray.length - 1; i >= 0; i -- ) {\r\n\r\n\t\t\tthis.cmdArray[ i ].undo();\r\n\r\n\t\t}\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = true;\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\tconst cmds = [];\r\n\t\tfor ( let i = 0; i < this.cmdArray.length; i ++ ) {\r\n\r\n\t\t\tcmds.push( this.cmdArray[ i ].toJSON() );\r\n\r\n\t\t}\r\n\r\n\t\toutput.cmds = cmds;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tconst cmds = json.cmds;\r\n\t\tfor ( let i = 0; i < cmds.length; i ++ ) {\r\n\r\n\t\t\tconst cmd = new window[ cmds[ i ].type ]();\t// creates a new object of type \"json.type\"\r\n\t\t\tcmd.fromJSON( cmds[ i ] );\r\n\t\t\tthis.cmdArray.push( cmd );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetSceneCommand };\r\n","var LoaderUtils = {\r\n\r\n\tcreateFilesMap: function ( files ) {\r\n\r\n\t\tvar map = {};\r\n\r\n\t\tfor ( var i = 0; i < files.length; i ++ ) {\r\n\r\n\t\t\tvar file = files[ i ];\r\n\t\t\tmap[ file.name ] = file;\r\n\r\n\t\t}\r\n\r\n\t\treturn map;\r\n\r\n\t},\r\n\r\n\tgetFilesFromItemList: function ( items, onDone ) {\r\n\r\n\t\t// TOFIX: setURLModifier() breaks when the file being loaded is not in root\r\n\r\n\t\tvar itemsCount = 0;\r\n\t\tvar itemsTotal = 0;\r\n\r\n\t\tvar files = [];\r\n\t\tvar filesMap = {};\r\n\r\n\t\tfunction onEntryHandled() {\r\n\r\n\t\t\titemsCount ++;\r\n\r\n\t\t\tif ( itemsCount === itemsTotal ) {\r\n\r\n\t\t\t\tonDone( files, filesMap );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction handleEntry( entry ) {\r\n\r\n\t\t\tif ( entry.isDirectory ) {\r\n\r\n\t\t\t\tvar reader = entry.createReader();\r\n\t\t\t\treader.readEntries( function ( entries ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < entries.length; i ++ ) {\r\n\r\n\t\t\t\t\t\thandleEntry( entries[ i ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tonEntryHandled();\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t} else if ( entry.isFile ) {\r\n\r\n\t\t\t\tentry.file( function ( file ) {\r\n\r\n\t\t\t\t\tfiles.push( file );\r\n\r\n\t\t\t\t\tfilesMap[ entry.fullPath.substr( 1 ) ] = file;\r\n\t\t\t\t\tonEntryHandled();\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\titemsTotal ++;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < items.length; i ++ ) {\r\n\r\n\t\t\tvar item = items[ i ];\r\n\r\n\t\t\tif ( item.kind === 'file' ) {\r\n\r\n\t\t\t\thandleEntry( item.webkitGetAsEntry() );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { LoaderUtils };\r\n","import * as THREE from 'three'\r\n\r\nimport { TGALoader } from './libs/loaders/TGALoader.js';\r\n\r\nimport { AddObjectCommand } from './commands/AddObjectCommand.js';\r\nimport { SetSceneCommand } from './commands/SetSceneCommand.js';\r\n\r\nimport { LoaderUtils } from './LoaderUtils.js';\r\n\r\nfunction Loader(editor) {\r\n\r\n\tvar scope = this;\r\n\r\n\tthis.texturePath = '';\r\n\r\n\tthis.loadItemList = function (items) {\r\n\r\n\t\tLoaderUtils.getFilesFromItemList(items, function (files, filesMap) {\r\n\r\n\t\t\tscope.loadFiles(files, filesMap);\r\n\r\n\t\t});\r\n\r\n\t};\r\n\r\n\tthis.loadFiles = function (files, filesMap) {\r\n\r\n\t\tif (files.length > 0) {\r\n\r\n\t\t\tvar filesMap = filesMap || LoaderUtils.createFilesMap(files);\r\n\r\n\t\t\tvar manager = new THREE.LoadingManager();\r\n\t\t\tmanager.setURLModifier(function (url) {\r\n\r\n\t\t\t\turl = url.replace(/^(\\.?\\/)/, ''); // remove './'\r\n\r\n\t\t\t\tvar file = filesMap[url];\r\n\r\n\t\t\t\tif (file) {\r\n\r\n\t\t\t\t\tconsole.log('Loading', url);\r\n\r\n\t\t\t\t\treturn URL.createObjectURL(file);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn url;\r\n\r\n\t\t\t});\r\n\r\n\t\t\tmanager.addHandler(/\\.tga$/i, new TGALoader());\r\n\r\n\t\t\tfor (var i = 0; i < files.length; i++) {\r\n\r\n\t\t\t\tscope.loadFile(files[i], manager);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tthis.loadFile = function (file, manager) {\r\n\r\n\t\tvar filename = file.name;\r\n\t\tvar extension = filename.split('.').pop().toLowerCase();\r\n\r\n\t\tvar reader = new FileReader();\r\n\t\treader.addEventListener('progress', function (event) {\r\n\r\n\t\t\tvar size = '(' + Math.floor(event.total / 1000).format() + ' KB)';\r\n\t\t\tvar progress = Math.floor((event.loaded / event.total) * 100) + '%';\r\n\r\n\t\t\tconsole.log('Loading', filename, size, progress);\r\n\r\n\t\t});\r\n\r\n\t\tswitch (extension) {\r\n\t\t\tcase 'js':\r\n\t\t\tcase 'json':\r\n\r\n\t\t\t\treader.addEventListener('load', function (event) {\r\n\r\n\t\t\t\t\tvar contents = event.target.result;\r\n\r\n\t\t\t\t\t// 2.0\r\n\r\n\t\t\t\t\tif (contents.indexOf('postMessage') !== - 1) {\r\n\r\n\t\t\t\t\t\tvar blob = new Blob([contents], { type: 'text/javascript' });\r\n\t\t\t\t\t\tvar url = URL.createObjectURL(blob);\r\n\r\n\t\t\t\t\t\tvar worker = new Worker(url);\r\n\r\n\t\t\t\t\t\tworker.onmessage = function (event) {\r\n\r\n\t\t\t\t\t\t\tevent.data.metadata = { version: 2 };\r\n\t\t\t\t\t\t\thandleJSON(event.data);\r\n\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tworker.postMessage(Date.now());\r\n\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// >= 3.0\r\n\r\n\t\t\t\t\tvar data;\r\n\r\n\t\t\t\t\ttry {\r\n\r\n\t\t\t\t\t\tdata = JSON.parse(contents);\r\n\r\n\t\t\t\t\t} catch (error) {\r\n\r\n\t\t\t\t\t\talert(error);\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\thandleJSON(data);\r\n\r\n\t\t\t\t}, false);\r\n\t\t\t\treader.readAsText(file);\r\n\r\n\t\t\t\tbreak;\t\t\t\r\n\r\n\t\t\tdefault:\r\n\r\n\t\t\t\tconsole.error('Unsupported file format (' + extension + ').');\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tfunction handleJSON(data) {\r\n\r\n\t\tif (data.metadata === undefined) { // 2.0\r\n\r\n\t\t\tdata.metadata = { type: 'Geometry' };\r\n\r\n\t\t}\r\n\r\n\t\tif (data.metadata.type === undefined) { // 3.0\r\n\r\n\t\t\tdata.metadata.type = 'Geometry';\r\n\r\n\t\t}\r\n\r\n\t\tif (data.metadata.formatVersion !== undefined) {\r\n\r\n\t\t\tdata.metadata.version = data.metadata.formatVersion;\r\n\r\n\t\t}\r\n\r\n\t\tswitch (data.metadata.type.toLowerCase()) {\r\n\r\n\t\t\tcase 'buffergeometry':\r\n\r\n\t\t\t\tvar loader = new THREE.BufferGeometryLoader();\r\n\t\t\t\tvar result = loader.parse(data);\r\n\r\n\t\t\t\tvar mesh = new THREE.Mesh(result);\r\n\r\n\t\t\t\teditor.execute(new AddObjectCommand(editor, mesh));\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'geometry':\r\n\r\n\t\t\t\tconsole.error('Loader: \"Geometry\" is no longer supported.');\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'object':\r\n\r\n\t\t\t\tvar loader = new THREE.ObjectLoader();\r\n\t\t\t\tloader.setResourcePath(scope.texturePath);\r\n\r\n\t\t\t\tloader.parse(data, function (result) {\r\n\r\n\t\t\t\t\tif (result.isScene) {\r\n\r\n\t\t\t\t\t\teditor.execute(new SetSceneCommand(editor, result));\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\teditor.execute(new AddObjectCommand(editor, result));\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'app':\r\n\r\n\t\t\t\teditor.fromJSON(data);\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tdefault:\r\n\t\t\t\tconsole.error('Loader: '+data.metadata.type.toLowerCase()+' is not supported.');\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { Loader };\r\n","import { Command } from '../Command.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param script javascript object\r\n * @constructor\r\n */\r\nclass AddScriptCommand extends Command {\r\n\r\n\tconstructor( editor, object, script ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'AddScriptCommand';\r\n\t\tthis.name = 'Add Script';\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.script = script;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tif ( this.editor.scripts[ this.object.uuid ] === undefined ) {\r\n\r\n\t\t\tthis.editor.scripts[ this.object.uuid ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tthis.editor.scripts[ this.object.uuid ].push( this.script );\r\n\r\n\t\tthis.editor.signals.scriptAdded.dispatch( this.script );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tif ( this.editor.scripts[ this.object.uuid ] === undefined ) return;\r\n\r\n\t\tconst index = this.editor.scripts[ this.object.uuid ].indexOf( this.script );\r\n\r\n\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\tthis.editor.scripts[ this.object.uuid ].splice( index, 1 );\r\n\r\n\t\t}\r\n\r\n\t\tthis.editor.signals.scriptRemoved.dispatch( this.script );\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.script = this.script;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.script = json.script;\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { AddScriptCommand };\r\n","import { Command } from '../Command.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param cmdArray array containing command objects\r\n * @constructor\r\n */\r\nclass MultiCmdsCommand extends Command {\r\n\r\n\tconstructor( editor, cmdArray ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'MultiCmdsCommand';\r\n\t\tthis.name = 'Multiple Changes';\r\n\r\n\t\tthis.cmdArray = ( cmdArray !== undefined ) ? cmdArray : [];\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = false;\r\n\r\n\t\tfor ( let i = 0; i < this.cmdArray.length; i ++ ) {\r\n\r\n\t\t\tthis.cmdArray[ i ].execute();\r\n\r\n\t\t}\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = true;\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = false;\r\n\r\n\t\tfor ( let i = this.cmdArray.length - 1; i >= 0; i -- ) {\r\n\r\n\t\t\tthis.cmdArray[ i ].undo();\r\n\r\n\t\t}\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = true;\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\tconst cmds = [];\r\n\t\tfor ( let i = 0; i < this.cmdArray.length; i ++ ) {\r\n\r\n\t\t\tcmds.push( this.cmdArray[ i ].toJSON() );\r\n\r\n\t\t}\r\n\r\n\t\toutput.cmds = cmds;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tconst cmds = json.cmds;\r\n\t\tfor ( let i = 0; i < cmds.length; i ++ ) {\r\n\r\n\t\t\tconst cmd = new window[ cmds[ i ].type ]();\t// creates a new object of type \"json.type\"\r\n\t\t\tcmd.fromJSON( cmds[ i ] );\r\n\t\t\tthis.cmdArray.push( cmd );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { MultiCmdsCommand };\r\n","import { Command } from '../Command.js';\r\n\r\nimport { ObjectLoader } from 'three';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @constructor\r\n */\r\nclass RemoveObjectCommand extends Command {\r\n\r\n\tconstructor( editor, object ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'RemoveObjectCommand';\r\n\t\tthis.name = 'Remove Object';\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.parent = ( object !== undefined ) ? object.parent : undefined;\r\n\t\tif ( this.parent !== undefined ) {\r\n\r\n\t\t\tthis.index = this.parent.children.indexOf( this.object );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.editor.removeObject( this.object );\r\n\t\tthis.editor.deselect();\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.editor.addObject( this.object, this.parent, this.index );\r\n\t\tthis.editor.select( this.object );\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.object = this.object.toJSON();\r\n\t\toutput.index = this.index;\r\n\t\toutput.parentUuid = this.parent.uuid;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.parent = this.editor.objectByUuid( json.parentUuid );\r\n\t\tif ( this.parent === undefined ) {\r\n\r\n\t\t\tthis.parent = this.editor.scene;\r\n\r\n\t\t}\r\n\r\n\t\tthis.index = json.index;\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.object.object.uuid );\r\n\r\n\t\tif ( this.object === undefined ) {\r\n\r\n\t\t\tconst loader = new ObjectLoader();\r\n\t\t\tthis.object = loader.parse( json.object );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { RemoveObjectCommand };\r\n","import { Command } from '../Command.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param script javascript object\r\n * @constructor\r\n */\r\nclass RemoveScriptCommand extends Command {\r\n\r\n\tconstructor( editor, object, script ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'RemoveScriptCommand';\r\n\t\tthis.name = 'Remove Script';\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.script = script;\r\n\t\tif ( this.object && this.script ) {\r\n\r\n\t\t\tthis.index = this.editor.scripts[ this.object.uuid ].indexOf( this.script );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tif ( this.editor.scripts[ this.object.uuid ] === undefined ) return;\r\n\r\n\t\tif ( this.index !== - 1 ) {\r\n\r\n\t\t\tthis.editor.scripts[ this.object.uuid ].splice( this.index, 1 );\r\n\r\n\t\t}\r\n\r\n\t\tthis.editor.signals.scriptRemoved.dispatch( this.script );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tif ( this.editor.scripts[ this.object.uuid ] === undefined ) {\r\n\r\n\t\t\tthis.editor.scripts[ this.object.uuid ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tthis.editor.scripts[ this.object.uuid ].splice( this.index, 0, this.script );\r\n\r\n\t\tthis.editor.signals.scriptAdded.dispatch( this.script );\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.script = this.script;\r\n\t\toutput.index = this.index;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.script = json.script;\r\n\t\tthis.index = json.index;\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { RemoveScriptCommand };\r\n","import { Command } from '../Command.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param attributeName string\r\n * @param newValue integer representing a hex color value\r\n * @constructor\r\n */\r\nclass SetColorCommand extends Command {\r\n\r\n\tconstructor( editor, object, attributeName, newValue ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetColorCommand';\r\n\t\tthis.name = `Set ${attributeName}`;\r\n\t\tthis.updatable = true;\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.attributeName = attributeName;\r\n\t\tthis.oldValue = ( object !== undefined ) ? this.object[ this.attributeName ].getHex() : undefined;\r\n\t\tthis.newValue = newValue;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.object[ this.attributeName ].setHex( this.newValue );\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.object[ this.attributeName ].setHex( this.oldValue );\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\r\n\t}\r\n\r\n\tupdate( cmd ) {\r\n\r\n\t\tthis.newValue = cmd.newValue;\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.attributeName = this.attributeName;\r\n\t\toutput.oldValue = this.oldValue;\r\n\t\toutput.newValue = this.newValue;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\t\tthis.attributeName = json.attributeName;\r\n\t\tthis.oldValue = json.oldValue;\r\n\t\tthis.newValue = json.newValue;\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetColorCommand };\r\n","import { Command } from '../Command.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param attributeName string\r\n * @param newValue number, string, boolean or object\r\n * @constructor\r\n */\r\nclass SetGeometryValueCommand extends Command {\r\n\r\n\tconstructor( editor, object, attributeName, newValue ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetGeometryValueCommand';\r\n\t\tthis.name = `Set Geometry.${attributeName}`;\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.attributeName = attributeName;\r\n\t\tthis.oldValue = ( object !== undefined ) ? object.geometry[ attributeName ] : undefined;\r\n\t\tthis.newValue = newValue;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.object.geometry[ this.attributeName ] = this.newValue;\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\t\tthis.editor.signals.geometryChanged.dispatch();\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.object.geometry[ this.attributeName ] = this.oldValue;\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\t\tthis.editor.signals.geometryChanged.dispatch();\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.attributeName = this.attributeName;\r\n\t\toutput.oldValue = this.oldValue;\r\n\t\toutput.newValue = this.newValue;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\t\tthis.attributeName = json.attributeName;\r\n\t\tthis.oldValue = json.oldValue;\r\n\t\tthis.newValue = json.newValue;\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetGeometryValueCommand };\r\n","import { Command } from '../Command.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param attributeName string\r\n * @param newValue integer representing a hex color value\r\n * @constructor\r\n */\r\nclass SetMaterialColorCommand extends Command {\r\n\r\n\tconstructor( editor, object, attributeName, newValue, materialSlot ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetMaterialColorCommand';\r\n\t\tthis.name = `Set Material.${attributeName}`;\r\n\t\tthis.updatable = true;\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.material = ( this.object !== undefined ) ? this.editor.getObjectMaterial( object, materialSlot ) : undefined;\r\n\r\n\t\tthis.oldValue = ( this.material !== undefined ) ? this.material[ attributeName ].getHex() : undefined;\r\n\t\tthis.newValue = newValue;\r\n\r\n\t\tthis.attributeName = attributeName;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.material[ this.attributeName ].setHex( this.newValue );\r\n\r\n\t\tthis.editor.signals.materialChanged.dispatch( this.material );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.material[ this.attributeName ].setHex( this.oldValue );\r\n\r\n\t\tthis.editor.signals.materialChanged.dispatch( this.material );\r\n\r\n\t}\r\n\r\n\tupdate( cmd ) {\r\n\r\n\t\tthis.newValue = cmd.newValue;\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.attributeName = this.attributeName;\r\n\t\toutput.oldValue = this.oldValue;\r\n\t\toutput.newValue = this.newValue;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\t\tthis.attributeName = json.attributeName;\r\n\t\tthis.oldValue = json.oldValue;\r\n\t\tthis.newValue = json.newValue;\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetMaterialColorCommand };\r\n","import { Command } from '../Command.js';\r\nimport { ObjectLoader } from 'three';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param newMaterial THREE.Material\r\n * @constructor\r\n */\r\nclass SetMaterialCommand extends Command {\r\n\r\n\tconstructor( editor, object, newMaterial, materialSlot ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetMaterialCommand';\r\n\t\tthis.name = 'New Material';\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.materialSlot = materialSlot;\r\n\r\n\t\tthis.oldMaterial = this.editor.getObjectMaterial( object, materialSlot );\r\n\t\tthis.newMaterial = newMaterial;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.editor.setObjectMaterial( this.object, this.materialSlot, this.newMaterial );\r\n\t\tthis.editor.signals.materialChanged.dispatch( this.newMaterial );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.editor.setObjectMaterial( this.object, this.materialSlot, this.oldMaterial );\r\n\t\tthis.editor.signals.materialChanged.dispatch( this.oldMaterial );\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.oldMaterial = this.oldMaterial.toJSON();\r\n\t\toutput.newMaterial = this.newMaterial.toJSON();\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\t\tthis.oldMaterial = parseMaterial( json.oldMaterial );\r\n\t\tthis.newMaterial = parseMaterial( json.newMaterial );\r\n\r\n\t\tfunction parseMaterial( json ) {\r\n\r\n\t\t\tconst loader = new ObjectLoader();\r\n\t\t\tconst images = loader.parseImages( json.images );\r\n\t\t\tconst textures = loader.parseTextures( json.textures, images );\r\n\t\t\tconst materials = loader.parseMaterials( [ json ], textures );\r\n\t\t\treturn materials[ json.uuid ];\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetMaterialCommand };\r\n","import { Command } from '../Command.js';\r\nimport { ObjectLoader } from 'three';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param mapName string\r\n * @param newMap THREE.Texture\r\n * @constructor\r\n */\r\nclass SetMaterialMapCommand extends Command {\r\n\r\n\tconstructor( editor, object, mapName, newMap, materialSlot ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetMaterialMapCommand';\r\n\t\tthis.name = `Set Material.${mapName}`;\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.material = this.editor.getObjectMaterial( object, materialSlot );\r\n\r\n\t\tthis.oldMap = ( object !== undefined ) ? this.material[ mapName ] : undefined;\r\n\t\tthis.newMap = newMap;\r\n\r\n\t\tthis.mapName = mapName;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tif ( this.oldMap !== null && this.oldMap !== undefined ) this.oldMap.dispose();\r\n\r\n\t\tthis.material[ this.mapName ] = this.newMap;\r\n\t\tthis.material.needsUpdate = true;\r\n\r\n\t\tthis.editor.signals.materialChanged.dispatch( this.material );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.material[ this.mapName ] = this.oldMap;\r\n\t\tthis.material.needsUpdate = true;\r\n\r\n\t\tthis.editor.signals.materialChanged.dispatch( this.material );\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.mapName = this.mapName;\r\n\t\toutput.newMap = serializeMap( this.newMap );\r\n\t\toutput.oldMap = serializeMap( this.oldMap );\r\n\r\n\t\treturn output;\r\n\r\n\t\t// serializes a map (THREE.Texture)\r\n\r\n\t\tfunction serializeMap( map ) {\r\n\r\n\t\t\tif ( map === null || map === undefined ) return null;\r\n\r\n\t\t\tconst meta = {\r\n\t\t\t\tgeometries: {},\r\n\t\t\t\tmaterials: {},\r\n\t\t\t\ttextures: {},\r\n\t\t\t\timages: {}\r\n\t\t\t};\r\n\r\n\t\t\tconst json = map.toJSON( meta );\r\n\t\t\tconst images = extractFromCache( meta.images );\r\n\t\t\tif ( images.length > 0 ) json.images = images;\r\n\t\t\tjson.sourceFile = map.sourceFile;\r\n\r\n\t\t\treturn json;\r\n\r\n\t\t}\r\n\r\n\t\t// Note: The function 'extractFromCache' is copied from Object3D.toJSON()\r\n\r\n\t\t// extract data from the cache hash\r\n\t\t// remove metadata on each item\r\n\t\t// and return as array\r\n\t\tfunction extractFromCache( cache ) {\r\n\r\n\t\t\tconst values = [];\r\n\t\t\tfor ( const key in cache ) {\r\n\r\n\t\t\t\tconst data = cache[ key ];\r\n\t\t\t\tdelete data.metadata;\r\n\t\t\t\tvalues.push( data );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn values;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\t\tthis.mapName = json.mapName;\r\n\t\tthis.oldMap = parseTexture( json.oldMap );\r\n\t\tthis.newMap = parseTexture( json.newMap );\r\n\r\n\t\tfunction parseTexture( json ) {\r\n\r\n\t\t\tlet map = null;\r\n\t\t\tif ( json !== null ) {\r\n\r\n\t\t\t\tconst loader = new ObjectLoader();\r\n\t\t\t\tconst images = loader.parseImages( json.images );\r\n\t\t\t\tconst textures = loader.parseTextures( [ json ], images );\r\n\t\t\t\tmap = textures[ json.uuid ];\r\n\t\t\t\tmap.sourceFile = json.sourceFile;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn map;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetMaterialMapCommand };\r\n","import { Command } from '../Command.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param attributeName string\r\n * @param newValue number, string, boolean or object\r\n * @constructor\r\n */\r\nclass SetMaterialValueCommand extends Command {\r\n\r\n\tconstructor( editor, object, attributeName, newValue, materialSlot ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetMaterialValueCommand';\r\n\t\tthis.name = `Set Material.${attributeName}`;\r\n\t\tthis.updatable = true;\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.material = this.editor.getObjectMaterial( object, materialSlot );\r\n\r\n\t\tthis.oldValue = ( this.material !== undefined ) ? this.material[ attributeName ] : undefined;\r\n\t\tthis.newValue = newValue;\r\n\r\n\t\tthis.attributeName = attributeName;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.material[ this.attributeName ] = this.newValue;\r\n\t\tthis.material.needsUpdate = true;\r\n\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\t\tthis.editor.signals.materialChanged.dispatch( this.material );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.material[ this.attributeName ] = this.oldValue;\r\n\t\tthis.material.needsUpdate = true;\r\n\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\t\tthis.editor.signals.materialChanged.dispatch( this.material );\r\n\r\n\t}\r\n\r\n\tupdate( cmd ) {\r\n\r\n\t\tthis.newValue = cmd.newValue;\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.attributeName = this.attributeName;\r\n\t\toutput.oldValue = this.oldValue;\r\n\t\toutput.newValue = this.newValue;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.attributeName = json.attributeName;\r\n\t\tthis.oldValue = json.oldValue;\r\n\t\tthis.newValue = json.newValue;\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetMaterialValueCommand };\r\n","import { Command } from '../Command.js';\r\n\r\nclass SetMaterialVectorCommand extends Command {\r\n\r\n\tconstructor( editor, object, attributeName, newValue, materialSlot ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetMaterialColorCommand';\r\n\t\tthis.name = `Set Material.${attributeName}`;\r\n\t\tthis.updatable = true;\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.material = this.editor.getObjectMaterial( object, materialSlot );\r\n\r\n\t\tthis.oldValue = ( this.material !== undefined ) ? this.material[ attributeName ].toArray() : undefined;\r\n\t\tthis.newValue = newValue;\r\n\r\n\t\tthis.attributeName = attributeName;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.material[ this.attributeName ].fromArray( this.newValue );\r\n\r\n\t\tthis.editor.signals.materialChanged.dispatch( this.material );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.material[ this.attributeName ].fromArray( this.oldValue );\r\n\r\n\t\tthis.editor.signals.materialChanged.dispatch( this.material );\r\n\r\n\t}\r\n\r\n\tupdate( cmd ) {\r\n\r\n\t\tthis.newValue = cmd.newValue;\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.attributeName = this.attributeName;\r\n\t\toutput.oldValue = this.oldValue;\r\n\t\toutput.newValue = this.newValue;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\t\tthis.attributeName = json.attributeName;\r\n\t\tthis.oldValue = json.oldValue;\r\n\t\tthis.newValue = json.newValue;\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetMaterialVectorCommand };\r\n","import { Command } from '../Command.js';\r\nimport { Vector3 } from 'three';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param newPosition THREE.Vector3\r\n * @param optionalOldPosition THREE.Vector3\r\n * @constructor\r\n */\r\nclass SetPositionCommand extends Command {\r\n\r\n\tconstructor( editor, object, newPosition, optionalOldPosition ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetPositionCommand';\r\n\t\tthis.name = 'Set Position';\r\n\t\tthis.updatable = true;\r\n\r\n\t\tthis.object = object;\r\n\r\n\t\tif ( object !== undefined && newPosition !== undefined ) {\r\n\r\n\t\t\tthis.oldPosition = object.position.clone();\r\n\t\t\tthis.newPosition = newPosition.clone();\r\n\r\n\t\t}\r\n\r\n\t\tif ( optionalOldPosition !== undefined ) {\r\n\r\n\t\t\tthis.oldPosition = optionalOldPosition.clone();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.object.position.copy( this.newPosition );\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.object.position.copy( this.oldPosition );\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\r\n\t}\r\n\r\n\tupdate( command ) {\r\n\r\n\t\tthis.newPosition.copy( command.newPosition );\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.oldPosition = this.oldPosition.toArray();\r\n\t\toutput.newPosition = this.newPosition.toArray();\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\t\tthis.oldPosition = new Vector3().fromArray( json.oldPosition );\r\n\t\tthis.newPosition = new Vector3().fromArray( json.newPosition );\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetPositionCommand };\r\n","import { Command } from '../Command.js';\r\nimport { Euler } from 'three';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param newRotation THREE.Euler\r\n * @param optionalOldRotation THREE.Euler\r\n * @constructor\r\n */\r\nclass SetRotationCommand extends Command {\r\n\r\n\tconstructor( editor, object, newRotation, optionalOldRotation ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetRotationCommand';\r\n\t\tthis.name = 'Set Rotation';\r\n\t\tthis.updatable = true;\r\n\r\n\t\tthis.object = object;\r\n\r\n\t\tif ( object !== undefined && newRotation !== undefined ) {\r\n\r\n\t\t\tthis.oldRotation = object.rotation.clone();\r\n\t\t\tthis.newRotation = newRotation.clone();\r\n\r\n\t\t}\r\n\r\n\t\tif ( optionalOldRotation !== undefined ) {\r\n\r\n\t\t\tthis.oldRotation = optionalOldRotation.clone();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.object.rotation.copy( this.newRotation );\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.object.rotation.copy( this.oldRotation );\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\r\n\t}\r\n\r\n\tupdate( command ) {\r\n\r\n\t\tthis.newRotation.copy( command.newRotation );\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.oldRotation = this.oldRotation.toArray();\r\n\t\toutput.newRotation = this.newRotation.toArray();\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\t\tthis.oldRotation = new Euler().fromArray( json.oldRotation );\r\n\t\tthis.newRotation = new Euler().fromArray( json.newRotation );\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetRotationCommand };\r\n","import { Command } from '../Command.js';\r\nimport { Vector3 } from 'three';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param newScale THREE.Vector3\r\n * @param optionalOldScale THREE.Vector3\r\n * @constructor\r\n */\r\nclass SetScaleCommand extends Command {\r\n\r\n\tconstructor( editor, object, newScale, optionalOldScale ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetScaleCommand';\r\n\t\tthis.name = 'Set Scale';\r\n\t\tthis.updatable = true;\r\n\r\n\t\tthis.object = object;\r\n\r\n\t\tif ( object !== undefined && newScale !== undefined ) {\r\n\r\n\t\t\tthis.oldScale = object.scale.clone();\r\n\t\t\tthis.newScale = newScale.clone();\r\n\r\n\t\t}\r\n\r\n\t\tif ( optionalOldScale !== undefined ) {\r\n\r\n\t\t\tthis.oldScale = optionalOldScale.clone();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.object.scale.copy( this.newScale );\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.object.scale.copy( this.oldScale );\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\t\tthis.editor.signals.objectChanged.dispatch( this.object );\r\n\r\n\t}\r\n\r\n\tupdate( command ) {\r\n\r\n\t\tthis.newScale.copy( command.newScale );\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.oldScale = this.oldScale.toArray();\r\n\t\toutput.newScale = this.newScale.toArray();\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\t\tthis.oldScale = new Vector3().fromArray( json.oldScale );\r\n\t\tthis.newScale = new Vector3().fromArray( json.newScale );\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetScaleCommand };\r\n","import { Command } from '../Command.js';\r\n\r\n/**\r\n * @param editor Editor\r\n * @param object THREE.Object3D\r\n * @param script javascript object\r\n * @param attributeName string\r\n * @param newValue string, object\r\n * @constructor\r\n */\r\nclass SetScriptValueCommand extends Command {\r\n\r\n\tconstructor( editor, object, script, attributeName, newValue ) {\r\n\r\n\t\tsuper( editor );\r\n\r\n\t\tthis.type = 'SetScriptValueCommand';\r\n\t\tthis.name = `Set Script.${attributeName}`;\r\n\t\tthis.updatable = true;\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.script = script;\r\n\r\n\t\tthis.attributeName = attributeName;\r\n\t\tthis.oldValue = ( script !== undefined ) ? script[ this.attributeName ] : undefined;\r\n\t\tthis.newValue = newValue;\r\n\r\n\t}\r\n\r\n\texecute() {\r\n\r\n\t\tthis.script[ this.attributeName ] = this.newValue;\r\n\r\n\t\tthis.editor.signals.scriptChanged.dispatch();\r\n\r\n\t}\r\n\r\n\tundo() {\r\n\r\n\t\tthis.script[ this.attributeName ] = this.oldValue;\r\n\r\n\t\tthis.editor.signals.scriptChanged.dispatch();\r\n\r\n\t}\r\n\r\n\tupdate( cmd ) {\r\n\r\n\t\tthis.newValue = cmd.newValue;\r\n\r\n\t}\r\n\r\n\ttoJSON() {\r\n\r\n\t\tconst output = super.toJSON( this );\r\n\r\n\t\toutput.objectUuid = this.object.uuid;\r\n\t\toutput.index = this.editor.scripts[ this.object.uuid ].indexOf( this.script );\r\n\t\toutput.attributeName = this.attributeName;\r\n\t\toutput.oldValue = this.oldValue;\r\n\t\toutput.newValue = this.newValue;\r\n\r\n\t\treturn output;\r\n\r\n\t}\r\n\r\n\tfromJSON( json ) {\r\n\r\n\t\tsuper.fromJSON( json );\r\n\r\n\t\tthis.oldValue = json.oldValue;\r\n\t\tthis.newValue = json.newValue;\r\n\t\tthis.attributeName = json.attributeName;\r\n\t\tthis.object = this.editor.objectByUuid( json.objectUuid );\r\n\t\tthis.script = this.editor.scripts[ json.objectUuid ][ json.index ];\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { SetScriptValueCommand };\r\n","\r\nimport * as Commands from './commands/Commands.js';\r\n\r\nfunction History( editor ) {\r\n\r\n\tthis.editor = editor;\r\n\tthis.undos = [];\r\n\tthis.redos = [];\r\n\tthis.lastCmdTime = new Date();\r\n\tthis.idCounter = 0;\r\n\r\n\tthis.historyDisabled = false;\r\n\tthis.config = editor.config;\r\n\r\n\t// signals\r\n\r\n\tvar scope = this;\r\n\r\n\tthis.editor.signals.startPlayer.add( function () {\r\n\r\n\t\tscope.historyDisabled = true;\r\n\r\n\t} );\r\n\r\n\tthis.editor.signals.stopPlayer.add( function () {\r\n\r\n\t\tscope.historyDisabled = false;\r\n\r\n\t} );\r\n\r\n}\r\n\r\nHistory.prototype = {\r\n\r\n\texecute: function ( cmd, optionalName ) {\r\n\r\n\t\tvar lastCmd = this.undos[ this.undos.length - 1 ];\r\n\t\tvar timeDifference = new Date().getTime() - this.lastCmdTime.getTime();\r\n\r\n\t\tvar isUpdatableCmd = lastCmd &&\r\n\t\t\tlastCmd.updatable &&\r\n\t\t\tcmd.updatable &&\r\n\t\t\tlastCmd.object === cmd.object &&\r\n\t\t\tlastCmd.type === cmd.type &&\r\n\t\t\tlastCmd.script === cmd.script &&\r\n\t\t\tlastCmd.attributeName === cmd.attributeName;\r\n\r\n\t\tif ( isUpdatableCmd && cmd.type === 'SetScriptValueCommand' ) {\r\n\r\n\t\t\t// When the cmd.type is \"SetScriptValueCommand\" the timeDifference is ignored\r\n\r\n\t\t\tlastCmd.update( cmd );\r\n\t\t\tcmd = lastCmd;\r\n\r\n\t\t} else if ( isUpdatableCmd && timeDifference < 500 ) {\r\n\r\n\t\t\tlastCmd.update( cmd );\r\n\t\t\tcmd = lastCmd;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// the command is not updatable and is added as a new part of the history\r\n\r\n\t\t\tthis.undos.push( cmd );\r\n\t\t\tcmd.id = ++ this.idCounter;\r\n\r\n\t\t}\r\n\r\n\t\tcmd.name = ( optionalName !== undefined ) ? optionalName : cmd.name;\r\n\t\tcmd.execute();\r\n\t\tcmd.inMemory = true;\r\n\r\n\t\tif ( this.config.getKey( 'settings/history' ) ) {\r\n\r\n\t\t\tcmd.json = cmd.toJSON();\t// serialize the cmd immediately after execution and append the json to the cmd\r\n\r\n\t\t}\r\n\r\n\t\tthis.lastCmdTime = new Date();\r\n\r\n\t\t// clearing all the redo-commands\r\n\r\n\t\tthis.redos = [];\r\n\t\tthis.editor.signals.historyChanged.dispatch( cmd );\r\n\r\n\t},\r\n\r\n\tundo: function () {\r\n\r\n\t\tif ( this.historyDisabled ) {\r\n\r\n\t\t\talert( 'Undo/Redo disabled while scene is playing.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar cmd = undefined;\r\n\r\n\t\tif ( this.undos.length > 0 ) {\r\n\r\n\t\t\tcmd = this.undos.pop();\r\n\r\n\t\t\tif ( cmd.inMemory === false ) {\r\n\r\n\t\t\t\tcmd.fromJSON( cmd.json );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( cmd !== undefined ) {\r\n\r\n\t\t\tcmd.undo();\r\n\t\t\tthis.redos.push( cmd );\r\n\t\t\tthis.editor.signals.historyChanged.dispatch( cmd );\r\n\r\n\t\t}\r\n\r\n\t\treturn cmd;\r\n\r\n\t},\r\n\r\n\tredo: function () {\r\n\r\n\t\tif ( this.historyDisabled ) {\r\n\r\n\t\t\talert( 'Undo/Redo disabled while scene is playing.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar cmd = undefined;\r\n\r\n\t\tif ( this.redos.length > 0 ) {\r\n\r\n\t\t\tcmd = this.redos.pop();\r\n\r\n\t\t\tif ( cmd.inMemory === false ) {\r\n\r\n\t\t\t\tcmd.fromJSON( cmd.json );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( cmd !== undefined ) {\r\n\r\n\t\t\tcmd.execute();\r\n\t\t\tthis.undos.push( cmd );\r\n\t\t\tthis.editor.signals.historyChanged.dispatch( cmd );\r\n\r\n\t\t}\r\n\r\n\t\treturn cmd;\r\n\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\tvar history = {};\r\n\t\thistory.undos = [];\r\n\t\thistory.redos = [];\r\n\r\n\t\tif ( ! this.config.getKey( 'settings/history' ) ) {\r\n\r\n\t\t\treturn history;\r\n\r\n\t\t}\r\n\r\n\t\t// Append Undos to History\r\n\r\n\t\tfor ( var i = 0; i < this.undos.length; i ++ ) {\r\n\r\n\t\t\tif ( this.undos[ i ].hasOwnProperty( 'json' ) ) {\r\n\r\n\t\t\t\thistory.undos.push( this.undos[ i ].json );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// Append Redos to History\r\n\r\n\t\tfor ( var i = 0; i < this.redos.length; i ++ ) {\r\n\r\n\t\t\tif ( this.redos[ i ].hasOwnProperty( 'json' ) ) {\r\n\r\n\t\t\t\thistory.redos.push( this.redos[ i ].json );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn history;\r\n\r\n\t},\r\n\r\n\tfromJSON: function ( json ) {\r\n\r\n\t\tif ( json === undefined ) return;\r\n\r\n\t\tfor ( var i = 0; i < json.undos.length; i ++ ) {\r\n\r\n\t\t\tvar cmdJSON = json.undos[ i ];\r\n\t\t\tvar cmd = new Commands[ cmdJSON.type ]( this.editor ); // creates a new object of type \"json.type\"\r\n\t\t\tcmd.json = cmdJSON;\r\n\t\t\tcmd.id = cmdJSON.id;\r\n\t\t\tcmd.name = cmdJSON.name;\r\n\t\t\tthis.undos.push( cmd );\r\n\t\t\tthis.idCounter = ( cmdJSON.id > this.idCounter ) ? cmdJSON.id : this.idCounter; // set last used idCounter\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < json.redos.length; i ++ ) {\r\n\r\n\t\t\tvar cmdJSON = json.redos[ i ];\r\n\t\t\tvar cmd = new Commands[ cmdJSON.type ]( this.editor ); // creates a new object of type \"json.type\"\r\n\t\t\tcmd.json = cmdJSON;\r\n\t\t\tcmd.id = cmdJSON.id;\r\n\t\t\tcmd.name = cmdJSON.name;\r\n\t\t\tthis.redos.push( cmd );\r\n\t\t\tthis.idCounter = ( cmdJSON.id > this.idCounter ) ? cmdJSON.id : this.idCounter; // set last used idCounter\r\n\r\n\t\t}\r\n\r\n\t\t// Select the last executed undo-command\r\n\t\tthis.editor.signals.historyChanged.dispatch( this.undos[ this.undos.length - 1 ] );\r\n\r\n\t},\r\n\r\n\tclear: function () {\r\n\r\n\t\tthis.undos = [];\r\n\t\tthis.redos = [];\r\n\t\tthis.idCounter = 0;\r\n\r\n\t\tthis.editor.signals.historyChanged.dispatch();\r\n\r\n\t},\r\n\r\n\tgoToState: function ( id ) {\r\n\r\n\t\tif ( this.historyDisabled ) {\r\n\r\n\t\t\talert( 'Undo/Redo disabled while scene is playing.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = false;\r\n\t\tthis.editor.signals.historyChanged.active = false;\r\n\r\n\t\tvar cmd = this.undos.length > 0 ? this.undos[ this.undos.length - 1 ] : undefined;\t// next cmd to pop\r\n\r\n\t\tif ( cmd === undefined || id > cmd.id ) {\r\n\r\n\t\t\tcmd = this.redo();\r\n\t\t\twhile ( cmd !== undefined && id > cmd.id ) {\r\n\r\n\t\t\t\tcmd = this.redo();\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\twhile ( true ) {\r\n\r\n\t\t\t\tcmd = this.undos[ this.undos.length - 1 ];\t// next cmd to pop\r\n\r\n\t\t\t\tif ( cmd === undefined || id === cmd.id ) break;\r\n\r\n\t\t\t\tthis.undo();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = true;\r\n\t\tthis.editor.signals.historyChanged.active = true;\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.dispatch();\r\n\t\tthis.editor.signals.historyChanged.dispatch( cmd );\r\n\r\n\t},\r\n\r\n\tenableSerialization: function ( id ) {\r\n\r\n\t\t/**\r\n\t\t * because there might be commands in this.undos and this.redos\r\n\t\t * which have not been serialized with .toJSON() we go back\r\n\t\t * to the oldest command and redo one command after the other\r\n\t\t * while also calling .toJSON() on them.\r\n\t\t */\r\n\r\n\t\tthis.goToState( - 1 );\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = false;\r\n\t\tthis.editor.signals.historyChanged.active = false;\r\n\r\n\t\tvar cmd = this.redo();\r\n\t\twhile ( cmd !== undefined ) {\r\n\r\n\t\t\tif ( ! cmd.hasOwnProperty( 'json' ) ) {\r\n\r\n\t\t\t\tcmd.json = cmd.toJSON();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcmd = this.redo();\r\n\r\n\t\t}\r\n\r\n\t\tthis.editor.signals.sceneGraphChanged.active = true;\r\n\t\tthis.editor.signals.historyChanged.active = true;\r\n\r\n\t\tthis.goToState( id );\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { History };\r\n","function Strings( config ) {\r\n\r\n\tvar language = config.getKey( 'language' );\r\n\r\n\tvar values = {\r\n\r\n\t\ten: {\r\n\r\n\t\t\t'menubar/file': 'File',\r\n\t\t\t'menubar/file/new': 'New',\r\n\t\t\t'menubar/file/import': 'Import',\r\n\t\t\t'menubar/file/export/geometry': 'Export Geometry',\r\n\t\t\t'menubar/file/export/object': 'Export Object',\r\n\t\t\t'menubar/file/export/scene': 'Export Scene',\r\n\t\t\t'menubar/file/export/dae': 'Export DAE',\r\n\t\t\t'menubar/file/export/drc': 'Export DRC',\r\n\t\t\t'menubar/file/export/glb': 'Export GLB',\r\n\t\t\t'menubar/file/export/gltf': 'Export GLTF',\r\n\t\t\t'menubar/file/export/obj': 'Export OBJ',\r\n\t\t\t'menubar/file/export/ply': 'Export PLY',\r\n\t\t\t'menubar/file/export/ply_binary': 'Export PLY (Binary)',\r\n\t\t\t'menubar/file/export/stl': 'Export STL',\r\n\t\t\t'menubar/file/export/stl_binary': 'Export STL (Binary)',\r\n\t\t\t'menubar/file/export/usdz': 'Export USDZ',\r\n\t\t\t'menubar/file/publish': 'Publish',\r\n\r\n\t\t\t'menubar/edit': 'Edit',\r\n\t\t\t'menubar/edit/undo': 'Undo (Ctrl+Z)',\r\n\t\t\t'menubar/edit/redo': 'Redo (Ctrl+Shift+Z)',\r\n\t\t\t'menubar/edit/clear_history': 'Clear History',\r\n\t\t\t'menubar/edit/center': 'Center',\r\n\t\t\t'menubar/edit/clone': 'Clone',\r\n\t\t\t'menubar/edit/delete': 'Delete (Del)',\r\n\t\t\t'menubar/edit/fixcolormaps': 'Fix Color Maps',\r\n\r\n\t\t\t'menubar/add': 'Add',\r\n\t\t\t'menubar/add/group': 'Group',\r\n\t\t\t'menubar/add/plane': 'Plane',\r\n\t\t\t'menubar/add/box': 'Box',\r\n\t\t\t'menubar/add/circle': 'Circle',\r\n\t\t\t'menubar/add/cylinder': 'Cylinder',\r\n\t\t\t'menubar/add/ring': 'Ring',\r\n\t\t\t'menubar/add/sphere': 'Sphere',\r\n\t\t\t'menubar/add/dodecahedron': 'Dodecahedron',\r\n\t\t\t'menubar/add/icosahedron': 'Icosahedron',\r\n\t\t\t'menubar/add/octahedron': 'Octahedron',\r\n\t\t\t'menubar/add/tetrahedron': 'Tetrahedron',\r\n\t\t\t'menubar/add/torus': 'Torus',\r\n\t\t\t'menubar/add/tube': 'Tube',\r\n\t\t\t'menubar/add/torusknot': 'TorusKnot',\r\n\t\t\t'menubar/add/lathe': 'Lathe',\r\n\t\t\t'menubar/add/sprite': 'Sprite',\r\n\t\t\t'menubar/add/pointlight': 'PointLight',\r\n\t\t\t'menubar/add/spotlight': 'SpotLight',\r\n\t\t\t'menubar/add/directionallight': 'DirectionalLight',\r\n\t\t\t'menubar/add/hemispherelight': 'HemisphereLight',\r\n\t\t\t'menubar/add/ambientlight': 'AmbientLight',\r\n\t\t\t'menubar/add/perspectivecamera': 'PerspectiveCamera',\r\n\t\t\t'menubar/add/orthographiccamera': 'OrthographicCamera',\r\n\r\n\t\t\t'menubar/status/autosave': 'autosave',\r\n\r\n\t\t\t'menubar/play': 'Play',\r\n\t\t\t'menubar/play/stop': 'Stop',\r\n\t\t\t'menubar/play/play': 'Play',\r\n\r\n\t\t\t'menubar/examples': 'Examples',\r\n\t\t\t'menubar/examples/Arkanoid': 'Arkanoid',\r\n\t\t\t'menubar/examples/Camera': 'Camera',\r\n\t\t\t'menubar/examples/Particles': 'Particles',\r\n\t\t\t'menubar/examples/Pong': 'Pong',\r\n\t\t\t'menubar/examples/Shaders': 'Shaders',\r\n\r\n\t\t\t'menubar/view': 'View',\r\n\t\t\t'menubar/view/fullscreen': 'Fullscreen',\r\n\r\n\t\t\t'menubar/help': 'Help',\r\n\t\t\t'menubar/help/source_code': 'Source Code',\r\n\t\t\t'menubar/help/icons': 'Icon Pack',\r\n\t\t\t'menubar/help/about': 'About',\r\n\t\t\t'menubar/help/manual': 'Manual',\r\n\r\n\t\t\t'sidebar/animations': 'Animations',\r\n\t\t\t'sidebar/animations/play': 'Play',\r\n\t\t\t'sidebar/animations/stop': 'Stop',\r\n\t\t\t'sidebar/animations/timescale': 'Time Scale',\r\n\r\n\t\t\t'sidebar/scene': 'Scene',\r\n\t\t\t'sidebar/scene/background': 'Background',\r\n\t\t\t'sidebar/scene/environment': 'Environment',\r\n\t\t\t'sidebar/scene/fog': 'Fog',\r\n\r\n\t\t\t'sidebar/properties/object': 'Object',\r\n\t\t\t'sidebar/properties/geometry': 'Geometry',\r\n\t\t\t'sidebar/properties/material': 'Material',\r\n\t\t\t'sidebar/properties/script': 'Script',\r\n\r\n\t\t\t'sidebar/object/type': 'Type',\r\n\t\t\t'sidebar/object/new': 'New',\r\n\t\t\t'sidebar/object/uuid': 'UUID',\r\n\t\t\t'sidebar/object/name': 'Name',\r\n\t\t\t'sidebar/object/position': 'Position',\r\n\t\t\t'sidebar/object/rotation': 'Rotation',\r\n\t\t\t'sidebar/object/scale': 'Scale',\r\n\t\t\t'sidebar/object/fov': 'Fov',\r\n\t\t\t'sidebar/object/left': 'Left',\r\n\t\t\t'sidebar/object/right': 'Right',\r\n\t\t\t'sidebar/object/top': 'Top',\r\n\t\t\t'sidebar/object/bottom': 'Bottom',\r\n\t\t\t'sidebar/object/near': 'Near',\r\n\t\t\t'sidebar/object/far': 'Far',\r\n\t\t\t'sidebar/object/intensity': 'Intensity',\r\n\t\t\t'sidebar/object/color': 'Color',\r\n\t\t\t'sidebar/object/groundcolor': 'Ground Color',\r\n\t\t\t'sidebar/object/distance': 'Distance',\r\n\t\t\t'sidebar/object/angle': 'Angle',\r\n\t\t\t'sidebar/object/penumbra': 'Penumbra',\r\n\t\t\t'sidebar/object/decay': 'Decay',\r\n\t\t\t'sidebar/object/shadow': 'Shadow',\r\n\t\t\t'sidebar/object/shadowBias': 'Shadow Bias',\r\n\t\t\t'sidebar/object/shadowNormalBias': 'Shadow Normal Bias',\r\n\t\t\t'sidebar/object/shadowRadius': 'Shadow Radius',\r\n\t\t\t'sidebar/object/cast': 'cast',\r\n\t\t\t'sidebar/object/receive': 'receive',\r\n\t\t\t'sidebar/object/visible': 'Visible',\r\n\t\t\t'sidebar/object/frustumcull': 'Frustum Cull',\r\n\t\t\t'sidebar/object/renderorder': 'Render Order',\r\n\t\t\t'sidebar/object/userdata': 'User data',\r\n\r\n\t\t\t'sidebar/geometry/type': 'Type',\r\n\t\t\t'sidebar/geometry/new': 'New',\r\n\t\t\t'sidebar/geometry/uuid': 'UUID',\r\n\t\t\t'sidebar/geometry/name': 'Name',\r\n\t\t\t'sidebar/geometry/bounds': 'Bounds',\r\n\t\t\t'sidebar/geometry/show_vertex_normals': 'Show Vertex Normals',\r\n\r\n\t\t\t'sidebar/geometry/box_geometry/width': 'Width',\r\n\t\t\t'sidebar/geometry/box_geometry/height': 'Height',\r\n\t\t\t'sidebar/geometry/box_geometry/depth': 'Depth',\r\n\t\t\t'sidebar/geometry/box_geometry/widthseg': 'Width Seg',\r\n\t\t\t'sidebar/geometry/box_geometry/heightseg': 'Height Seg',\r\n\t\t\t'sidebar/geometry/box_geometry/depthseg': 'Depth Seg',\r\n\r\n\t\t\t'sidebar/geometry/buffer_geometry/attributes': 'Attributes',\r\n\t\t\t'sidebar/geometry/buffer_geometry/index': 'index',\r\n\r\n\t\t\t'sidebar/geometry/circle_geometry/radius': 'Radius',\r\n\t\t\t'sidebar/geometry/circle_geometry/segments': 'Segments',\r\n\t\t\t'sidebar/geometry/circle_geometry/thetastart': 'Theta start',\r\n\t\t\t'sidebar/geometry/circle_geometry/thetalength': 'Theta length',\r\n\r\n\t\t\t'sidebar/geometry/cylinder_geometry/radiustop': 'Radius top',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/radiusbottom': 'Radius bottom',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/height': 'Height',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/radialsegments': 'Radial segments',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/heightsegments': 'Height segments',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/openended': 'Open ended',\r\n\r\n\t\t\t'sidebar/geometry/extrude_geometry/curveSegments': 'Curve Segments',\r\n\t\t\t'sidebar/geometry/extrude_geometry/steps': 'Steps',\r\n\t\t\t'sidebar/geometry/extrude_geometry/depth': 'Depth',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelEnabled': 'Bevel?',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelThickness': 'Thickness',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelSize': 'Size',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelOffset': 'Offset',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelSegments': 'Segments',\r\n\t\t\t'sidebar/geometry/extrude_geometry/shape': 'Convert to Shape',\r\n\r\n\t\t\t'sidebar/geometry/dodecahedron_geometry/radius': 'Radius',\r\n\t\t\t'sidebar/geometry/dodecahedron_geometry/detail': 'Detail',\r\n\r\n\t\t\t'sidebar/geometry/icosahedron_geometry/radius': 'Radius',\r\n\t\t\t'sidebar/geometry/icosahedron_geometry/detail': 'Detail',\r\n\r\n\t\t\t'sidebar/geometry/octahedron_geometry/radius': 'Radius',\r\n\t\t\t'sidebar/geometry/octahedron_geometry/detail': 'Detail',\r\n\r\n\t\t\t'sidebar/geometry/tetrahedron_geometry/radius': 'Radius',\r\n\t\t\t'sidebar/geometry/tetrahedron_geometry/detail': 'Detail',\r\n\r\n\t\t\t'sidebar/geometry/lathe_geometry/segments': 'Segments',\r\n\t\t\t'sidebar/geometry/lathe_geometry/phistart': 'Phi start (°)',\r\n\t\t\t'sidebar/geometry/lathe_geometry/philength': 'Phi length (°)',\r\n\t\t\t'sidebar/geometry/lathe_geometry/points': 'Points',\r\n\r\n\t\t\t'sidebar/geometry/plane_geometry/width': 'Width',\r\n\t\t\t'sidebar/geometry/plane_geometry/height': 'Height',\r\n\t\t\t'sidebar/geometry/plane_geometry/widthsegments': 'Width segments',\r\n\t\t\t'sidebar/geometry/plane_geometry/heightsegments': 'Height segments',\r\n\r\n\t\t\t'sidebar/geometry/ring_geometry/innerRadius': 'Inner radius',\r\n\t\t\t'sidebar/geometry/ring_geometry/outerRadius': 'Outer radius',\r\n\t\t\t'sidebar/geometry/ring_geometry/thetaSegments': 'Theta segments',\r\n\t\t\t'sidebar/geometry/ring_geometry/phiSegments': 'Phi segments',\r\n\t\t\t'sidebar/geometry/ring_geometry/thetastart': 'Theta start',\r\n\t\t\t'sidebar/geometry/ring_geometry/thetalength': 'Theta length',\r\n\r\n\t\t\t'sidebar/geometry/shape_geometry/curveSegments': 'Curve Segments',\r\n\t\t\t'sidebar/geometry/shape_geometry/extrude': 'Extrude',\r\n\r\n\t\t\t'sidebar/geometry/sphere_geometry/radius': 'Radius',\r\n\t\t\t'sidebar/geometry/sphere_geometry/widthsegments': 'Width segments',\r\n\t\t\t'sidebar/geometry/sphere_geometry/heightsegments': 'Height segments',\r\n\t\t\t'sidebar/geometry/sphere_geometry/phistart': 'Phi start',\r\n\t\t\t'sidebar/geometry/sphere_geometry/philength': 'Phi length',\r\n\t\t\t'sidebar/geometry/sphere_geometry/thetastart': 'Theta start',\r\n\t\t\t'sidebar/geometry/sphere_geometry/thetalength': 'Theta length',\r\n\r\n\t\t\t'sidebar/geometry/torus_geometry/radius': 'Radius',\r\n\t\t\t'sidebar/geometry/torus_geometry/tube': 'Tube',\r\n\t\t\t'sidebar/geometry/torus_geometry/radialsegments': 'Radial segments',\r\n\t\t\t'sidebar/geometry/torus_geometry/tubularsegments': 'Tubular segments',\r\n\t\t\t'sidebar/geometry/torus_geometry/arc': 'Arc',\r\n\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/radius': 'Radius',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/tube': 'Tube',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/tubularsegments': 'Tubular segments',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/radialsegments': 'Radial segments',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/p': 'P',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/q': 'Q',\r\n\r\n\t\t\t'sidebar/geometry/tube_geometry/path': 'Path',\r\n\t\t\t'sidebar/geometry/tube_geometry/radius': 'Radius',\r\n\t\t\t'sidebar/geometry/tube_geometry/tube': 'Tube',\r\n\t\t\t'sidebar/geometry/tube_geometry/tubularsegments': 'Tubular segments',\r\n\t\t\t'sidebar/geometry/tube_geometry/radialsegments': 'Radial segments',\r\n\t\t\t'sidebar/geometry/tube_geometry/closed': 'Closed',\r\n\t\t\t'sidebar/geometry/tube_geometry/curvetype': 'Curve Type',\r\n\t\t\t'sidebar/geometry/tube_geometry/tension': 'Tension',\r\n\r\n\t\t\t'sidebar/material/new': 'New',\r\n\t\t\t'sidebar/material/copy': 'Copy',\r\n\t\t\t'sidebar/material/paste': 'Paste',\r\n\t\t\t'sidebar/material/slot': 'Slot',\r\n\t\t\t'sidebar/material/type': 'Type',\r\n\t\t\t'sidebar/material/uuid': 'UUID',\r\n\t\t\t'sidebar/material/name': 'Name',\r\n\t\t\t'sidebar/material/program': 'Program',\r\n\t\t\t'sidebar/material/info': 'Info',\r\n\t\t\t'sidebar/material/vertex': 'Vert',\r\n\t\t\t'sidebar/material/fragment': 'Frag',\r\n\t\t\t'sidebar/material/color': 'Color',\r\n\t\t\t'sidebar/material/depthPacking': 'Depth Packing',\r\n\t\t\t'sidebar/material/roughness': 'Roughness',\r\n\t\t\t'sidebar/material/metalness': 'Metalness',\r\n\t\t\t'sidebar/material/reflectivity': 'Reflectivity',\r\n\t\t\t'sidebar/material/emissive': 'Emissive',\r\n\t\t\t'sidebar/material/specular': 'Specular',\r\n\t\t\t'sidebar/material/shininess': 'Shininess',\r\n\t\t\t'sidebar/material/clearcoat': 'Clearcoat',\r\n\t\t\t'sidebar/material/clearcoatroughness': 'Clearcoat Roughness',\r\n\t\t\t'sidebar/material/transmission': 'Transmission',\r\n\t\t\t'sidebar/material/attenuationDistance': 'Attenuation Distance',\r\n\t\t\t'sidebar/material/attenuationTint': 'Attenuation Tint',\r\n\t\t\t'sidebar/material/thickness': 'Thickness',\r\n\t\t\t'sidebar/material/vertexcolors': 'Vertex Colors',\r\n\t\t\t'sidebar/material/matcap': 'Matcap',\r\n\t\t\t'sidebar/material/map': 'Map',\r\n\t\t\t'sidebar/material/alphamap': 'Alpha Map',\r\n\t\t\t'sidebar/material/bumpmap': 'Bump Map',\r\n\t\t\t'sidebar/material/normalmap': 'Normal Map',\r\n\t\t\t'sidebar/material/clearcoatnormalmap': 'Clearcoat Normal Map',\r\n\t\t\t'sidebar/material/displacementmap': 'Displace Map',\r\n\t\t\t'sidebar/material/roughnessmap': 'Rough. Map',\r\n\t\t\t'sidebar/material/metalnessmap': 'Metal. Map',\r\n\t\t\t'sidebar/material/specularmap': 'Specular Map',\r\n\t\t\t'sidebar/material/envmap': 'Env Map',\r\n\t\t\t'sidebar/material/lightmap': 'Light Map',\r\n\t\t\t'sidebar/material/aomap': 'AO Map',\r\n\t\t\t'sidebar/material/emissivemap': 'Emissive Map',\r\n\t\t\t'sidebar/material/gradientmap': 'Gradient Map',\r\n\t\t\t'sidebar/material/side': 'Side',\r\n\t\t\t'sidebar/material/size': 'Size',\r\n\t\t\t'sidebar/material/sizeAttenuation': 'Size Attenuation',\r\n\t\t\t'sidebar/material/flatShading': 'Flat Shading',\r\n\t\t\t'sidebar/material/blending': 'Blending',\r\n\t\t\t'sidebar/material/opacity': 'Opacity',\r\n\t\t\t'sidebar/material/transparent': 'Transparent',\r\n\t\t\t'sidebar/material/alphatest': 'Alpha Test',\r\n\t\t\t'sidebar/material/depthtest': 'Depth Test',\r\n\t\t\t'sidebar/material/depthwrite': 'Depth Write',\r\n\t\t\t'sidebar/material/wireframe': 'Wireframe',\r\n\r\n\t\t\t'sidebar/script': 'Script',\r\n\t\t\t'sidebar/script/new': 'New',\r\n\t\t\t'sidebar/script/edit': 'Edit',\r\n\t\t\t'sidebar/script/remove': 'Remove',\r\n\r\n\t\t\t'sidebar/project': 'Project',\r\n\t\t\t'sidebar/project/title': 'Title',\r\n\t\t\t'sidebar/project/editable': 'Editable',\r\n\t\t\t'sidebar/project/vr': 'VR',\r\n\t\t\t'sidebar/project/renderer': 'Renderer',\r\n\t\t\t'sidebar/project/antialias': 'Antialias',\r\n\t\t\t'sidebar/project/shadows': 'Shadows',\r\n\t\t\t'sidebar/project/physicallyCorrectLights': 'Physical lights',\r\n\t\t\t'sidebar/project/toneMapping': 'Tone mapping',\r\n\t\t\t'sidebar/project/materials': 'Materials',\r\n\t\t\t'sidebar/project/Assign': 'Assign',\r\n\r\n\t\t\t'sidebar/project/video': 'Video',\r\n\t\t\t'sidebar/project/resolution': 'Resolution',\r\n\t\t\t'sidebar/project/duration': 'Duration',\r\n\t\t\t'sidebar/project/render': 'Render',\r\n\r\n\t\t\t'sidebar/settings': 'Settings',\r\n\t\t\t'sidebar/settings/language': 'Language',\r\n\r\n\t\t\t'sidebar/settings/shortcuts': 'Shortcuts',\r\n\t\t\t'sidebar/settings/shortcuts/translate': 'Translate',\r\n\t\t\t'sidebar/settings/shortcuts/rotate': 'Rotate',\r\n\t\t\t'sidebar/settings/shortcuts/scale': 'Scale',\r\n\t\t\t'sidebar/settings/shortcuts/undo': 'Undo',\r\n\t\t\t'sidebar/settings/shortcuts/focus': 'Focus',\r\n\r\n\t\t\t'sidebar/settings/viewport': 'Viewport',\r\n\t\t\t'sidebar/settings/viewport/grid': 'Grid',\r\n\t\t\t'sidebar/settings/viewport/helpers': 'Helpers',\r\n\r\n\t\t\t'sidebar/history': 'History',\r\n\t\t\t'sidebar/history/persistent': 'persistent',\r\n\r\n\t\t\t'toolbar/translate': 'Translate',\r\n\t\t\t'toolbar/rotate': 'Rotate',\r\n\t\t\t'toolbar/scale': 'Scale',\r\n\t\t\t'toolbar/local': 'Local',\r\n\r\n\t\t\t'viewport/info/objects': 'Objects',\r\n\t\t\t'viewport/info/vertices': 'Vertices',\r\n\t\t\t'viewport/info/triangles': 'Triangles',\r\n\t\t\t'viewport/info/frametime': 'Frametime'\r\n\r\n\t\t},\r\n\r\n\t\tfr: {\r\n\r\n\t\t\t'menubar/file': 'Fichier',\r\n\t\t\t'menubar/file/new': 'Nouveau',\r\n\t\t\t'menubar/file/import': 'Importer',\r\n\t\t\t'menubar/file/export/geometry': 'Exporter Geometrie',\r\n\t\t\t'menubar/file/export/object': 'Exporter Objet',\r\n\t\t\t'menubar/file/export/scene': 'Exporter Scene',\r\n\t\t\t'menubar/file/export/dae': 'Exporter DAE',\r\n\t\t\t'menubar/file/export/drc': 'Exporter DRC',\r\n\t\t\t'menubar/file/export/glb': 'Exporter GLB',\r\n\t\t\t'menubar/file/export/gltf': 'Exporter GLTF',\r\n\t\t\t'menubar/file/export/obj': 'Exporter OBJ',\r\n\t\t\t'menubar/file/export/ply': 'Exporer PLY',\r\n\t\t\t'menubar/file/export/ply_binary': 'Exporter PLY (Binaire)',\r\n\t\t\t'menubar/file/export/stl': 'Exporter STL',\r\n\t\t\t'menubar/file/export/stl_binary': 'Exporter STL (Binaire)',\r\n\t\t\t'menubar/file/export/usdz': 'Exporter USDZ',\r\n\t\t\t'menubar/file/publish': 'Publier',\r\n\r\n\t\t\t'menubar/edit': 'Edition',\r\n\t\t\t'menubar/edit/undo': 'Annuler (Ctrl+Z)',\r\n\t\t\t'menubar/edit/redo': 'Refaire (Ctrl+Shift+Z)',\r\n\t\t\t'menubar/edit/clear_history': 'Supprimer Historique',\r\n\t\t\t'menubar/edit/center': 'Center',\r\n\t\t\t'menubar/edit/clone': 'Cloner',\r\n\t\t\t'menubar/edit/delete': 'Supprimer (Supp)',\r\n\t\t\t'menubar/edit/fixcolormaps': 'Correction des couleurs',\r\n\r\n\t\t\t'menubar/add': 'Ajouter',\r\n\t\t\t'menubar/add/group': 'Groupe',\r\n\t\t\t'menubar/add/plane': 'Plan',\r\n\t\t\t'menubar/add/box': 'Cube',\r\n\t\t\t'menubar/add/circle': 'Cercle',\r\n\t\t\t'menubar/add/cylinder': 'Cylindre',\r\n\t\t\t'menubar/add/ring': 'Bague',\r\n\t\t\t'menubar/add/sphere': 'Sphère',\r\n\t\t\t'menubar/add/dodecahedron': 'Dodécaèdre',\r\n\t\t\t'menubar/add/icosahedron': 'Icosaèdre',\r\n\t\t\t'menubar/add/octahedron': 'Octaèdre',\r\n\t\t\t'menubar/add/tetrahedron': 'Tétraèdre',\r\n\t\t\t'menubar/add/torus': 'Torus',\r\n\t\t\t'menubar/add/tube': 'Tube',\r\n\t\t\t'menubar/add/torusknot': 'Noeud Torus',\r\n\t\t\t'menubar/add/lathe': 'Tour',\r\n\t\t\t'menubar/add/sprite': 'Sprite',\r\n\t\t\t'menubar/add/pointlight': 'Lumière ponctuelle',\r\n\t\t\t'menubar/add/spotlight': 'Projecteur',\r\n\t\t\t'menubar/add/directionallight': 'Lumière directionnelle',\r\n\t\t\t'menubar/add/hemispherelight': 'Lumière hémisphérique',\r\n\t\t\t'menubar/add/ambientlight': 'Lumière ambiante',\r\n\t\t\t'menubar/add/perspectivecamera': 'Caméra perspective',\r\n\t\t\t'menubar/add/orthographiccamera': 'Caméra orthographique',\r\n\r\n\t\t\t'menubar/status/autosave': 'enregistrement automatique',\r\n\r\n\t\t\t'menubar/play': 'Jouer',\r\n\t\t\t'menubar/play/stop': 'Arrêter',\r\n\t\t\t'menubar/play/play': 'Jouer',\r\n\r\n\t\t\t'menubar/examples': 'Exemples',\r\n\t\t\t'menubar/examples/Arkanoid': 'Arkanoid',\r\n\t\t\t'menubar/examples/Camera': 'Camera',\r\n\t\t\t'menubar/examples/Particles': 'Particles',\r\n\t\t\t'menubar/examples/Pong': 'Pong',\r\n\t\t\t'menubar/examples/Shaders': 'Shaders',\r\n\r\n\t\t\t'menubar/view': 'View',\r\n\t\t\t'menubar/view/fullscreen': 'Fullscreen',\r\n\r\n\t\t\t'menubar/help': 'Aide',\r\n\t\t\t'menubar/help/source_code': 'Code Source',\r\n\t\t\t'menubar/help/icons': 'Icon Pack',\r\n\t\t\t'menubar/help/about': 'A propos',\r\n\t\t\t'menubar/help/manual': 'Manual',\r\n\r\n\t\t\t'sidebar/animations': 'Animations',\r\n\t\t\t'sidebar/animations/play': 'Play',\r\n\t\t\t'sidebar/animations/stop': 'Stop',\r\n\t\t\t'sidebar/animations/timescale': 'Time Scale',\r\n\r\n\t\t\t'sidebar/scene': 'Scène',\r\n\t\t\t'sidebar/scene/background': 'Arrière Plan',\r\n\t\t\t'sidebar/scene/environment': 'Environment',\r\n\t\t\t'sidebar/scene/fog': 'Brouillard',\r\n\r\n\t\t\t'sidebar/properties/object': 'Objet',\r\n\t\t\t'sidebar/properties/geometry': 'Géométrie',\r\n\t\t\t'sidebar/properties/material': 'Matériaux',\r\n\t\t\t'sidebar/properties/script': 'Script',\r\n\r\n\t\t\t'sidebar/object/type': 'Type',\r\n\t\t\t'sidebar/object/new': 'Nouveau',\r\n\t\t\t'sidebar/object/uuid': 'UUID',\r\n\t\t\t'sidebar/object/name': 'Nom',\r\n\t\t\t'sidebar/object/position': 'Position',\r\n\t\t\t'sidebar/object/rotation': 'Rotation',\r\n\t\t\t'sidebar/object/scale': 'Échelle',\r\n\t\t\t'sidebar/object/fov': 'Champ de vision',\r\n\t\t\t'sidebar/object/left': 'Gauche',\r\n\t\t\t'sidebar/object/right': 'Droite',\r\n\t\t\t'sidebar/object/top': 'Haut',\r\n\t\t\t'sidebar/object/bottom': 'Bas',\r\n\t\t\t'sidebar/object/near': 'Près',\r\n\t\t\t'sidebar/object/far': 'Loin',\r\n\t\t\t'sidebar/object/intensity': 'Intensité',\r\n\t\t\t'sidebar/object/color': 'Couleur',\r\n\t\t\t'sidebar/object/groundcolor': 'Couleur de fond',\r\n\t\t\t'sidebar/object/distance': 'Distance',\r\n\t\t\t'sidebar/object/angle': 'Angle',\r\n\t\t\t'sidebar/object/penumbra': 'Pénombre',\r\n\t\t\t'sidebar/object/decay': 'Affaiblissement',\r\n\t\t\t'sidebar/object/shadow': 'Ombre',\r\n\t\t\t'sidebar/object/shadowBias': 'Biais directionnel des ombres',\r\n\t\t\t'sidebar/object/shadowNormalBias': 'Shadow Normal Bias',\r\n\t\t\t'sidebar/object/shadowRadius': 'Rayon de l\\'ombre',\r\n\t\t\t'sidebar/object/cast': 'Projète',\r\n\t\t\t'sidebar/object/receive': 'Reçoit',\r\n\t\t\t'sidebar/object/visible': 'Visible',\r\n\t\t\t'sidebar/object/frustumcull': 'Culling',\r\n\t\t\t'sidebar/object/renderorder': 'Ordre de rendus',\r\n\t\t\t'sidebar/object/userdata': 'Données utilisateur',\r\n\r\n\t\t\t'sidebar/geometry/type': 'Type',\r\n\t\t\t'sidebar/geometry/new': 'Nouveau',\r\n\t\t\t'sidebar/geometry/uuid': 'UUID',\r\n\t\t\t'sidebar/geometry/name': 'Nom',\r\n\t\t\t'sidebar/geometry/bounds': 'Limites',\r\n\t\t\t'sidebar/geometry/show_vertex_normals': 'Afficher normales',\r\n\r\n\t\t\t'sidebar/geometry/box_geometry/width': 'Largeur',\r\n\t\t\t'sidebar/geometry/box_geometry/height': 'Hauteur',\r\n\t\t\t'sidebar/geometry/box_geometry/depth': 'Profondeur',\r\n\t\t\t'sidebar/geometry/box_geometry/widthseg': 'Segments en Largeur',\r\n\t\t\t'sidebar/geometry/box_geometry/heightseg': 'Segments en Hauteur',\r\n\t\t\t'sidebar/geometry/box_geometry/depthseg': 'Segments en Profondeur',\r\n\r\n\t\t\t'sidebar/geometry/buffer_geometry/attributes': 'Attributs',\r\n\t\t\t'sidebar/geometry/buffer_geometry/index': 'index',\r\n\r\n\t\t\t'sidebar/geometry/circle_geometry/radius': 'Rayon',\r\n\t\t\t'sidebar/geometry/circle_geometry/segments': 'Segments',\r\n\t\t\t'sidebar/geometry/circle_geometry/thetastart': 'Début Thêta (°)',\r\n\t\t\t'sidebar/geometry/circle_geometry/thetalength': 'Longueur Thêta (°)',\r\n\r\n\t\t\t'sidebar/geometry/cylinder_geometry/radiustop': 'Rayon supérieur',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/radiusbottom': 'Rayon inférieur',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/height': 'Hauteur',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/radialsegments': 'Segments radiaux',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/heightsegments': 'Segments en hauteur',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/openended': 'Extrémités ouvertes',\r\n\r\n\t\t\t'sidebar/geometry/extrude_geometry/curveSegments': 'Segments de courbe',\r\n\t\t\t'sidebar/geometry/extrude_geometry/steps': 'Pas',\r\n\t\t\t'sidebar/geometry/extrude_geometry/depth': 'Profondeur',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelEnabled': 'Biseau',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelThickness': 'Épaisseur',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelSize': 'Taille',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelOffset': 'Décalage',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelSegments': 'Segments',\r\n\t\t\t'sidebar/geometry/extrude_geometry/shape': 'Convertir en forme',\r\n\r\n\t\t\t'sidebar/geometry/dodecahedron_geometry/radius': 'Rayon',\r\n\t\t\t'sidebar/geometry/dodecahedron_geometry/detail': 'Détail',\r\n\r\n\t\t\t'sidebar/geometry/icosahedron_geometry/radius': 'Rayon',\r\n\t\t\t'sidebar/geometry/icosahedron_geometry/detail': 'Détail',\r\n\r\n\t\t\t'sidebar/geometry/octahedron_geometry/radius': 'Rayon',\r\n\t\t\t'sidebar/geometry/octahedron_geometry/detail': 'Détail',\r\n\r\n\t\t\t'sidebar/geometry/tetrahedron_geometry/radius': 'Rayon',\r\n\t\t\t'sidebar/geometry/tetrahedron_geometry/detail': 'Détail',\r\n\r\n\t\t\t'sidebar/geometry/lathe_geometry/segments': 'Segments',\r\n\t\t\t'sidebar/geometry/lathe_geometry/phistart': 'Début Phi (°)',\r\n\t\t\t'sidebar/geometry/lathe_geometry/philength': 'Longueur Phi (°)',\r\n\t\t\t'sidebar/geometry/lathe_geometry/points': 'Points',\r\n\r\n\t\t\t'sidebar/geometry/plane_geometry/width': 'Largeur',\r\n\t\t\t'sidebar/geometry/plane_geometry/height': 'Hauteur',\r\n\t\t\t'sidebar/geometry/plane_geometry/widthsegments': 'Segments en Largeur',\r\n\t\t\t'sidebar/geometry/plane_geometry/heightsegments': 'Segments en Hauteur',\r\n\r\n\t\t\t'sidebar/geometry/ring_geometry/innerRadius': 'Rayon intérieur',\r\n\t\t\t'sidebar/geometry/ring_geometry/outerRadius': 'Rayon extérieur',\r\n\t\t\t'sidebar/geometry/ring_geometry/thetaSegments': 'Segments Thêta',\r\n\t\t\t'sidebar/geometry/ring_geometry/phiSegments': 'Phi segments',\r\n\t\t\t'sidebar/geometry/ring_geometry/thetastart': 'Début Thêta',\r\n\t\t\t'sidebar/geometry/ring_geometry/thetalength': 'Longueur Thêta',\r\n\r\n\t\t\t'sidebar/geometry/shape_geometry/curveSegments': 'Segments de courbe',\r\n\t\t\t'sidebar/geometry/shape_geometry/extrude': 'Extruder',\r\n\r\n\t\t\t'sidebar/geometry/sphere_geometry/radius': 'Rayon',\r\n\t\t\t'sidebar/geometry/sphere_geometry/widthsegments': 'Segments en Largeur',\r\n\t\t\t'sidebar/geometry/sphere_geometry/heightsegments': 'Segments en Hauteur',\r\n\t\t\t'sidebar/geometry/sphere_geometry/phistart': 'Début Phi (°)',\r\n\t\t\t'sidebar/geometry/sphere_geometry/philength': 'Longueur Phi (°)',\r\n\t\t\t'sidebar/geometry/sphere_geometry/thetastart': 'Début Thêta',\r\n\t\t\t'sidebar/geometry/sphere_geometry/thetalength': 'Longueur Thêta',\r\n\r\n\t\t\t'sidebar/geometry/torus_geometry/radius': 'Rayon',\r\n\t\t\t'sidebar/geometry/torus_geometry/tube': 'Tube',\r\n\t\t\t'sidebar/geometry/torus_geometry/radialsegments': 'Segments radiaux',\r\n\t\t\t'sidebar/geometry/torus_geometry/tubularsegments': 'Segments tubulaires',\r\n\t\t\t'sidebar/geometry/torus_geometry/arc': 'Arc',\r\n\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/radius': 'Rayon',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/tube': 'Tube',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/tubularsegments': 'Segments tubulaires',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/radialsegments': 'Segments radiaux',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/p': 'P',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/q': 'Q',\r\n\r\n\t\t\t'sidebar/geometry/tube_geometry/path': 'Chemin',\r\n\t\t\t'sidebar/geometry/tube_geometry/radius': 'Rayon',\r\n\t\t\t'sidebar/geometry/tube_geometry/tube': 'Tube',\r\n\t\t\t'sidebar/geometry/tube_geometry/tubularsegments': 'Segments tubulaires',\r\n\t\t\t'sidebar/geometry/tube_geometry/radialsegments': 'Segments radiaux',\r\n\t\t\t'sidebar/geometry/tube_geometry/closed': 'Fermé',\r\n\t\t\t'sidebar/geometry/tube_geometry/curvetype': 'Type de courbe',\r\n\t\t\t'sidebar/geometry/tube_geometry/tension': 'Tension',\r\n\r\n\t\t\t'sidebar/material/new': 'Nouveau',\r\n\t\t\t'sidebar/material/copy': 'Copier',\r\n\t\t\t'sidebar/material/paste': 'Coller',\r\n\t\t\t'sidebar/material/slot': 'Slot',\r\n\t\t\t'sidebar/material/type': 'Type',\r\n\t\t\t'sidebar/material/uuid': 'UUID',\r\n\t\t\t'sidebar/material/name': 'Nom',\r\n\t\t\t'sidebar/material/program': 'Programme',\r\n\t\t\t'sidebar/material/info': 'Info',\r\n\t\t\t'sidebar/material/vertex': 'Sommet',\r\n\t\t\t'sidebar/material/fragment': 'Fragment',\r\n\t\t\t'sidebar/material/color': 'Couleur',\r\n\t\t\t'sidebar/material/depthPacking': 'Encodage profondeur de couleur',\r\n\t\t\t'sidebar/material/roughness': 'Rugosité',\r\n\t\t\t'sidebar/material/metalness': 'Métal',\r\n\t\t\t'sidebar/material/reflectivity': 'Reflectivity',\r\n\t\t\t'sidebar/material/emissive': 'Émissif',\r\n\t\t\t'sidebar/material/specular': 'Spéculaire',\r\n\t\t\t'sidebar/material/shininess': 'Brillance',\r\n\t\t\t'sidebar/material/clearcoat': 'Vernis',\r\n\t\t\t'sidebar/material/clearcoatroughness': 'Rugosité du vernis',\r\n\t\t\t'sidebar/material/transmission': 'Transmission',\r\n\t\t\t'sidebar/material/attenuationDistance': 'Attenuation Distance',\r\n\t\t\t'sidebar/material/attenuationTint': 'Attenuation Tint',\r\n\t\t\t'sidebar/material/thickness': 'Thickness',\r\n\t\t\t'sidebar/material/vertexcolors': 'Couleurs aux Sommets',\r\n\t\t\t'sidebar/material/matcap': 'Matcap',\r\n\t\t\t'sidebar/material/map': 'Texture',\r\n\t\t\t'sidebar/material/alphamap': 'Texture de transparence',\r\n\t\t\t'sidebar/material/bumpmap': 'Texture de relief',\r\n\t\t\t'sidebar/material/normalmap': 'Texture de normales',\r\n\t\t\t'sidebar/material/clearcoatnormalmap': 'Texture des normales du vernis',\r\n\t\t\t'sidebar/material/displacementmap': 'Texture de déplacement',\r\n\t\t\t'sidebar/material/roughnessmap': 'Texture de rugosité',\r\n\t\t\t'sidebar/material/metalnessmap': 'Texture métallique',\r\n\t\t\t'sidebar/material/specularmap': 'Texture spéculaire',\r\n\t\t\t'sidebar/material/envmap': 'Texture d\\'environnement',\r\n\t\t\t'sidebar/material/lightmap': 'Texture d\\'éclairage',\r\n\t\t\t'sidebar/material/aomap': 'Texture d\\'occlusion ambiante',\r\n\t\t\t'sidebar/material/emissivemap': 'Texture d\\'émission',\r\n\t\t\t'sidebar/material/gradientmap': 'Texture de gradient',\r\n\t\t\t'sidebar/material/side': 'Côté',\r\n\t\t\t'sidebar/material/size': 'Size',\r\n\t\t\t'sidebar/material/sizeAttenuation': 'Size Attenuation',\r\n\t\t\t'sidebar/material/flatShading': 'Flat Shading',\r\n\t\t\t'sidebar/material/blending': 'Mélange',\r\n\t\t\t'sidebar/material/opacity': 'Opacité',\r\n\t\t\t'sidebar/material/transparent': 'Transparence',\r\n\t\t\t'sidebar/material/alphatest': 'Test de transparence',\r\n\t\t\t'sidebar/material/depthtest': 'Depth Test',\r\n\t\t\t'sidebar/material/depthwrite': 'Depth Write',\r\n\t\t\t'sidebar/material/wireframe': 'Fil de fer',\r\n\r\n\t\t\t'sidebar/script': 'Script',\r\n\t\t\t'sidebar/script/new': 'Nouveau',\r\n\t\t\t'sidebar/script/edit': 'Editer',\r\n\t\t\t'sidebar/script/remove': 'Supprimer',\r\n\r\n\t\t\t'sidebar/project': 'Projet',\r\n\t\t\t'sidebar/project/title': 'Titre',\r\n\t\t\t'sidebar/project/editable': 'Modifiable',\r\n\t\t\t'sidebar/project/vr': 'VR',\r\n\t\t\t'sidebar/project/renderer': 'Rendus',\r\n\t\t\t'sidebar/project/antialias': 'Anticrénelage',\r\n\t\t\t'sidebar/project/shadows': 'Ombres',\r\n\t\t\t'sidebar/project/physicallyCorrectLights': 'Physical lights',\r\n\t\t\t'sidebar/project/toneMapping': 'Mappage des nuances',\r\n\t\t\t'sidebar/project/materials': 'Matériaux',\r\n\t\t\t'sidebar/project/Assign': 'Attribuer',\r\n\r\n\t\t\t'sidebar/project/video': 'Video',\r\n\t\t\t'sidebar/project/resolution': 'Resolution',\r\n\t\t\t'sidebar/project/duration': 'Duration',\r\n\t\t\t'sidebar/project/render': 'Render',\r\n\r\n\t\t\t'sidebar/settings': 'Paramètres',\r\n\t\t\t'sidebar/settings/language': 'Langue',\r\n\r\n\t\t\t'sidebar/settings/shortcuts': 'Shortcuts',\r\n\t\t\t'sidebar/settings/shortcuts/translate': 'Position',\r\n\t\t\t'sidebar/settings/shortcuts/rotate': 'Rotation',\r\n\t\t\t'sidebar/settings/shortcuts/scale': 'Échelle',\r\n\t\t\t'sidebar/settings/shortcuts/undo': 'Annuler',\r\n\t\t\t'sidebar/settings/shortcuts/focus': 'Focus',\r\n\r\n\t\t\t'sidebar/settings/viewport': 'Viewport',\r\n\t\t\t'sidebar/settings/viewport/grid': 'Grille',\r\n\t\t\t'sidebar/settings/viewport/helpers': 'Helpers',\r\n\r\n\t\t\t'sidebar/history': 'Historique',\r\n\t\t\t'sidebar/history/persistent': 'permanent',\r\n\r\n\t\t\t'toolbar/translate': 'Position',\r\n\t\t\t'toolbar/rotate': 'Rotation',\r\n\t\t\t'toolbar/scale': 'Échelle',\r\n\t\t\t'toolbar/local': 'Local',\r\n\r\n\t\t\t'viewport/info/objects': 'Objets',\r\n\t\t\t'viewport/info/vertices': 'Sommets',\r\n\t\t\t'viewport/info/triangles': 'Triangles',\r\n\t\t\t'viewport/info/frametime': 'Temps de trame'\r\n\r\n\t\t},\r\n\r\n\t\tzh: {\r\n\r\n\t\t\t'menubar/file': '文件',\r\n\t\t\t'menubar/file/new': '新建',\r\n\t\t\t'menubar/file/import': '导入',\r\n\t\t\t'menubar/file/export/geometry': '导出几何体',\r\n\t\t\t'menubar/file/export/object': '导出物体',\r\n\t\t\t'menubar/file/export/scene': '导出场景',\r\n\t\t\t'menubar/file/export/dae': '导出DAE',\r\n\t\t\t'menubar/file/export/drc': '导出DRC',\r\n\t\t\t'menubar/file/export/glb': '导出GLB',\r\n\t\t\t'menubar/file/export/gltf': '导出GLTF',\r\n\t\t\t'menubar/file/export/obj': '导出OBJ',\r\n\t\t\t'menubar/file/export/ply': '导出PLY',\r\n\t\t\t'menubar/file/export/ply_binary': '导出PLY(二进制)',\r\n\t\t\t'menubar/file/export/stl': '导出STL',\r\n\t\t\t'menubar/file/export/stl_binary': '导出STL(二进制)',\r\n\t\t\t'menubar/file/export/usdz': '导出USDZ',\r\n\t\t\t'menubar/file/publish': '发布',\r\n\r\n\t\t\t'menubar/edit': '编辑',\r\n\t\t\t'menubar/edit/undo': '撤销 (Ctrl+Z)',\r\n\t\t\t'menubar/edit/redo': '重做 (Ctrl+Shift+Z)',\r\n\t\t\t'menubar/edit/clear_history': '清空历史记录',\r\n\t\t\t'menubar/edit/center': '居中',\r\n\t\t\t'menubar/edit/clone': '拷贝',\r\n\t\t\t'menubar/edit/delete': '删除 (Del)',\r\n\t\t\t'menubar/edit/fixcolormaps': '修复颜色贴图',\r\n\r\n\t\t\t'menubar/add': '添加',\r\n\t\t\t'menubar/add/group': '组',\r\n\t\t\t'menubar/add/plane': '平面',\r\n\t\t\t'menubar/add/box': '正方体',\r\n\t\t\t'menubar/add/circle': '圆',\r\n\t\t\t'menubar/add/cylinder': '圆柱体',\r\n\t\t\t'menubar/add/ring': '环',\r\n\t\t\t'menubar/add/sphere': '球体',\r\n\t\t\t'menubar/add/dodecahedron': '十二面体',\r\n\t\t\t'menubar/add/icosahedron': '二十面体',\r\n\t\t\t'menubar/add/octahedron': '八面体',\r\n\t\t\t'menubar/add/tetrahedron': '四面体',\r\n\t\t\t'menubar/add/torus': '圆环体',\r\n\t\t\t'menubar/add/torusknot': '环面纽结体',\r\n\t\t\t'menubar/add/tube': '管',\r\n\t\t\t'menubar/add/lathe': '酒杯',\r\n\t\t\t'menubar/add/sprite': '精灵',\r\n\t\t\t'menubar/add/pointlight': '点光源',\r\n\t\t\t'menubar/add/spotlight': '聚光灯',\r\n\t\t\t'menubar/add/directionallight': '平行光',\r\n\t\t\t'menubar/add/hemispherelight': '半球光',\r\n\t\t\t'menubar/add/ambientlight': '环境光',\r\n\t\t\t'menubar/add/perspectivecamera': '透视相机',\r\n\t\t\t'menubar/add/orthographiccamera': '正交相机',\r\n\r\n\t\t\t'menubar/status/autosave': '自动保存',\r\n\r\n\t\t\t'menubar/play': '启动',\r\n\t\t\t'menubar/play/stop': '暂停',\r\n\t\t\t'menubar/play/play': '启动',\r\n\r\n\t\t\t'menubar/examples': '示例',\r\n\t\t\t'menubar/examples/Arkanoid': '打砖块',\r\n\t\t\t'menubar/examples/Camera': ' 摄像机',\r\n\t\t\t'menubar/examples/Particles': '粒子',\r\n\t\t\t'menubar/examples/Pong': '乒乓球',\r\n\t\t\t'menubar/examples/Shaders': '着色器',\r\n\r\n\t\t\t'menubar/view': '视图',\r\n\t\t\t'menubar/view/fullscreen': '全屏',\r\n\r\n\t\t\t'menubar/help': '帮助',\r\n\t\t\t'menubar/help/source_code': '源码',\r\n\t\t\t'menubar/help/icons': '图标组件包',\r\n\t\t\t'menubar/help/about': '关于',\r\n\t\t\t'menubar/help/manual': '手册',\r\n\r\n\t\t\t'sidebar/animations': '动画',\r\n\t\t\t'sidebar/animations/play': '播放',\r\n\t\t\t'sidebar/animations/stop': '暂停',\r\n\t\t\t'sidebar/animations/timescale': '时间缩放',\r\n\r\n\t\t\t'sidebar/scene': '场景',\r\n\t\t\t'sidebar/scene/background': '背景',\r\n\t\t\t'sidebar/scene/environment': '环境',\r\n\t\t\t'sidebar/scene/fog': '雾',\r\n\r\n\t\t\t'sidebar/properties/object': '属性',\r\n\t\t\t'sidebar/properties/geometry': '几何组件',\r\n\t\t\t'sidebar/properties/material': '材质组件',\r\n\t\t\t'sidebar/properties/script': '脚本',\r\n\r\n\t\t\t'sidebar/object/type': '类型',\r\n\t\t\t'sidebar/object/new': '更新',\r\n\t\t\t'sidebar/object/uuid': '识别码',\r\n\t\t\t'sidebar/object/name': '名称',\r\n\t\t\t'sidebar/object/position': '位置',\r\n\t\t\t'sidebar/object/rotation': '旋转',\r\n\t\t\t'sidebar/object/scale': '缩放',\r\n\t\t\t'sidebar/object/fov': '视角',\r\n\t\t\t'sidebar/object/left': '左',\r\n\t\t\t'sidebar/object/right': '右',\r\n\t\t\t'sidebar/object/top': '上',\r\n\t\t\t'sidebar/object/bottom': '下',\r\n\t\t\t'sidebar/object/near': '近点',\r\n\t\t\t'sidebar/object/far': '远点',\r\n\t\t\t'sidebar/object/intensity': '强度',\r\n\t\t\t'sidebar/object/color': '颜色',\r\n\t\t\t'sidebar/object/groundcolor': '基色',\r\n\t\t\t'sidebar/object/distance': '距离',\r\n\t\t\t'sidebar/object/angle': '角度',\r\n\t\t\t'sidebar/object/penumbra': '边缘',\r\n\t\t\t'sidebar/object/decay': '衰减',\r\n\t\t\t'sidebar/object/shadow': '阴影',\r\n\t\t\t'sidebar/object/shadowBias': '阴影偏移',\r\n\t\t\t'sidebar/object/shadowNormalBias': '阴影法线偏移',\r\n\t\t\t'sidebar/object/shadowRadius': '阴影半径',\r\n\t\t\t'sidebar/object/cast': '产生',\r\n\t\t\t'sidebar/object/receive': '接受',\r\n\t\t\t'sidebar/object/visible': '可见性',\r\n\t\t\t'sidebar/object/frustumcull': '视锥体裁剪',\r\n\t\t\t'sidebar/object/renderorder': '渲染次序',\r\n\t\t\t'sidebar/object/userdata': '自定义数据',\r\n\r\n\t\t\t'sidebar/geometry/type': '类型',\r\n\t\t\t'sidebar/geometry/new': '更新',\r\n\t\t\t'sidebar/geometry/uuid': '识别码',\r\n\t\t\t'sidebar/geometry/name': '名称',\r\n\t\t\t'sidebar/geometry/bounds': '界限',\r\n\t\t\t'sidebar/geometry/show_vertex_normals': '显示顶点法线',\r\n\r\n\t\t\t'sidebar/geometry/box_geometry/width': '宽度',\r\n\t\t\t'sidebar/geometry/box_geometry/height': '高度',\r\n\t\t\t'sidebar/geometry/box_geometry/depth': '深度',\r\n\t\t\t'sidebar/geometry/box_geometry/widthseg': '宽度分段',\r\n\t\t\t'sidebar/geometry/box_geometry/heightseg': '高度分段',\r\n\t\t\t'sidebar/geometry/box_geometry/depthseg': '深度分段',\r\n\r\n\t\t\t'sidebar/geometry/buffer_geometry/attributes': '属性',\r\n\t\t\t'sidebar/geometry/buffer_geometry/index': '索引',\r\n\r\n\t\t\t'sidebar/geometry/circle_geometry/radius': '半径',\r\n\t\t\t'sidebar/geometry/circle_geometry/segments': '分段',\r\n\t\t\t'sidebar/geometry/circle_geometry/thetastart': '弧度起点',\r\n\t\t\t'sidebar/geometry/circle_geometry/thetalength': '弧度长度',\r\n\r\n\t\t\t'sidebar/geometry/cylinder_geometry/radiustop': '顶部半径',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/radiusbottom': '底部半径',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/height': '高度',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/radialsegments': '径向分段',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/heightsegments': '高度分段',\r\n\t\t\t'sidebar/geometry/cylinder_geometry/openended': '开端',\r\n\r\n\t\t\t'sidebar/geometry/extrude_geometry/curveSegments': '曲线段',\r\n\t\t\t'sidebar/geometry/extrude_geometry/steps': '细分点数',\r\n\t\t\t'sidebar/geometry/extrude_geometry/depth': '深度',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelEnabled': '启用斜角',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelThickness': '斜角厚度',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelSize': '斜角大小',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelOffset': '斜角偏移量',\r\n\t\t\t'sidebar/geometry/extrude_geometry/bevelSegments': '斜角分段',\r\n\t\t\t'sidebar/geometry/extrude_geometry/shape': '转换图形',\r\n\r\n\t\t\t'sidebar/geometry/dodecahedron_geometry/radius': '半径',\r\n\t\t\t'sidebar/geometry/dodecahedron_geometry/detail': '面片分段',\r\n\r\n\t\t\t'sidebar/geometry/icosahedron_geometry/radius': '半径',\r\n\t\t\t'sidebar/geometry/icosahedron_geometry/detail': '面片分段',\r\n\r\n\t\t\t'sidebar/geometry/octahedron_geometry/radius': '半径',\r\n\t\t\t'sidebar/geometry/octahedron_geometry/detail': '面片分段',\r\n\r\n\t\t\t'sidebar/geometry/tetrahedron_geometry/radius': '半径',\r\n\t\t\t'sidebar/geometry/tetrahedron_geometry/detail': '面片分段',\r\n\r\n\t\t\t'sidebar/geometry/lathe_geometry/segments': '分段',\r\n\t\t\t'sidebar/geometry/lathe_geometry/phistart': '经度起点',\r\n\t\t\t'sidebar/geometry/lathe_geometry/philength': '经度长度',\r\n\t\t\t'sidebar/geometry/lathe_geometry/points': '点',\r\n\r\n\t\t\t'sidebar/geometry/plane_geometry/width': '宽度',\r\n\t\t\t'sidebar/geometry/plane_geometry/height': '长度',\r\n\t\t\t'sidebar/geometry/plane_geometry/widthsegments': '宽度分段',\r\n\t\t\t'sidebar/geometry/plane_geometry/heightsegments': '长度分段',\r\n\r\n\t\t\t'sidebar/geometry/ring_geometry/innerRadius': '内半径',\r\n\t\t\t'sidebar/geometry/ring_geometry/outerRadius': '外半径',\r\n\t\t\t'sidebar/geometry/ring_geometry/thetaSegments': '弧度分段',\r\n\t\t\t'sidebar/geometry/ring_geometry/phiSegments': '经度分段',\r\n\t\t\t'sidebar/geometry/ring_geometry/thetastart': '弧度起点',\r\n\t\t\t'sidebar/geometry/ring_geometry/thetalength': '弧度长度',\r\n\r\n\t\t\t'sidebar/geometry/shape_geometry/curveSegments': '曲线段',\r\n\t\t\t'sidebar/geometry/shape_geometry/extrude': '拉伸',\r\n\r\n\t\t\t'sidebar/geometry/sphere_geometry/radius': '半径',\r\n\t\t\t'sidebar/geometry/sphere_geometry/widthsegments': '宽度分段',\r\n\t\t\t'sidebar/geometry/sphere_geometry/heightsegments': '长度分段',\r\n\t\t\t'sidebar/geometry/sphere_geometry/phistart': '经度起点',\r\n\t\t\t'sidebar/geometry/sphere_geometry/philength': '经度长度',\r\n\t\t\t'sidebar/geometry/sphere_geometry/thetastart': '纬度起点',\r\n\t\t\t'sidebar/geometry/sphere_geometry/thetalength': '纬度长度',\r\n\r\n\t\t\t'sidebar/geometry/torus_geometry/radius': '半径',\r\n\t\t\t'sidebar/geometry/torus_geometry/tube': '管厚',\r\n\t\t\t'sidebar/geometry/torus_geometry/radialsegments': '半径分段',\r\n\t\t\t'sidebar/geometry/torus_geometry/tubularsegments': '管厚分段',\r\n\t\t\t'sidebar/geometry/torus_geometry/arc': '弧度',\r\n\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/radius': '半径',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/tube': '管厚',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/tubularsegments': '管厚分段',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/radialsegments': '半径分段',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/p': '管长弧度',\r\n\t\t\t'sidebar/geometry/torusKnot_geometry/q': '扭曲弧度',\r\n\r\n\t\t\t'sidebar/geometry/tube_geometry/path': '路径',\r\n\t\t\t'sidebar/geometry/tube_geometry/radius': '半径',\r\n\t\t\t'sidebar/geometry/tube_geometry/tube': '管厚',\r\n\t\t\t'sidebar/geometry/tube_geometry/tubularsegments': '管厚分段',\r\n\t\t\t'sidebar/geometry/tube_geometry/radialsegments': '半径分段',\r\n\t\t\t'sidebar/geometry/tube_geometry/closed': '闭合',\r\n\t\t\t'sidebar/geometry/tube_geometry/curvetype': '曲线类型',\r\n\t\t\t'sidebar/geometry/tube_geometry/tension': '张力',\r\n\r\n\t\t\t'sidebar/material/new': '更新',\r\n\t\t\t'sidebar/material/copy': '复制',\r\n\t\t\t'sidebar/material/paste': '粘贴',\r\n\t\t\t'sidebar/material/slot': '插槽',\r\n\t\t\t'sidebar/material/type': '类型',\r\n\t\t\t'sidebar/material/uuid': '识别码',\r\n\t\t\t'sidebar/material/name': '名称',\r\n\t\t\t'sidebar/material/program': '程序',\r\n\t\t\t'sidebar/material/info': '信息',\r\n\t\t\t'sidebar/material/vertex': '顶点',\r\n\t\t\t'sidebar/material/fragment': '片元',\r\n\t\t\t'sidebar/material/color': '颜色',\r\n\t\t\t'sidebar/material/depthPacking': '深度包装',\r\n\t\t\t'sidebar/material/roughness': '粗糙度',\r\n\t\t\t'sidebar/material/metalness': '金属度',\r\n\t\t\t'sidebar/material/reflectivity': '反射率',\r\n\t\t\t'sidebar/material/emissive': '自发光',\r\n\t\t\t'sidebar/material/specular': '高光',\r\n\t\t\t'sidebar/material/shininess': '高光大小',\r\n\t\t\t'sidebar/material/clearcoat': '清漆',\r\n\t\t\t'sidebar/material/clearcoatroughness': '清漆粗糙度',\r\n\t\t\t'sidebar/material/transmission': '透光',\r\n\t\t\t'sidebar/material/attenuationDistance': '衰减距离',\r\n\t\t\t'sidebar/material/attenuationTint': '衰减色彩',\r\n\t\t\t'sidebar/material/thickness': '厚度',\r\n\t\t\t'sidebar/material/vertexcolors': '顶点颜色',\r\n\t\t\t'sidebar/material/matcap': '材质捕获',\r\n\t\t\t'sidebar/material/map': '贴图',\r\n\t\t\t'sidebar/material/alphamap': '透明贴图',\r\n\t\t\t'sidebar/material/bumpmap': '凹凸贴图',\r\n\t\t\t'sidebar/material/normalmap': '法线贴图',\r\n\t\t\t'sidebar/material/clearcoatnormalmap': '清漆法线贴图',\r\n\t\t\t'sidebar/material/displacementmap': '置换贴图',\r\n\t\t\t'sidebar/material/roughnessmap': '粗糙贴图',\r\n\t\t\t'sidebar/material/metalnessmap': '金属贴图',\r\n\t\t\t'sidebar/material/specularmap': '高光贴图',\r\n\t\t\t'sidebar/material/envmap': '环境贴图',\r\n\t\t\t'sidebar/material/lightmap': '光照贴图',\r\n\t\t\t'sidebar/material/aomap': '环境光遮蔽贴图',\r\n\t\t\t'sidebar/material/emissivemap': '自发光贴图',\r\n\t\t\t'sidebar/material/gradientmap': '渐变贴图',\r\n\t\t\t'sidebar/material/side': '面',\r\n\t\t\t'sidebar/material/size': '大小',\r\n\t\t\t'sidebar/material/sizeAttenuation': '大小衰减',\r\n\t\t\t'sidebar/material/flatShading': '平面着色',\r\n\t\t\t'sidebar/material/blending': '混合',\r\n\t\t\t'sidebar/material/opacity': '透明度',\r\n\t\t\t'sidebar/material/transparent': '透明性',\r\n\t\t\t'sidebar/material/alphatest': 'α测试',\r\n\t\t\t'sidebar/material/depthtest': '深度测试',\r\n\t\t\t'sidebar/material/depthwrite': '深度缓冲',\r\n\t\t\t'sidebar/material/wireframe': '线框',\r\n\r\n\t\t\t'sidebar/script': '脚本',\r\n\t\t\t'sidebar/script/new': '新建',\r\n\t\t\t'sidebar/script/edit': '编辑',\r\n\t\t\t'sidebar/script/remove': '删除',\r\n\r\n\t\t\t'sidebar/project': '项目',\r\n\t\t\t'sidebar/project/title': '标题',\r\n\t\t\t'sidebar/project/editable': '编辑性',\r\n\t\t\t'sidebar/project/vr': '虚拟现实',\r\n\t\t\t'sidebar/project/renderer': '渲染器',\r\n\t\t\t'sidebar/project/antialias': '抗锯齿',\r\n\t\t\t'sidebar/project/shadows': '阴影',\r\n\t\t\t'sidebar/project/physicallyCorrectLights': '物理灯',\r\n\t\t\t'sidebar/project/toneMapping': '色调映射',\r\n\t\t\t'sidebar/project/materials': '材质',\r\n\t\t\t'sidebar/project/Assign': '应用',\r\n\r\n\t\t\t'sidebar/project/video': '视频',\r\n\t\t\t'sidebar/project/resolution': '分辨率',\r\n\t\t\t'sidebar/project/duration': '时长',\r\n\t\t\t'sidebar/project/render': '渲染',\r\n\r\n\t\t\t'sidebar/settings': '设置',\r\n\t\t\t'sidebar/settings/language': '语言',\r\n\r\n\t\t\t'sidebar/settings/shortcuts': '快捷键',\r\n\t\t\t'sidebar/settings/shortcuts/translate': '移动',\r\n\t\t\t'sidebar/settings/shortcuts/rotate': '旋转',\r\n\t\t\t'sidebar/settings/shortcuts/scale': '缩放',\r\n\t\t\t'sidebar/settings/shortcuts/undo': '撤销',\r\n\t\t\t'sidebar/settings/shortcuts/focus': '聚焦',\r\n\r\n\t\t\t'sidebar/settings/viewport': '视窗',\r\n\t\t\t'sidebar/settings/viewport/grid': '网格',\r\n\t\t\t'sidebar/settings/viewport/helpers': '辅助',\r\n\r\n\t\t\t'sidebar/history': '历史记录',\r\n\t\t\t'sidebar/history/persistent': '本地存储',\r\n\r\n\t\t\t'toolbar/translate': '移动',\r\n\t\t\t'toolbar/rotate': '旋转',\r\n\t\t\t'toolbar/scale': '缩放',\r\n\t\t\t'toolbar/local': '本地',\r\n\r\n\t\t\t'viewport/info/objects': '物体',\r\n\t\t\t'viewport/info/vertices': '顶点',\r\n\t\t\t'viewport/info/triangles': '三角形',\r\n\t\t\t'viewport/info/frametime': '帧时'\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\treturn {\r\n\r\n\t\tgetKey: function ( key ) {\r\n\r\n\t\t\treturn values[ language ][ key ] || '???';\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}\r\n\r\nexport { Strings };\r\n","function Storage() {\r\n\r\n\tvar indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;\r\n\r\n\tif ( indexedDB === undefined ) {\r\n\r\n\t\tconsole.warn( 'Storage: IndexedDB not available.' );\r\n\t\treturn { init: function () {}, get: function () {}, set: function () {}, clear: function () {} };\r\n\r\n\t}\r\n\r\n\tvar name = 'threejs-editor';\r\n\tvar version = 1;\r\n\r\n\tvar database;\r\n\r\n\treturn {\r\n\r\n\t\tinit: function ( callback ) {\r\n\r\n\t\t\tvar request = indexedDB.open( name, version );\r\n\t\t\trequest.onupgradeneeded = function ( event ) {\r\n\r\n\t\t\t\tvar db = event.target.result;\r\n\r\n\t\t\t\tif ( db.objectStoreNames.contains( 'states' ) === false ) {\r\n\r\n\t\t\t\t\tdb.createObjectStore( 'states' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t\trequest.onsuccess = function ( event ) {\r\n\r\n\t\t\t\tdatabase = event.target.result;\r\n\r\n\t\t\t\tcallback();\r\n\r\n\t\t\t};\r\n\r\n\t\t\trequest.onerror = function ( event ) {\r\n\r\n\t\t\t\tconsole.error( 'IndexedDB', event );\r\n\r\n\t\t\t};\r\n\r\n\r\n\t\t},\r\n\r\n\t\tget: function ( callback ) {\r\n\r\n\t\t\tvar transaction = database.transaction( [ 'states' ], 'readwrite' );\r\n\t\t\tvar objectStore = transaction.objectStore( 'states' );\r\n\t\t\tvar request = objectStore.get( 0 );\r\n\t\t\trequest.onsuccess = function ( event ) {\r\n\r\n\t\t\t\tcallback( event.target.result );\r\n\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( data ) {\r\n\r\n\t\t\tvar start = performance.now();\r\n\r\n\t\t\tvar transaction = database.transaction( [ 'states' ], 'readwrite' );\r\n\t\t\tvar objectStore = transaction.objectStore( 'states' );\r\n\t\t\tvar request = objectStore.put( data, 0 );\r\n\t\t\trequest.onsuccess = function () {\r\n\r\n\t\t\t\tconsole.log( '[' + /\\d\\d\\:\\d\\d\\:\\d\\d/.exec( new Date() )[ 0 ] + ']', 'Saved state to IndexedDB. ' + ( performance.now() - start ).toFixed( 2 ) + 'ms' );\r\n\r\n\t\t\t};\r\n\r\n\t\t},\r\n\r\n\t\tclear: function () {\r\n\r\n\t\t\tif ( database === undefined ) return;\r\n\r\n\t\t\tvar transaction = database.transaction( [ 'states' ], 'readwrite' );\r\n\t\t\tvar objectStore = transaction.objectStore( 'states' );\r\n\t\t\tvar request = objectStore.clear();\r\n\t\t\trequest.onsuccess = function () {\r\n\r\n\t\t\t\tconsole.log( '[' + /\\d\\d\\:\\d\\d\\:\\d\\d/.exec( new Date() )[ 0 ] + ']', 'Cleared IndexedDB.' );\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n}\r\n\r\nexport { Storage };\r\n","import * as THREE from 'three'\r\nimport Signal from 'signals';\r\n\r\nimport { Config } from './Config.js';\r\nimport { Loader } from './Loader.js';\r\nimport { History as _History } from './History.js';\r\nimport { Strings } from './Strings.js';\r\nimport { Storage as _Storage } from './Storage.js';\r\n\r\n\r\nvar _DEFAULT_CAMERA = new THREE.PerspectiveCamera( 50, 1, 0.01, 1000 );\r\n_DEFAULT_CAMERA.name = 'Camera';\r\n_DEFAULT_CAMERA.position.set( 0, 5, 10 );\r\n_DEFAULT_CAMERA.lookAt( new THREE.Vector3() );\r\n\r\nfunction Editor() {\t\r\n\r\n\tthis.signals = {\r\n\r\n\t\t// script\r\n\r\n\t\teditScript: new Signal(),\r\n\r\n\t\t// player\r\n\r\n\t\tstartPlayer: new Signal(),\r\n\t\tstopPlayer: new Signal(),\r\n\r\n\t\t// vr\r\n\r\n\t\ttoggleVR: new Signal(),\r\n\t\texitedVR: new Signal(),\r\n\r\n\t\t// notifications\r\n\r\n\t\teditorCleared: new Signal(),\r\n\r\n\t\tsavingStarted: new Signal(),\r\n\t\tsavingFinished: new Signal(),\r\n\r\n\t\ttransformModeChanged: new Signal(),\r\n\t\tsnapChanged: new Signal(),\r\n\t\tspaceChanged: new Signal(),\r\n\t\trendererCreated: new Signal(),\r\n\t\trendererUpdated: new Signal(),\r\n\r\n\t\tsceneBackgroundChanged: new Signal(),\r\n\t\tsceneEnvironmentChanged: new Signal(),\r\n\t\tsceneFogChanged: new Signal(),\r\n\t\tsceneFogSettingsChanged: new Signal(),\r\n\t\tsceneGraphChanged: new Signal(),\r\n\t\tsceneRendered: new Signal(),\r\n\r\n\t\tcameraChanged: new Signal(),\r\n\t\tcameraResetted: new Signal(),\r\n\r\n\t\tgeometryChanged: new Signal(),\r\n\r\n\t\tobjectSelected: new Signal(),\r\n\t\tobjectFocused: new Signal(),\r\n\r\n\t\tobjectAdded: new Signal(),\r\n\t\tobjectChanged: new Signal(),\r\n\t\tobjectRemoved: new Signal(),\r\n\r\n\t\tcameraAdded: new Signal(),\r\n\t\tcameraRemoved: new Signal(),\r\n\r\n\t\thelperAdded: new Signal(),\r\n\t\thelperRemoved: new Signal(),\r\n\r\n\t\tmaterialAdded: new Signal(),\r\n\t\tmaterialChanged: new Signal(),\r\n\t\tmaterialRemoved: new Signal(),\r\n\r\n\t\tscriptAdded: new Signal(),\r\n\t\tscriptChanged: new Signal(),\r\n\t\tscriptRemoved: new Signal(),\r\n\r\n\t\twindowResize: new Signal(),\r\n\r\n\t\tshowGridChanged: new Signal(),\r\n\t\tshowHelpersChanged: new Signal(),\r\n\t\trefreshSidebarObject3D: new Signal(),\r\n\t\thistoryChanged: new Signal(),\r\n\r\n\t\tviewportCameraChanged: new Signal(),\r\n\r\n\t\tanimationStopped: new Signal()\r\n\r\n\t};\r\n\r\n\tthis.config = new Config();\r\n\tthis.history = new _History( this );\r\n\tthis.storage = new _Storage();\r\n\tthis.strings = new Strings( this.config );\r\n\r\n\tthis.loader = new Loader( this );\r\n\r\n\tthis.camera = _DEFAULT_CAMERA.clone();\r\n\r\n\tthis.scene = new THREE.Scene();\r\n\tthis.scene.name = 'Scene';\r\n\r\n\tthis.sceneHelpers = new THREE.Scene();\r\n\r\n\tthis.object = {};\r\n\tthis.geometries = {};\r\n\tthis.materials = {};\r\n\tthis.textures = {};\r\n\tthis.scripts = {};\r\n\r\n\tthis.materialsRefCounter = new Map(); // tracks how often is a material used by a 3D object\r\n\r\n\tthis.mixer = new THREE.AnimationMixer( this.scene );\r\n\r\n\tthis.selected = null;\r\n\tthis.helpers = {};\r\n\r\n\tthis.cameras = {};\r\n\tthis.viewportCamera = this.camera;\r\n\r\n\tthis.addCamera( this.camera );\r\n\r\n}\r\n\r\nEditor.prototype = {\r\n\r\n\tsetScene: function ( scene ) {\r\n\r\n\t\tthis.scene.uuid = scene.uuid;\r\n\t\tthis.scene.name = scene.name;\r\n\r\n\t\tthis.scene.background = scene.background;\r\n\t\tthis.scene.environment = scene.environment;\r\n\t\tthis.scene.fog = scene.fog;\r\n\r\n\t\tthis.scene.userData = JSON.parse( JSON.stringify( scene.userData ) );\r\n\r\n\t\t// avoid render per object\r\n\r\n\t\tthis.signals.sceneGraphChanged.active = false;\r\n\r\n\t\twhile ( scene.children.length > 0 ) {\r\n\r\n\t\t\tthis.addObject( scene.children[ 0 ] );\r\n\r\n\t\t}\r\n\r\n\t\tthis.signals.sceneGraphChanged.active = true;\r\n\t\tthis.signals.sceneGraphChanged.dispatch();\r\n\r\n\t},\r\n\r\n\t//\r\n\r\n\taddObject: function ( object, parent, index ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tobject.traverse( function ( child ) {\r\n\r\n\t\t\tif ( child.geometry !== undefined ) scope.addGeometry( child.geometry );\r\n\t\t\tif ( child.material !== undefined ) scope.addMaterial( child.material );\r\n\r\n\t\t\tscope.addCamera( child );\r\n\t\t\tscope.addHelper( child );\r\n\r\n\t\t} );\r\n\r\n\t\tif ( parent === undefined ) {\r\n\r\n\t\t\tthis.scene.add( object );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tparent.children.splice( index, 0, object );\r\n\t\t\tobject.parent = parent;\r\n\r\n\t\t}\r\n\r\n\t\tthis.signals.objectAdded.dispatch( object );\r\n\t\tthis.signals.sceneGraphChanged.dispatch();\r\n\r\n\t},\r\n\r\n\tmoveObject: function ( object, parent, before ) {\r\n\r\n\t\tif ( parent === undefined ) {\r\n\r\n\t\t\tparent = this.scene;\r\n\r\n\t\t}\r\n\r\n\t\tparent.add( object );\r\n\r\n\t\t// sort children array\r\n\r\n\t\tif ( before !== undefined ) {\r\n\r\n\t\t\tvar index = parent.children.indexOf( before );\r\n\t\t\tparent.children.splice( index, 0, object );\r\n\t\t\tparent.children.pop();\r\n\r\n\t\t}\r\n\r\n\t\tthis.signals.sceneGraphChanged.dispatch();\r\n\r\n\t},\r\n\r\n\tnameObject: function ( object, name ) {\r\n\r\n\t\tobject.name = name;\r\n\t\tthis.signals.sceneGraphChanged.dispatch();\r\n\r\n\t},\r\n\r\n\tremoveObject: function ( object ) {\r\n\r\n\t\tif ( object.parent === null ) return; // avoid deleting the camera or scene\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tobject.traverse( function ( child ) {\r\n\r\n\t\t\tscope.removeCamera( child );\r\n\t\t\tscope.removeHelper( child );\r\n\r\n\t\t\tif ( child.material !== undefined ) scope.removeMaterial( child.material );\r\n\r\n\t\t} );\r\n\r\n\t\tobject.parent.remove( object );\r\n\r\n\t\tthis.signals.objectRemoved.dispatch( object );\r\n\t\tthis.signals.sceneGraphChanged.dispatch();\r\n\r\n\t},\r\n\r\n\taddGeometry: function ( geometry ) {\r\n\r\n\t\tthis.geometries[ geometry.uuid ] = geometry;\r\n\r\n\t},\r\n\r\n\tsetGeometryName: function ( geometry, name ) {\r\n\r\n\t\tgeometry.name = name;\r\n\t\tthis.signals.sceneGraphChanged.dispatch();\r\n\r\n\t},\r\n\r\n\taddMaterial: function ( material ) {\r\n\r\n\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\tfor ( var i = 0, l = material.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.addMaterialToRefCounter( material[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.addMaterialToRefCounter( material );\r\n\r\n\t\t}\r\n\r\n\t\tthis.signals.materialAdded.dispatch();\r\n\r\n\t},\r\n\r\n\taddMaterialToRefCounter: function ( material ) {\r\n\r\n\t\tvar materialsRefCounter = this.materialsRefCounter;\r\n\r\n\t\tvar count = materialsRefCounter.get( material );\r\n\r\n\t\tif ( count === undefined ) {\r\n\r\n\t\t\tmaterialsRefCounter.set( material, 1 );\r\n\t\t\tthis.materials[ material.uuid ] = material;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcount ++;\r\n\t\t\tmaterialsRefCounter.set( material, count );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tremoveMaterial: function ( material ) {\r\n\r\n\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\tfor ( var i = 0, l = material.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tthis.removeMaterialFromRefCounter( material[ i ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.removeMaterialFromRefCounter( material );\r\n\r\n\t\t}\r\n\r\n\t\tthis.signals.materialRemoved.dispatch();\r\n\r\n\t},\r\n\r\n\tremoveMaterialFromRefCounter: function ( material ) {\r\n\r\n\t\tvar materialsRefCounter = this.materialsRefCounter;\r\n\r\n\t\tvar count = materialsRefCounter.get( material );\r\n\t\tcount --;\r\n\r\n\t\tif ( count === 0 ) {\r\n\r\n\t\t\tmaterialsRefCounter.delete( material );\r\n\t\t\tdelete this.materials[ material.uuid ];\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmaterialsRefCounter.set( material, count );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tgetMaterialById: function ( id ) {\r\n\r\n\t\tvar material;\r\n\t\tvar materials = Object.values( this.materials );\r\n\r\n\t\tfor ( var i = 0; i < materials.length; i ++ ) {\r\n\r\n\t\t\tif ( materials[ i ].id === id ) {\r\n\r\n\t\t\t\tmaterial = materials[ i ];\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn material;\r\n\r\n\t},\r\n\r\n\tsetMaterialName: function ( material, name ) {\r\n\r\n\t\tmaterial.name = name;\r\n\t\tthis.signals.sceneGraphChanged.dispatch();\r\n\r\n\t},\r\n\r\n\taddTexture: function ( texture ) {\r\n\r\n\t\tthis.textures[ texture.uuid ] = texture;\r\n\r\n\t},\r\n\r\n\t//\r\n\r\n\taddCamera: function ( camera ) {\r\n\r\n\t\tif ( camera.isCamera ) {\r\n\r\n\t\t\tthis.cameras[ camera.uuid ] = camera;\r\n\r\n\t\t\tthis.signals.cameraAdded.dispatch( camera );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tremoveCamera: function ( camera ) {\r\n\r\n\t\tif ( this.cameras[ camera.uuid ] !== undefined ) {\r\n\r\n\t\t\tdelete this.cameras[ camera.uuid ];\r\n\r\n\t\t\tthis.signals.cameraRemoved.dispatch( camera );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t//\r\n\r\n\taddHelper: function () {\r\n\r\n\t\tvar geometry = new THREE.SphereGeometry( 2, 4, 2 );\r\n\t\tvar material = new THREE.MeshBasicMaterial( { color: 0xff0000, visible: false } );\r\n\r\n\t\treturn function ( object, helper ) {\r\n\r\n\t\t\tif ( helper === undefined ) {\r\n\r\n\t\t\t\tif ( object.isCamera ) {\r\n\r\n\t\t\t\t\thelper = new THREE.CameraHelper( object );\r\n\r\n\t\t\t\t} else if ( object.isPointLight ) {\r\n\r\n\t\t\t\t\thelper = new THREE.PointLightHelper( object, 1 );\r\n\r\n\t\t\t\t} else if ( object.isDirectionalLight ) {\r\n\r\n\t\t\t\t\thelper = new THREE.DirectionalLightHelper( object, 1 );\r\n\r\n\t\t\t\t} else if ( object.isSpotLight ) {\r\n\r\n\t\t\t\t\thelper = new THREE.SpotLightHelper( object );\r\n\r\n\t\t\t\t} else if ( object.isHemisphereLight ) {\r\n\r\n\t\t\t\t\thelper = new THREE.HemisphereLightHelper( object, 1 );\r\n\r\n\t\t\t\t} else if ( object.isSkinnedMesh ) {\r\n\r\n\t\t\t\t\thelper = new THREE.SkeletonHelper( object.skeleton.bones[ 0 ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t// no helper for this object type\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar picker = new THREE.Mesh( geometry, material );\r\n\t\t\t\tpicker.name = 'picker';\r\n\t\t\t\tpicker.userData.object = object;\r\n\t\t\t\thelper.add( picker );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.sceneHelpers.add( helper );\r\n\t\t\tthis.helpers[ object.id ] = helper;\r\n\r\n\t\t\tthis.signals.helperAdded.dispatch( helper );\r\n\r\n\t\t};\r\n\r\n\t}(),\r\n\r\n\tremoveHelper: function ( object ) {\r\n\r\n\t\tif ( this.helpers[ object.id ] !== undefined ) {\r\n\r\n\t\t\tvar helper = this.helpers[ object.id ];\r\n\t\t\thelper.parent.remove( helper );\r\n\r\n\t\t\tdelete this.helpers[ object.id ];\r\n\r\n\t\t\tthis.signals.helperRemoved.dispatch( helper );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t//\r\n\r\n\taddScript: function ( object, script ) {\r\n\r\n\t\tif ( this.scripts[ object.uuid ] === undefined ) {\r\n\r\n\t\t\tthis.scripts[ object.uuid ] = [];\r\n\r\n\t\t}\r\n\r\n\t\tthis.scripts[ object.uuid ].push( script );\r\n\r\n\t\tthis.signals.scriptAdded.dispatch( script );\r\n\r\n\t},\r\n\r\n\tremoveScript: function ( object, script ) {\r\n\r\n\t\tif ( this.scripts[ object.uuid ] === undefined ) return;\r\n\r\n\t\tvar index = this.scripts[ object.uuid ].indexOf( script );\r\n\r\n\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\tthis.scripts[ object.uuid ].splice( index, 1 );\r\n\r\n\t\t}\r\n\r\n\t\tthis.signals.scriptRemoved.dispatch( script );\r\n\r\n\t},\r\n\r\n\tgetObjectMaterial: function ( object, slot ) {\r\n\r\n\t\tvar material = object.material;\r\n\r\n\t\tif ( Array.isArray( material ) && slot !== undefined ) {\r\n\r\n\t\t\tmaterial = material[ slot ];\r\n\r\n\t\t}\r\n\r\n\t\treturn material;\r\n\r\n\t},\r\n\r\n\tsetObjectMaterial: function ( object, slot, newMaterial ) {\r\n\r\n\t\tif ( Array.isArray( object.material ) && slot !== undefined ) {\r\n\r\n\t\t\tobject.material[ slot ] = newMaterial;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tobject.material = newMaterial;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tsetViewportCamera: function ( uuid ) {\r\n\r\n\t\tthis.viewportCamera = this.cameras[ uuid ];\r\n\t\tthis.signals.viewportCameraChanged.dispatch();\r\n\r\n\t},\r\n\r\n\t//\r\n\r\n\tselect: function ( object ) {\r\n\r\n\t\tif ( this.selected === object ) return;\r\n\r\n\t\tvar uuid = null;\r\n\r\n\t\tif ( object !== null ) {\r\n\r\n\t\t\tuuid = object.uuid;\r\n\r\n\t\t}\r\n\r\n\t\tthis.selected = object;\r\n\r\n\t\tthis.config.setKey( 'selected', uuid );\r\n\t\tthis.signals.objectSelected.dispatch( object );\r\n\r\n\t},\r\n\r\n\tselectById: function ( id ) {\r\n\r\n\t\tif ( id === this.camera.id ) {\r\n\r\n\t\t\tthis.select( this.camera );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tthis.select( this.scene.getObjectById( id ) );\r\n\r\n\t},\r\n\r\n\tselectByUuid: function ( uuid ) {\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tthis.scene.traverse( function ( child ) {\r\n\r\n\t\t\tif ( child.uuid === uuid ) {\r\n\r\n\t\t\t\tscope.select( child );\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t},\r\n\r\n\tdeselect: function () {\r\n\r\n\t\tthis.select( null );\r\n\r\n\t},\r\n\r\n\tfocus: function ( object ) {\r\n\r\n\t\tif ( object !== undefined ) {\r\n\r\n\t\t\tthis.signals.objectFocused.dispatch( object );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tfocusById: function ( id ) {\r\n\r\n\t\tthis.focus( this.scene.getObjectById( id ) );\r\n\r\n\t},\r\n\r\n\tclear: function () {\r\n\r\n\t\tthis.history.clear();\r\n\t\tthis.storage.clear();\r\n\r\n\t\tthis.camera.copy( _DEFAULT_CAMERA );\r\n\t\tthis.signals.cameraResetted.dispatch();\r\n\r\n\t\tthis.scene.name = 'Scene';\r\n\t\tthis.scene.userData = {};\r\n\t\tthis.scene.background = null;\r\n\t\tthis.scene.environment = null;\r\n\t\tthis.scene.fog = null;\r\n\r\n\t\tvar objects = this.scene.children;\r\n\r\n\t\twhile ( objects.length > 0 ) {\r\n\r\n\t\t\tthis.removeObject( objects[ 0 ] );\r\n\r\n\t\t}\r\n\r\n\t\tthis.geometries = {};\r\n\t\tthis.materials = {};\r\n\t\tthis.textures = {};\r\n\t\tthis.scripts = {};\r\n\r\n\t\tthis.materialsRefCounter.clear();\r\n\r\n\t\tthis.animations = {};\r\n\t\tthis.mixer.stopAllAction();\r\n\r\n\t\tthis.deselect();\r\n\r\n\t\tthis.signals.editorCleared.dispatch();\r\n\r\n\t},\r\n\r\n\t//\r\n\r\n\tfromJSON: async function ( json ) {\r\n\r\n\t\tvar loader = new THREE.ObjectLoader();\r\n\t\tvar camera = await loader.parseAsync( json.camera );\r\n\r\n\t\tthis.camera.copy( camera );\r\n\t\tthis.signals.cameraResetted.dispatch();\r\n\r\n\t\tthis.history.fromJSON( json.history );\r\n\t\tthis.scripts = json.scripts;\r\n\r\n\t\tthis.setScene( await loader.parseAsync( json.scene ) );\r\n\r\n\t},\r\n\r\n\ttoJSON: function () {\r\n\r\n\t\t// scripts clean up\r\n\r\n\t\tvar scene = this.scene;\r\n\t\tvar scripts = this.scripts;\r\n\r\n\t\tfor ( var key in scripts ) {\r\n\r\n\t\t\tvar script = scripts[ key ];\r\n\r\n\t\t\tif ( script.length === 0 || scene.getObjectByProperty( 'uuid', key ) === undefined ) {\r\n\r\n\t\t\t\tdelete scripts[ key ];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\treturn {\r\n\r\n\t\t\tmetadata: {},\r\n\t\t\tproject: {\r\n\t\t\t\tshadows: this.config.getKey( 'project/renderer/shadows' ),\r\n\t\t\t\tshadowType: this.config.getKey( 'project/renderer/shadowType' ),\r\n\t\t\t\tvr: this.config.getKey( 'project/vr' ),\r\n\t\t\t\tphysicallyCorrectLights: this.config.getKey( 'project/renderer/physicallyCorrectLights' ),\r\n\t\t\t\ttoneMapping: this.config.getKey( 'project/renderer/toneMapping' ),\r\n\t\t\t\ttoneMappingExposure: this.config.getKey( 'project/renderer/toneMappingExposure' )\r\n\t\t\t},\r\n\t\t\tcamera: this.camera.toJSON(),\r\n\t\t\tscene: this.scene.toJSON(),\r\n\t\t\tscripts: this.scripts,\r\n\t\t\thistory: this.history.toJSON()\r\n\r\n\t\t};\r\n\r\n\t},\r\n\r\n\tobjectByUuid: function ( uuid ) {\r\n\r\n\t\treturn this.scene.getObjectByProperty( 'uuid', uuid, true );\r\n\r\n\t},\r\n\r\n\texecute: function ( cmd, optionalName ) {\r\n\r\n\t\tthis.history.execute( cmd, optionalName );\r\n\r\n\t},\r\n\r\n\tundo: function () {\r\n\r\n\t\tthis.history.undo();\r\n\r\n\t},\r\n\r\n\tredo: function () {\r\n\r\n\t\tthis.history.redo();\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport { Editor };\r\n","import {\r\n\tBoxGeometry,\r\n\tBufferGeometry,\r\n\tCylinderGeometry,\r\n\tDoubleSide,\r\n\tEuler,\r\n\tFloat32BufferAttribute,\r\n\tLine,\r\n\tLineBasicMaterial,\r\n\tMatrix4,\r\n\tMesh,\r\n\tMeshBasicMaterial,\r\n\tObject3D,\r\n\tOctahedronGeometry,\r\n\tPlaneGeometry,\r\n\tQuaternion,\r\n\tRaycaster,\r\n\tSphereGeometry,\r\n\tTorusGeometry,\r\n\tVector3\r\n} from 'three';\r\n\r\nconst _raycaster = new Raycaster();\r\n\r\nconst _tempVector = new Vector3();\r\nconst _tempVector2 = new Vector3();\r\nconst _tempQuaternion = new Quaternion();\r\nconst _unit = {\r\n\tX: new Vector3( 1, 0, 0 ),\r\n\tY: new Vector3( 0, 1, 0 ),\r\n\tZ: new Vector3( 0, 0, 1 )\r\n};\r\n\r\nconst _changeEvent = { type: 'change' };\r\nconst _mouseDownEvent = { type: 'mouseDown' };\r\nconst _mouseUpEvent = { type: 'mouseUp', mode: null };\r\nconst _objectChangeEvent = { type: 'objectChange' };\r\n\r\nclass TransformControls extends Object3D {\r\n\r\n\tconstructor( camera, domElement ) {\r\n\r\n\t\tsuper();\r\n\r\n\t\tif ( domElement === undefined ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.TransformControls: The second parameter \"domElement\" is now mandatory.' );\r\n\t\t\tdomElement = document;\r\n\r\n\t\t}\r\n\r\n\t\tthis.visible = false;\r\n\t\tthis.domElement = domElement;\r\n\t\tthis.domElement.style.touchAction = 'none'; // disable touch scroll\r\n\r\n\t\tconst _gizmo = new TransformControlsGizmo();\r\n\t\tthis._gizmo = _gizmo;\r\n\t\tthis.add( _gizmo );\r\n\r\n\t\tconst _plane = new TransformControlsPlane();\r\n\t\tthis._plane = _plane;\r\n\t\tthis.add( _plane );\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\t// Defined getter, setter and store for a property\r\n\t\tfunction defineProperty( propName, defaultValue ) {\r\n\r\n\t\t\tlet propValue = defaultValue;\r\n\r\n\t\t\tObject.defineProperty( scope, propName, {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\treturn propValue !== undefined ? propValue : defaultValue;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\tset: function ( value ) {\r\n\r\n\t\t\t\t\tif ( propValue !== value ) {\r\n\r\n\t\t\t\t\t\tpropValue = value;\r\n\t\t\t\t\t\t_plane[ propName ] = value;\r\n\t\t\t\t\t\t_gizmo[ propName ] = value;\r\n\r\n\t\t\t\t\t\tscope.dispatchEvent( { type: propName + '-changed', value: value } );\r\n\t\t\t\t\t\tscope.dispatchEvent( _changeEvent );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tscope[ propName ] = defaultValue;\r\n\t\t\t_plane[ propName ] = defaultValue;\r\n\t\t\t_gizmo[ propName ] = defaultValue;\r\n\r\n\t\t}\r\n\r\n\t\t// Define properties with getters/setter\r\n\t\t// Setting the defined property will automatically trigger change event\r\n\t\t// Defined properties are passed down to gizmo and plane\r\n\r\n\t\tdefineProperty( 'camera', camera );\r\n\t\tdefineProperty( 'object', undefined );\r\n\t\tdefineProperty( 'enabled', true );\r\n\t\tdefineProperty( 'axis', null );\r\n\t\tdefineProperty( 'mode', 'translate' );\r\n\t\tdefineProperty( 'translationSnap', null );\r\n\t\tdefineProperty( 'rotationSnap', null );\r\n\t\tdefineProperty( 'scaleSnap', null );\r\n\t\tdefineProperty( 'space', 'world' );\r\n\t\tdefineProperty( 'size', 1 );\r\n\t\tdefineProperty( 'dragging', false );\r\n\t\tdefineProperty( 'showX', true );\r\n\t\tdefineProperty( 'showY', true );\r\n\t\tdefineProperty( 'showZ', true );\r\n\r\n\t\t// Reusable utility variables\r\n\r\n\t\tconst worldPosition = new Vector3();\r\n\t\tconst worldPositionStart = new Vector3();\r\n\t\tconst worldQuaternion = new Quaternion();\r\n\t\tconst worldQuaternionStart = new Quaternion();\r\n\t\tconst cameraPosition = new Vector3();\r\n\t\tconst cameraQuaternion = new Quaternion();\r\n\t\tconst pointStart = new Vector3();\r\n\t\tconst pointEnd = new Vector3();\r\n\t\tconst rotationAxis = new Vector3();\r\n\t\tconst rotationAngle = 0;\r\n\t\tconst eye = new Vector3();\r\n\r\n\t\t// TODO: remove properties unused in plane and gizmo\r\n\r\n\t\tdefineProperty( 'worldPosition', worldPosition );\r\n\t\tdefineProperty( 'worldPositionStart', worldPositionStart );\r\n\t\tdefineProperty( 'worldQuaternion', worldQuaternion );\r\n\t\tdefineProperty( 'worldQuaternionStart', worldQuaternionStart );\r\n\t\tdefineProperty( 'cameraPosition', cameraPosition );\r\n\t\tdefineProperty( 'cameraQuaternion', cameraQuaternion );\r\n\t\tdefineProperty( 'pointStart', pointStart );\r\n\t\tdefineProperty( 'pointEnd', pointEnd );\r\n\t\tdefineProperty( 'rotationAxis', rotationAxis );\r\n\t\tdefineProperty( 'rotationAngle', rotationAngle );\r\n\t\tdefineProperty( 'eye', eye );\r\n\r\n\t\tthis._offset = new Vector3();\r\n\t\tthis._startNorm = new Vector3();\r\n\t\tthis._endNorm = new Vector3();\r\n\t\tthis._cameraScale = new Vector3();\r\n\r\n\t\tthis._parentPosition = new Vector3();\r\n\t\tthis._parentQuaternion = new Quaternion();\r\n\t\tthis._parentQuaternionInv = new Quaternion();\r\n\t\tthis._parentScale = new Vector3();\r\n\r\n\t\tthis._worldScaleStart = new Vector3();\r\n\t\tthis._worldQuaternionInv = new Quaternion();\r\n\t\tthis._worldScale = new Vector3();\r\n\r\n\t\tthis._positionStart = new Vector3();\r\n\t\tthis._quaternionStart = new Quaternion();\r\n\t\tthis._scaleStart = new Vector3();\r\n\r\n\t\tthis._getPointer = getPointer.bind( this );\r\n\t\tthis._onPointerDown = onPointerDown.bind( this );\r\n\t\tthis._onPointerHover = onPointerHover.bind( this );\r\n\t\tthis._onPointerMove = onPointerMove.bind( this );\r\n\t\tthis._onPointerUp = onPointerUp.bind( this );\r\n\r\n\t\tthis.domElement.addEventListener( 'pointerdown', this._onPointerDown );\r\n\t\tthis.domElement.addEventListener( 'pointermove', this._onPointerHover );\r\n\t\tthis.domElement.addEventListener( 'pointerup', this._onPointerUp );\r\n\r\n\t}\r\n\r\n\t// updateMatrixWorld  updates key transformation variables\r\n\tupdateMatrixWorld() {\r\n\r\n\t\tif ( this.object !== undefined ) {\r\n\r\n\t\t\tthis.object.updateMatrixWorld();\r\n\r\n\t\t\tif ( this.object.parent === null ) {\r\n\r\n\t\t\t\tconsole.error( 'TransformControls: The attached 3D object must be a part of the scene graph.' );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.object.parent.matrixWorld.decompose( this._parentPosition, this._parentQuaternion, this._parentScale );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.object.matrixWorld.decompose( this.worldPosition, this.worldQuaternion, this._worldScale );\r\n\r\n\t\t\tthis._parentQuaternionInv.copy( this._parentQuaternion ).invert();\r\n\t\t\tthis._worldQuaternionInv.copy( this.worldQuaternion ).invert();\r\n\r\n\t\t}\r\n\r\n\t\tthis.camera.updateMatrixWorld();\r\n\t\tthis.camera.matrixWorld.decompose( this.cameraPosition, this.cameraQuaternion, this._cameraScale );\r\n\r\n\t\tthis.eye.copy( this.cameraPosition ).sub( this.worldPosition ).normalize();\r\n\r\n\t\tsuper.updateMatrixWorld( this );\r\n\r\n\t}\r\n\r\n\tpointerHover( pointer ) {\r\n\r\n\t\tif ( this.object === undefined || this.dragging === true ) return;\r\n\r\n\t\t_raycaster.setFromCamera( pointer, this.camera );\r\n\r\n\t\tconst intersect = intersectObjectWithRay( this._gizmo.picker[ this.mode ], _raycaster );\r\n\r\n\t\tif ( intersect ) {\r\n\r\n\t\t\tthis.axis = intersect.object.name;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tthis.axis = null;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpointerDown( pointer ) {\r\n\r\n\t\tif ( this.object === undefined || this.dragging === true || pointer.button !== 0 ) return;\r\n\r\n\t\tif ( this.axis !== null ) {\r\n\r\n\t\t\t_raycaster.setFromCamera( pointer, this.camera );\r\n\r\n\t\t\tconst planeIntersect = intersectObjectWithRay( this._plane, _raycaster, true );\r\n\r\n\t\t\tif ( planeIntersect ) {\r\n\r\n\t\t\t\tlet space = this.space;\r\n\r\n\t\t\t\tif ( this.mode === 'scale' ) {\r\n\r\n\t\t\t\t\tspace = 'local';\r\n\r\n\t\t\t\t} else if ( this.axis === 'E' || this.axis === 'XYZE' || this.axis === 'XYZ' ) {\r\n\r\n\t\t\t\t\tspace = 'world';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( space === 'local' && this.mode === 'rotate' ) {\r\n\r\n\t\t\t\t\tconst snap = this.rotationSnap;\r\n\r\n\t\t\t\t\tif ( this.axis === 'X' && snap ) this.object.rotation.x = Math.round( this.object.rotation.x / snap ) * snap;\r\n\t\t\t\t\tif ( this.axis === 'Y' && snap ) this.object.rotation.y = Math.round( this.object.rotation.y / snap ) * snap;\r\n\t\t\t\t\tif ( this.axis === 'Z' && snap ) this.object.rotation.z = Math.round( this.object.rotation.z / snap ) * snap;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.object.updateMatrixWorld();\r\n\t\t\t\tthis.object.parent.updateMatrixWorld();\r\n\r\n\t\t\t\tthis._positionStart.copy( this.object.position );\r\n\t\t\t\tthis._quaternionStart.copy( this.object.quaternion );\r\n\t\t\t\tthis._scaleStart.copy( this.object.scale );\r\n\r\n\t\t\t\tthis.object.matrixWorld.decompose( this.worldPositionStart, this.worldQuaternionStart, this._worldScaleStart );\r\n\r\n\t\t\t\tthis.pointStart.copy( planeIntersect.point ).sub( this.worldPositionStart );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.dragging = true;\r\n\t\t\t_mouseDownEvent.mode = this.mode;\r\n\t\t\tthis.dispatchEvent( _mouseDownEvent );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tpointerMove( pointer ) {\r\n\r\n\t\tconst axis = this.axis;\r\n\t\tconst mode = this.mode;\r\n\t\tconst object = this.object;\r\n\t\tlet space = this.space;\r\n\r\n\t\tif ( mode === 'scale' ) {\r\n\r\n\t\t\tspace = 'local';\r\n\r\n\t\t} else if ( axis === 'E' || axis === 'XYZE' || axis === 'XYZ' ) {\r\n\r\n\t\t\tspace = 'world';\r\n\r\n\t\t}\r\n\r\n\t\tif ( object === undefined || axis === null || this.dragging === false || pointer.button !== - 1 ) return;\r\n\r\n\t\t_raycaster.setFromCamera( pointer, this.camera );\r\n\r\n\t\tconst planeIntersect = intersectObjectWithRay( this._plane, _raycaster, true );\r\n\r\n\t\tif ( ! planeIntersect ) return;\r\n\r\n\t\tthis.pointEnd.copy( planeIntersect.point ).sub( this.worldPositionStart );\r\n\r\n\t\tif ( mode === 'translate' ) {\r\n\r\n\t\t\t// Apply translate\r\n\r\n\t\t\tthis._offset.copy( this.pointEnd ).sub( this.pointStart );\r\n\r\n\t\t\tif ( space === 'local' && axis !== 'XYZ' ) {\r\n\r\n\t\t\t\tthis._offset.applyQuaternion( this._worldQuaternionInv );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( axis.indexOf( 'X' ) === - 1 ) this._offset.x = 0;\r\n\t\t\tif ( axis.indexOf( 'Y' ) === - 1 ) this._offset.y = 0;\r\n\t\t\tif ( axis.indexOf( 'Z' ) === - 1 ) this._offset.z = 0;\r\n\r\n\t\t\tif ( space === 'local' && axis !== 'XYZ' ) {\r\n\r\n\t\t\t\tthis._offset.applyQuaternion( this._quaternionStart ).divide( this._parentScale );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis._offset.applyQuaternion( this._parentQuaternionInv ).divide( this._parentScale );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tobject.position.copy( this._offset ).add( this._positionStart );\r\n\r\n\t\t\t// Apply translation snap\r\n\r\n\t\t\tif ( this.translationSnap ) {\r\n\r\n\t\t\t\tif ( space === 'local' ) {\r\n\r\n\t\t\t\t\tobject.position.applyQuaternion( _tempQuaternion.copy( this._quaternionStart ).invert() );\r\n\r\n\t\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tobject.position.applyQuaternion( this._quaternionStart );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( space === 'world' ) {\r\n\r\n\t\t\t\t\tif ( object.parent ) {\r\n\r\n\t\t\t\t\t\tobject.position.add( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\r\n\r\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( object.parent ) {\r\n\r\n\t\t\t\t\t\tobject.position.sub( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( mode === 'scale' ) {\r\n\r\n\t\t\tif ( axis.search( 'XYZ' ) !== - 1 ) {\r\n\r\n\t\t\t\tlet d = this.pointEnd.length() / this.pointStart.length();\r\n\r\n\t\t\t\tif ( this.pointEnd.dot( this.pointStart ) < 0 ) d *= - 1;\r\n\r\n\t\t\t\t_tempVector2.set( d, d, d );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t_tempVector.copy( this.pointStart );\r\n\t\t\t\t_tempVector2.copy( this.pointEnd );\r\n\r\n\t\t\t\t_tempVector.applyQuaternion( this._worldQuaternionInv );\r\n\t\t\t\t_tempVector2.applyQuaternion( this._worldQuaternionInv );\r\n\r\n\t\t\t\t_tempVector2.divide( _tempVector );\r\n\r\n\t\t\t\tif ( axis.search( 'X' ) === - 1 ) {\r\n\r\n\t\t\t\t\t_tempVector2.x = 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( axis.search( 'Y' ) === - 1 ) {\r\n\r\n\t\t\t\t\t_tempVector2.y = 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( axis.search( 'Z' ) === - 1 ) {\r\n\r\n\t\t\t\t\t_tempVector2.z = 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Apply scale\r\n\r\n\t\t\tobject.scale.copy( this._scaleStart ).multiply( _tempVector2 );\r\n\r\n\t\t\tif ( this.scaleSnap ) {\r\n\r\n\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\r\n\r\n\t\t\t\t\tobject.scale.x = Math.round( object.scale.x / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\r\n\r\n\t\t\t\t\tobject.scale.y = Math.round( object.scale.y / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\r\n\r\n\t\t\t\t\tobject.scale.z = Math.round( object.scale.z / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else if ( mode === 'rotate' ) {\r\n\r\n\t\t\tthis._offset.copy( this.pointEnd ).sub( this.pointStart );\r\n\r\n\t\t\tconst ROTATION_SPEED = 20 / this.worldPosition.distanceTo( _tempVector.setFromMatrixPosition( this.camera.matrixWorld ) );\r\n\r\n\t\t\tif ( axis === 'E' ) {\r\n\r\n\t\t\t\tthis.rotationAxis.copy( this.eye );\r\n\t\t\t\tthis.rotationAngle = this.pointEnd.angleTo( this.pointStart );\r\n\r\n\t\t\t\tthis._startNorm.copy( this.pointStart ).normalize();\r\n\t\t\t\tthis._endNorm.copy( this.pointEnd ).normalize();\r\n\r\n\t\t\t\tthis.rotationAngle *= ( this._endNorm.cross( this._startNorm ).dot( this.eye ) < 0 ? 1 : - 1 );\r\n\r\n\t\t\t} else if ( axis === 'XYZE' ) {\r\n\r\n\t\t\t\tthis.rotationAxis.copy( this._offset ).cross( this.eye ).normalize();\r\n\t\t\t\tthis.rotationAngle = this._offset.dot( _tempVector.copy( this.rotationAxis ).cross( this.eye ) ) * ROTATION_SPEED;\r\n\r\n\t\t\t} else if ( axis === 'X' || axis === 'Y' || axis === 'Z' ) {\r\n\r\n\t\t\t\tthis.rotationAxis.copy( _unit[ axis ] );\r\n\r\n\t\t\t\t_tempVector.copy( _unit[ axis ] );\r\n\r\n\t\t\t\tif ( space === 'local' ) {\r\n\r\n\t\t\t\t\t_tempVector.applyQuaternion( this.worldQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.rotationAngle = this._offset.dot( _tempVector.cross( this.eye ).normalize() ) * ROTATION_SPEED;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Apply rotation snap\r\n\r\n\t\t\tif ( this.rotationSnap ) this.rotationAngle = Math.round( this.rotationAngle / this.rotationSnap ) * this.rotationSnap;\r\n\r\n\t\t\t// Apply rotate\r\n\t\t\tif ( space === 'local' && axis !== 'E' && axis !== 'XYZE' ) {\r\n\r\n\t\t\t\tobject.quaternion.copy( this._quaternionStart );\r\n\t\t\t\tobject.quaternion.multiply( _tempQuaternion.setFromAxisAngle( this.rotationAxis, this.rotationAngle ) ).normalize();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.rotationAxis.applyQuaternion( this._parentQuaternionInv );\r\n\t\t\t\tobject.quaternion.copy( _tempQuaternion.setFromAxisAngle( this.rotationAxis, this.rotationAngle ) );\r\n\t\t\t\tobject.quaternion.multiply( this._quaternionStart ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tthis.dispatchEvent( _changeEvent );\r\n\t\tthis.dispatchEvent( _objectChangeEvent );\r\n\r\n\t}\r\n\r\n\tpointerUp( pointer ) {\r\n\r\n\t\tif ( pointer.button !== 0 ) return;\r\n\r\n\t\tif ( this.dragging && ( this.axis !== null ) ) {\r\n\r\n\t\t\t_mouseUpEvent.mode = this.mode;\r\n\t\t\tthis.dispatchEvent( _mouseUpEvent );\r\n\r\n\t\t}\r\n\r\n\t\tthis.dragging = false;\r\n\t\tthis.axis = null;\r\n\r\n\t}\r\n\r\n\tdispose() {\r\n\r\n\t\tthis.domElement.removeEventListener( 'pointerdown', this._onPointerDown );\r\n\t\tthis.domElement.removeEventListener( 'pointermove', this._onPointerHover );\r\n\t\tthis.domElement.removeEventListener( 'pointermove', this._onPointerMove );\r\n\t\tthis.domElement.removeEventListener( 'pointerup', this._onPointerUp );\r\n\r\n\t\tthis.traverse( function ( child ) {\r\n\r\n\t\t\tif ( child.geometry ) child.geometry.dispose();\r\n\t\t\tif ( child.material ) child.material.dispose();\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t// Set current object\r\n\tattach( object ) {\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.visible = true;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\t// Detatch from object\r\n\tdetach() {\r\n\r\n\t\tthis.object = undefined;\r\n\t\tthis.visible = false;\r\n\t\tthis.axis = null;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n\tgetRaycaster() {\r\n\r\n\t\treturn _raycaster;\r\n\r\n\t}\r\n\r\n\t// TODO: deprecate\r\n\r\n\tgetMode() {\r\n\r\n\t\treturn this.mode;\r\n\r\n\t}\r\n\r\n\tsetMode( mode ) {\r\n\r\n\t\tthis.mode = mode;\r\n\r\n\t}\r\n\r\n\tsetTranslationSnap( translationSnap ) {\r\n\r\n\t\tthis.translationSnap = translationSnap;\r\n\r\n\t}\r\n\r\n\tsetRotationSnap( rotationSnap ) {\r\n\r\n\t\tthis.rotationSnap = rotationSnap;\r\n\r\n\t}\r\n\r\n\tsetScaleSnap( scaleSnap ) {\r\n\r\n\t\tthis.scaleSnap = scaleSnap;\r\n\r\n\t}\r\n\r\n\tsetSize( size ) {\r\n\r\n\t\tthis.size = size;\r\n\r\n\t}\r\n\r\n\tsetSpace( space ) {\r\n\r\n\t\tthis.space = space;\r\n\r\n\t}\r\n\r\n\tupdate() {\r\n\r\n\t\tconsole.warn( 'THREE.TransformControls: update function has no more functionality and therefore has been deprecated.' );\r\n\r\n\t}\r\n\r\n}\r\n\r\nTransformControls.prototype.isTransformControls = true;\r\n\r\n// mouse / touch event handlers\r\n\r\nfunction getPointer( event ) {\r\n\r\n\tif ( this.domElement.ownerDocument.pointerLockElement ) {\r\n\r\n\t\treturn {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tbutton: event.button\r\n\t\t};\r\n\r\n\t} else {\r\n\r\n\t\tconst rect = this.domElement.getBoundingClientRect();\r\n\r\n\t\treturn {\r\n\t\t\tx: ( event.clientX - rect.left ) / rect.width * 2 - 1,\r\n\t\t\ty: - ( event.clientY - rect.top ) / rect.height * 2 + 1,\r\n\t\t\tbutton: event.button\r\n\t\t};\r\n\r\n\t}\r\n\r\n}\r\n\r\nfunction onPointerHover( event ) {\r\n\r\n\tif ( ! this.enabled ) return;\r\n\r\n\tswitch ( event.pointerType ) {\r\n\r\n\t\tcase 'mouse':\r\n\t\tcase 'pen':\r\n\t\t\tthis.pointerHover( this._getPointer( event ) );\r\n\t\t\tbreak;\r\n\r\n\t}\r\n\r\n}\r\n\r\nfunction onPointerDown( event ) {\r\n\r\n\tif ( ! this.enabled ) return;\r\n\r\n\tthis.domElement.setPointerCapture( event.pointerId );\r\n\r\n\tthis.domElement.addEventListener( 'pointermove', this._onPointerMove );\r\n\r\n\tthis.pointerHover( this._getPointer( event ) );\r\n\tthis.pointerDown( this._getPointer( event ) );\r\n\r\n}\r\n\r\nfunction onPointerMove( event ) {\r\n\r\n\tif ( ! this.enabled ) return;\r\n\r\n\tthis.pointerMove( this._getPointer( event ) );\r\n\r\n}\r\n\r\nfunction onPointerUp( event ) {\r\n\r\n\tif ( ! this.enabled ) return;\r\n\r\n\tthis.domElement.releasePointerCapture( event.pointerId );\r\n\r\n\tthis.domElement.removeEventListener( 'pointermove', this._onPointerMove );\r\n\r\n\tthis.pointerUp( this._getPointer( event ) );\r\n\r\n}\r\n\r\nfunction intersectObjectWithRay( object, raycaster, includeInvisible ) {\r\n\r\n\tconst allIntersections = raycaster.intersectObject( object, true );\r\n\r\n\tfor ( let i = 0; i < allIntersections.length; i ++ ) {\r\n\r\n\t\tif ( allIntersections[ i ].object.visible || includeInvisible ) {\r\n\r\n\t\t\treturn allIntersections[ i ];\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn false;\r\n\r\n}\r\n\r\n//\r\n\r\n// Reusable utility variables\r\n\r\nconst _tempEuler = new Euler();\r\nconst _alignVector = new Vector3( 0, 1, 0 );\r\nconst _zeroVector = new Vector3( 0, 0, 0 );\r\nconst _lookAtMatrix = new Matrix4();\r\nconst _tempQuaternion2 = new Quaternion();\r\nconst _identityQuaternion = new Quaternion();\r\nconst _dirVector = new Vector3();\r\nconst _tempMatrix = new Matrix4();\r\n\r\nconst _unitX = new Vector3( 1, 0, 0 );\r\nconst _unitY = new Vector3( 0, 1, 0 );\r\nconst _unitZ = new Vector3( 0, 0, 1 );\r\n\r\nconst _v1 = new Vector3();\r\nconst _v2 = new Vector3();\r\nconst _v3 = new Vector3();\r\n\r\nclass TransformControlsGizmo extends Object3D {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.type = 'TransformControlsGizmo';\r\n\r\n\t\t// shared materials\r\n\r\n\t\tconst gizmoMaterial = new MeshBasicMaterial( {\r\n\t\t\tdepthTest: false,\r\n\t\t\tdepthWrite: false,\r\n\t\t\tfog: false,\r\n\t\t\ttoneMapped: false,\r\n\t\t\ttransparent: true\r\n\t\t} );\r\n\r\n\t\tconst gizmoLineMaterial = new LineBasicMaterial( {\r\n\t\t\tdepthTest: false,\r\n\t\t\tdepthWrite: false,\r\n\t\t\tfog: false,\r\n\t\t\ttoneMapped: false,\r\n\t\t\ttransparent: true\r\n\t\t} );\r\n\r\n\t\t// Make unique material for each axis/color\r\n\r\n\t\tconst matInvisible = gizmoMaterial.clone();\r\n\t\tmatInvisible.opacity = 0.15;\r\n\r\n\t\tconst matHelper = gizmoLineMaterial.clone();\r\n\t\tmatHelper.opacity = 0.5;\r\n\r\n\t\tconst matRed = gizmoMaterial.clone();\r\n\t\tmatRed.color.setHex( 0xff0000 );\r\n\r\n\t\tconst matGreen = gizmoMaterial.clone();\r\n\t\tmatGreen.color.setHex( 0x00ff00 );\r\n\r\n\t\tconst matBlue = gizmoMaterial.clone();\r\n\t\tmatBlue.color.setHex( 0x0000ff );\r\n\r\n\t\tconst matRedTransparent = gizmoMaterial.clone();\r\n\t\tmatRedTransparent.color.setHex( 0xff0000 );\r\n\t\tmatRedTransparent.opacity = 0.5;\r\n\r\n\t\tconst matGreenTransparent = gizmoMaterial.clone();\r\n\t\tmatGreenTransparent.color.setHex( 0x00ff00 );\r\n\t\tmatGreenTransparent.opacity = 0.5;\r\n\r\n\t\tconst matBlueTransparent = gizmoMaterial.clone();\r\n\t\tmatBlueTransparent.color.setHex( 0x0000ff );\r\n\t\tmatBlueTransparent.opacity = 0.5;\r\n\r\n\t\tconst matWhiteTransparent = gizmoMaterial.clone();\r\n\t\tmatWhiteTransparent.opacity = 0.25;\r\n\r\n\t\tconst matYellowTransparent = gizmoMaterial.clone();\r\n\t\tmatYellowTransparent.color.setHex( 0xffff00 );\r\n\t\tmatYellowTransparent.opacity = 0.25;\r\n\r\n\t\tconst matYellow = gizmoMaterial.clone();\r\n\t\tmatYellow.color.setHex( 0xffff00 );\r\n\r\n\t\tconst matGray = gizmoMaterial.clone();\r\n\t\tmatGray.color.setHex( 0x787878 );\r\n\r\n\t\t// reusable geometry\r\n\r\n\t\tconst arrowGeometry = new CylinderGeometry( 0, 0.04, 0.1, 12 );\r\n\t\tarrowGeometry.translate( 0, 0.05, 0 );\r\n\r\n\t\tconst scaleHandleGeometry = new BoxGeometry( 0.08, 0.08, 0.08 );\r\n\t\tscaleHandleGeometry.translate( 0, 0.04, 0 );\r\n\r\n\t\tconst lineGeometry = new BufferGeometry();\r\n\t\tlineGeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0,\t1, 0, 0 ], 3 ) );\r\n\r\n\t\tconst lineGeometry2 = new CylinderGeometry( 0.0075, 0.0075, 0.5, 3 );\r\n\t\tlineGeometry2.translate( 0, 0.25, 0 );\r\n\r\n\t\tfunction CircleGeometry( radius, arc ) {\r\n\r\n\t\t\tconst geometry = new TorusGeometry( radius, 0.0075, 3, 64, arc * Math.PI * 2 );\r\n\t\t\tgeometry.rotateY( Math.PI / 2 );\r\n\t\t\tgeometry.rotateX( Math.PI / 2 );\r\n\t\t\treturn geometry;\r\n\r\n\t\t}\r\n\r\n\t\t// Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\r\n\r\n\t\tfunction TranslateHelperGeometry() {\r\n\r\n\t\t\tconst geometry = new BufferGeometry();\r\n\r\n\t\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 1, 1, 1 ], 3 ) );\r\n\r\n\t\t\treturn geometry;\r\n\r\n\t\t}\r\n\r\n\t\t// Gizmo definitions - custom hierarchy definitions for setupGizmo() function\r\n\r\n\t\tconst gizmoTranslate = {\r\n\t\t\tX: [\r\n\t\t\t\t[ new Mesh( arrowGeometry, matRed ), [ 0.5, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\r\n\t\t\t\t[ new Mesh( arrowGeometry, matRed ), [ - 0.5, 0, 0 ], [ 0, 0, Math.PI / 2 ]],\r\n\t\t\t\t[ new Mesh( lineGeometry2, matRed ), [ 0, 0, 0 ], [ 0, 0, - Math.PI / 2 ]]\r\n\t\t\t],\r\n\t\t\tY: [\r\n\t\t\t\t[ new Mesh( arrowGeometry, matGreen ), [ 0, 0.5, 0 ]],\r\n\t\t\t\t[ new Mesh( arrowGeometry, matGreen ), [ 0, - 0.5, 0 ], [ Math.PI, 0, 0 ]],\r\n\t\t\t\t[ new Mesh( lineGeometry2, matGreen ) ]\r\n\t\t\t],\r\n\t\t\tZ: [\r\n\t\t\t\t[ new Mesh( arrowGeometry, matBlue ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ]],\r\n\t\t\t\t[ new Mesh( arrowGeometry, matBlue ), [ 0, 0, - 0.5 ], [ - Math.PI / 2, 0, 0 ]],\r\n\t\t\t\t[ new Mesh( lineGeometry2, matBlue ), null, [ Math.PI / 2, 0, 0 ]]\r\n\t\t\t],\r\n\t\t\tXYZ: [\r\n\t\t\t\t[ new Mesh( new OctahedronGeometry( 0.1, 0 ), matWhiteTransparent.clone() ), [ 0, 0, 0 ]]\r\n\t\t\t],\r\n\t\t\tXY: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.15, 0.15, 0.01 ), matBlueTransparent.clone() ), [ 0.15, 0.15, 0 ]]\r\n\t\t\t],\r\n\t\t\tYZ: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.15, 0.15, 0.01 ), matRedTransparent.clone() ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ]]\r\n\t\t\t],\r\n\t\t\tXZ: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.15, 0.15, 0.01 ), matGreenTransparent.clone() ), [ 0.15, 0, 0.15 ], [ - Math.PI / 2, 0, 0 ]]\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\tconst pickerTranslate = {\r\n\t\t\tX: [\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ 0.3, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ - 0.3, 0, 0 ], [ 0, 0, Math.PI / 2 ]]\r\n\t\t\t],\r\n\t\t\tY: [\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ 0, 0.3, 0 ]],\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ 0, - 0.3, 0 ], [ 0, 0, Math.PI ]]\r\n\t\t\t],\r\n\t\t\tZ: [\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ 0, 0, 0.3 ], [ Math.PI / 2, 0, 0 ]],\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ 0, 0, - 0.3 ], [ - Math.PI / 2, 0, 0 ]]\r\n\t\t\t],\r\n\t\t\tXYZ: [\r\n\t\t\t\t[ new Mesh( new OctahedronGeometry( 0.2, 0 ), matInvisible ) ]\r\n\t\t\t],\r\n\t\t\tXY: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.2, 0.2, 0.01 ), matInvisible ), [ 0.15, 0.15, 0 ]]\r\n\t\t\t],\r\n\t\t\tYZ: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.2, 0.2, 0.01 ), matInvisible ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ]]\r\n\t\t\t],\r\n\t\t\tXZ: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.2, 0.2, 0.01 ), matInvisible ), [ 0.15, 0, 0.15 ], [ - Math.PI / 2, 0, 0 ]]\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\tconst helperTranslate = {\r\n\t\t\tSTART: [\r\n\t\t\t\t[ new Mesh( new OctahedronGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\r\n\t\t\t],\r\n\t\t\tEND: [\r\n\t\t\t\t[ new Mesh( new OctahedronGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\r\n\t\t\t],\r\n\t\t\tDELTA: [\r\n\t\t\t\t[ new Line( TranslateHelperGeometry(), matHelper ), null, null, null, 'helper' ]\r\n\t\t\t],\r\n\t\t\tX: [\r\n\t\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t\t],\r\n\t\t\tY: [\r\n\t\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t\t],\r\n\t\t\tZ: [\r\n\t\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\tconst gizmoRotate = {\r\n\t\t\tXYZE: [\r\n\t\t\t\t[ new Mesh( CircleGeometry( 0.5, 1 ), matGray ), null, [ 0, Math.PI / 2, 0 ]]\r\n\t\t\t],\r\n\t\t\tX: [\r\n\t\t\t\t[ new Mesh( CircleGeometry( 0.5, 0.5 ), matRed ) ]\r\n\t\t\t],\r\n\t\t\tY: [\r\n\t\t\t\t[ new Mesh( CircleGeometry( 0.5, 0.5 ), matGreen ), null, [ 0, 0, - Math.PI / 2 ]]\r\n\t\t\t],\r\n\t\t\tZ: [\r\n\t\t\t\t[ new Mesh( CircleGeometry( 0.5, 0.5 ), matBlue ), null, [ 0, Math.PI / 2, 0 ]]\r\n\t\t\t],\r\n\t\t\tE: [\r\n\t\t\t\t[ new Mesh( CircleGeometry( 0.75, 1 ), matYellowTransparent ), null, [ 0, Math.PI / 2, 0 ]]\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\tconst helperRotate = {\r\n\t\t\tAXIS: [\r\n\t\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\tconst pickerRotate = {\r\n\t\t\tXYZE: [\r\n\t\t\t\t[ new Mesh( new SphereGeometry( 0.25, 10, 8 ), matInvisible ) ]\r\n\t\t\t],\r\n\t\t\tX: [\r\n\t\t\t\t[ new Mesh( new TorusGeometry( 0.5, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, - Math.PI / 2, - Math.PI / 2 ]],\r\n\t\t\t],\r\n\t\t\tY: [\r\n\t\t\t\t[ new Mesh( new TorusGeometry( 0.5, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ]],\r\n\t\t\t],\r\n\t\t\tZ: [\r\n\t\t\t\t[ new Mesh( new TorusGeometry( 0.5, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\r\n\t\t\t],\r\n\t\t\tE: [\r\n\t\t\t\t[ new Mesh( new TorusGeometry( 0.75, 0.1, 2, 24 ), matInvisible ) ]\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\tconst gizmoScale = {\r\n\t\t\tX: [\r\n\t\t\t\t[ new Mesh( scaleHandleGeometry, matRed ), [ 0.5, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\r\n\t\t\t\t[ new Mesh( lineGeometry2, matRed ), [ 0, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\r\n\t\t\t\t[ new Mesh( scaleHandleGeometry, matRed ), [ - 0.5, 0, 0 ], [ 0, 0, Math.PI / 2 ]],\r\n\t\t\t],\r\n\t\t\tY: [\r\n\t\t\t\t[ new Mesh( scaleHandleGeometry, matGreen ), [ 0, 0.5, 0 ]],\r\n\t\t\t\t[ new Mesh( lineGeometry2, matGreen ) ],\r\n\t\t\t\t[ new Mesh( scaleHandleGeometry, matGreen ), [ 0, - 0.5, 0 ], [ 0, 0, Math.PI ]],\r\n\t\t\t],\r\n\t\t\tZ: [\r\n\t\t\t\t[ new Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ]],\r\n\t\t\t\t[ new Mesh( lineGeometry2, matBlue ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ]],\r\n\t\t\t\t[ new Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, - 0.5 ], [ - Math.PI / 2, 0, 0 ]]\r\n\t\t\t],\r\n\t\t\tXY: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.15, 0.15, 0.01 ), matBlueTransparent ), [ 0.15, 0.15, 0 ]]\r\n\t\t\t],\r\n\t\t\tYZ: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.15, 0.15, 0.01 ), matRedTransparent ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ]]\r\n\t\t\t],\r\n\t\t\tXZ: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.15, 0.15, 0.01 ), matGreenTransparent ), [ 0.15, 0, 0.15 ], [ - Math.PI / 2, 0, 0 ]]\r\n\t\t\t],\r\n\t\t\tXYZ: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.1, 0.1, 0.1 ), matWhiteTransparent.clone() ) ],\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\tconst pickerScale = {\r\n\t\t\tX: [\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ 0.3, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ - 0.3, 0, 0 ], [ 0, 0, Math.PI / 2 ]]\r\n\t\t\t],\r\n\t\t\tY: [\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ 0, 0.3, 0 ]],\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ 0, - 0.3, 0 ], [ 0, 0, Math.PI ]]\r\n\t\t\t],\r\n\t\t\tZ: [\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ 0, 0, 0.3 ], [ Math.PI / 2, 0, 0 ]],\r\n\t\t\t\t[ new Mesh( new CylinderGeometry( 0.2, 0, 0.6, 4 ), matInvisible ), [ 0, 0, - 0.3 ], [ - Math.PI / 2, 0, 0 ]]\r\n\t\t\t],\r\n\t\t\tXY: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.2, 0.2, 0.01 ), matInvisible ), [ 0.15, 0.15, 0 ]],\r\n\t\t\t],\r\n\t\t\tYZ: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.2, 0.2, 0.01 ), matInvisible ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ]],\r\n\t\t\t],\r\n\t\t\tXZ: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.2, 0.2, 0.01 ), matInvisible ), [ 0.15, 0, 0.15 ], [ - Math.PI / 2, 0, 0 ]],\r\n\t\t\t],\r\n\t\t\tXYZ: [\r\n\t\t\t\t[ new Mesh( new BoxGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 0, 0 ]],\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\tconst helperScale = {\r\n\t\t\tX: [\r\n\t\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t\t],\r\n\t\t\tY: [\r\n\t\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t\t],\r\n\t\t\tZ: [\r\n\t\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t\t// Creates an Object3D with gizmos described in custom hierarchy definition.\r\n\r\n\t\tfunction setupGizmo( gizmoMap ) {\r\n\r\n\t\t\tconst gizmo = new Object3D();\r\n\r\n\t\t\tfor ( const name in gizmoMap ) {\r\n\r\n\t\t\t\tfor ( let i = gizmoMap[ name ].length; i --; ) {\r\n\r\n\t\t\t\t\tconst object = gizmoMap[ name ][ i ][ 0 ].clone();\r\n\t\t\t\t\tconst position = gizmoMap[ name ][ i ][ 1 ];\r\n\t\t\t\t\tconst rotation = gizmoMap[ name ][ i ][ 2 ];\r\n\t\t\t\t\tconst scale = gizmoMap[ name ][ i ][ 3 ];\r\n\t\t\t\t\tconst tag = gizmoMap[ name ][ i ][ 4 ];\r\n\r\n\t\t\t\t\t// name and tag properties are essential for picking and updating logic.\r\n\t\t\t\t\tobject.name = name;\r\n\t\t\t\t\tobject.tag = tag;\r\n\r\n\t\t\t\t\tif ( position ) {\r\n\r\n\t\t\t\t\t\tobject.position.set( position[ 0 ], position[ 1 ], position[ 2 ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( rotation ) {\r\n\r\n\t\t\t\t\t\tobject.rotation.set( rotation[ 0 ], rotation[ 1 ], rotation[ 2 ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( scale ) {\r\n\r\n\t\t\t\t\t\tobject.scale.set( scale[ 0 ], scale[ 1 ], scale[ 2 ] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tobject.updateMatrix();\r\n\r\n\t\t\t\t\tconst tempGeometry = object.geometry.clone();\r\n\t\t\t\t\ttempGeometry.applyMatrix4( object.matrix );\r\n\t\t\t\t\tobject.geometry = tempGeometry;\r\n\t\t\t\t\tobject.renderOrder = Infinity;\r\n\r\n\t\t\t\t\tobject.position.set( 0, 0, 0 );\r\n\t\t\t\t\tobject.rotation.set( 0, 0, 0 );\r\n\t\t\t\t\tobject.scale.set( 1, 1, 1 );\r\n\r\n\t\t\t\t\tgizmo.add( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn gizmo;\r\n\r\n\t\t}\r\n\r\n\t\t// Gizmo creation\r\n\r\n\t\tthis.gizmo = {};\r\n\t\tthis.picker = {};\r\n\t\tthis.helper = {};\r\n\r\n\t\tthis.add( this.gizmo[ 'translate' ] = setupGizmo( gizmoTranslate ) );\r\n\t\tthis.add( this.gizmo[ 'rotate' ] = setupGizmo( gizmoRotate ) );\r\n\t\tthis.add( this.gizmo[ 'scale' ] = setupGizmo( gizmoScale ) );\r\n\t\tthis.add( this.picker[ 'translate' ] = setupGizmo( pickerTranslate ) );\r\n\t\tthis.add( this.picker[ 'rotate' ] = setupGizmo( pickerRotate ) );\r\n\t\tthis.add( this.picker[ 'scale' ] = setupGizmo( pickerScale ) );\r\n\t\tthis.add( this.helper[ 'translate' ] = setupGizmo( helperTranslate ) );\r\n\t\tthis.add( this.helper[ 'rotate' ] = setupGizmo( helperRotate ) );\r\n\t\tthis.add( this.helper[ 'scale' ] = setupGizmo( helperScale ) );\r\n\r\n\t\t// Pickers should be hidden always\r\n\r\n\t\tthis.picker[ 'translate' ].visible = false;\r\n\t\tthis.picker[ 'rotate' ].visible = false;\r\n\t\tthis.picker[ 'scale' ].visible = false;\r\n\r\n\t}\r\n\r\n\t// updateMatrixWorld will update transformations and appearance of individual handles\r\n\r\n\tupdateMatrixWorld( force ) {\r\n\r\n\t\tconst space = ( this.mode === 'scale' ) ? 'local' : this.space; // scale always oriented to local rotation\r\n\r\n\t\tconst quaternion = ( space === 'local' ) ? this.worldQuaternion : _identityQuaternion;\r\n\r\n\t\t// Show only gizmos for current transform mode\r\n\r\n\t\tthis.gizmo[ 'translate' ].visible = this.mode === 'translate';\r\n\t\tthis.gizmo[ 'rotate' ].visible = this.mode === 'rotate';\r\n\t\tthis.gizmo[ 'scale' ].visible = this.mode === 'scale';\r\n\r\n\t\tthis.helper[ 'translate' ].visible = this.mode === 'translate';\r\n\t\tthis.helper[ 'rotate' ].visible = this.mode === 'rotate';\r\n\t\tthis.helper[ 'scale' ].visible = this.mode === 'scale';\r\n\r\n\r\n\t\tlet handles = [];\r\n\t\thandles = handles.concat( this.picker[ this.mode ].children );\r\n\t\thandles = handles.concat( this.gizmo[ this.mode ].children );\r\n\t\thandles = handles.concat( this.helper[ this.mode ].children );\r\n\r\n\t\tfor ( let i = 0; i < handles.length; i ++ ) {\r\n\r\n\t\t\tconst handle = handles[ i ];\r\n\r\n\t\t\t// hide aligned to camera\r\n\r\n\t\t\thandle.visible = true;\r\n\t\t\thandle.rotation.set( 0, 0, 0 );\r\n\t\t\thandle.position.copy( this.worldPosition );\r\n\r\n\t\t\tlet factor;\r\n\r\n\t\t\tif ( this.camera.isOrthographicCamera ) {\r\n\r\n\t\t\t\tfactor = ( this.camera.top - this.camera.bottom ) / this.camera.zoom;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfactor = this.worldPosition.distanceTo( this.cameraPosition ) * Math.min( 1.9 * Math.tan( Math.PI * this.camera.fov / 360 ) / this.camera.zoom, 7 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\thandle.scale.set( 1, 1, 1 ).multiplyScalar( factor * this.size / 4 );\r\n\r\n\t\t\t// TODO: simplify helpers and consider decoupling from gizmo\r\n\r\n\t\t\tif ( handle.tag === 'helper' ) {\r\n\r\n\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\tif ( handle.name === 'AXIS' ) {\r\n\r\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\r\n\t\t\t\t\thandle.visible = !! this.axis;\r\n\r\n\t\t\t\t\tif ( this.axis === 'X' ) {\r\n\r\n\t\t\t\t\t\t_tempQuaternion.setFromEuler( _tempEuler.set( 0, 0, 0 ) );\r\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( _tempQuaternion );\r\n\r\n\t\t\t\t\t\tif ( Math.abs( _alignVector.copy( _unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\r\n\r\n\t\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.axis === 'Y' ) {\r\n\r\n\t\t\t\t\t\t_tempQuaternion.setFromEuler( _tempEuler.set( 0, 0, Math.PI / 2 ) );\r\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( _tempQuaternion );\r\n\r\n\t\t\t\t\t\tif ( Math.abs( _alignVector.copy( _unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\r\n\r\n\t\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.axis === 'Z' ) {\r\n\r\n\t\t\t\t\t\t_tempQuaternion.setFromEuler( _tempEuler.set( 0, Math.PI / 2, 0 ) );\r\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( _tempQuaternion );\r\n\r\n\t\t\t\t\t\tif ( Math.abs( _alignVector.copy( _unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\r\n\r\n\t\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.axis === 'XYZE' ) {\r\n\r\n\t\t\t\t\t\t_tempQuaternion.setFromEuler( _tempEuler.set( 0, Math.PI / 2, 0 ) );\r\n\t\t\t\t\t\t_alignVector.copy( this.rotationAxis );\r\n\t\t\t\t\t\thandle.quaternion.setFromRotationMatrix( _lookAtMatrix.lookAt( _zeroVector, _alignVector, _unitY ) );\r\n\t\t\t\t\t\thandle.quaternion.multiply( _tempQuaternion );\r\n\t\t\t\t\t\thandle.visible = this.dragging;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.axis === 'E' ) {\r\n\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t} else if ( handle.name === 'START' ) {\r\n\r\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\r\n\t\t\t\t\thandle.visible = this.dragging;\r\n\r\n\t\t\t\t} else if ( handle.name === 'END' ) {\r\n\r\n\t\t\t\t\thandle.position.copy( this.worldPosition );\r\n\t\t\t\t\thandle.visible = this.dragging;\r\n\r\n\t\t\t\t} else if ( handle.name === 'DELTA' ) {\r\n\r\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\r\n\t\t\t\t\thandle.quaternion.copy( this.worldQuaternionStart );\r\n\t\t\t\t\t_tempVector.set( 1e-10, 1e-10, 1e-10 ).add( this.worldPositionStart ).sub( this.worldPosition ).multiplyScalar( - 1 );\r\n\t\t\t\t\t_tempVector.applyQuaternion( this.worldQuaternionStart.clone().invert() );\r\n\t\t\t\t\thandle.scale.copy( _tempVector );\r\n\t\t\t\t\thandle.visible = this.dragging;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\thandle.quaternion.copy( quaternion );\r\n\r\n\t\t\t\t\tif ( this.dragging ) {\r\n\r\n\t\t\t\t\t\thandle.position.copy( this.worldPositionStart );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\thandle.position.copy( this.worldPosition );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( this.axis ) {\r\n\r\n\t\t\t\t\t\thandle.visible = this.axis.search( handle.name ) !== - 1;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If updating helper, skip rest of the loop\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Align handles to current local or world rotation\r\n\r\n\t\t\thandle.quaternion.copy( quaternion );\r\n\r\n\t\t\tif ( this.mode === 'translate' || this.mode === 'scale' ) {\r\n\r\n\t\t\t\t// Hide translate and scale axis facing the camera\r\n\r\n\t\t\t\tconst AXIS_HIDE_TRESHOLD = 0.99;\r\n\t\t\t\tconst PLANE_HIDE_TRESHOLD = 0.2;\r\n\r\n\t\t\t\tif ( handle.name === 'X' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( _alignVector.copy( _unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'Y' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( _alignVector.copy( _unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'Z' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( _alignVector.copy( _unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'XY' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( _alignVector.copy( _unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'YZ' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( _alignVector.copy( _unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'XZ' ) {\r\n\r\n\t\t\t\t\tif ( Math.abs( _alignVector.copy( _unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\r\n\r\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\r\n\t\t\t\t\t\thandle.visible = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( this.mode === 'rotate' ) {\r\n\r\n\t\t\t\t// Align handles to current local or world rotation\r\n\r\n\t\t\t\t_tempQuaternion2.copy( quaternion );\r\n\t\t\t\t_alignVector.copy( this.eye ).applyQuaternion( _tempQuaternion.copy( quaternion ).invert() );\r\n\r\n\t\t\t\tif ( handle.name.search( 'E' ) !== - 1 ) {\r\n\r\n\t\t\t\t\thandle.quaternion.setFromRotationMatrix( _lookAtMatrix.lookAt( this.eye, _zeroVector, _unitY ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'X' ) {\r\n\r\n\t\t\t\t\t_tempQuaternion.setFromAxisAngle( _unitX, Math.atan2( - _alignVector.y, _alignVector.z ) );\r\n\t\t\t\t\t_tempQuaternion.multiplyQuaternions( _tempQuaternion2, _tempQuaternion );\r\n\t\t\t\t\thandle.quaternion.copy( _tempQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'Y' ) {\r\n\r\n\t\t\t\t\t_tempQuaternion.setFromAxisAngle( _unitY, Math.atan2( _alignVector.x, _alignVector.z ) );\r\n\t\t\t\t\t_tempQuaternion.multiplyQuaternions( _tempQuaternion2, _tempQuaternion );\r\n\t\t\t\t\thandle.quaternion.copy( _tempQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( handle.name === 'Z' ) {\r\n\r\n\t\t\t\t\t_tempQuaternion.setFromAxisAngle( _unitZ, Math.atan2( _alignVector.y, _alignVector.x ) );\r\n\t\t\t\t\t_tempQuaternion.multiplyQuaternions( _tempQuaternion2, _tempQuaternion );\r\n\t\t\t\t\thandle.quaternion.copy( _tempQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Hide disabled axes\r\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( 'X' ) === - 1 || this.showX );\r\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( 'Y' ) === - 1 || this.showY );\r\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( 'Z' ) === - 1 || this.showZ );\r\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( 'E' ) === - 1 || ( this.showX && this.showY && this.showZ ) );\r\n\r\n\t\t\t// highlight selected axis\r\n\r\n\t\t\thandle.material._color = handle.material._color || handle.material.color.clone();\r\n\t\t\thandle.material._opacity = handle.material._opacity || handle.material.opacity;\r\n\r\n\t\t\thandle.material.color.copy( handle.material._color );\r\n\t\t\thandle.material.opacity = handle.material._opacity;\r\n\r\n\t\t\tif ( this.enabled && this.axis ) {\r\n\r\n\t\t\t\tif ( handle.name === this.axis ) {\r\n\r\n\t\t\t\t\thandle.material.color.setHex( 0xffff00 );\r\n\t\t\t\t\thandle.material.opacity = 1.0;\r\n\r\n\t\t\t\t} else if ( this.axis.split( '' ).some( function ( a ) {\r\n\r\n\t\t\t\t\treturn handle.name === a;\r\n\r\n\t\t\t\t} ) ) {\r\n\r\n\t\t\t\t\thandle.material.color.setHex( 0xffff00 );\r\n\t\t\t\t\thandle.material.opacity = 1.0;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tsuper.updateMatrixWorld( force );\r\n\r\n\t}\r\n\r\n}\r\n\r\nTransformControlsGizmo.prototype.isTransformControlsGizmo = true;\r\n\r\n//\r\n\r\nclass TransformControlsPlane extends Mesh {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper(\r\n\t\t\tnew PlaneGeometry( 100000, 100000, 2, 2 ),\r\n\t\t\tnew MeshBasicMaterial( { visible: false, wireframe: true, side: DoubleSide, transparent: true, opacity: 0.1, toneMapped: false } )\r\n\t\t);\r\n\r\n\t\tthis.type = 'TransformControlsPlane';\r\n\r\n\t}\r\n\r\n\tupdateMatrixWorld( force ) {\r\n\r\n\t\tlet space = this.space;\r\n\r\n\t\tthis.position.copy( this.worldPosition );\r\n\r\n\t\tif ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\r\n\r\n\t\t_v1.copy( _unitX ).applyQuaternion( space === 'local' ? this.worldQuaternion : _identityQuaternion );\r\n\t\t_v2.copy( _unitY ).applyQuaternion( space === 'local' ? this.worldQuaternion : _identityQuaternion );\r\n\t\t_v3.copy( _unitZ ).applyQuaternion( space === 'local' ? this.worldQuaternion : _identityQuaternion );\r\n\r\n\t\t// Align the plane for current transform mode, axis and space.\r\n\r\n\t\t_alignVector.copy( _v2 );\r\n\r\n\t\tswitch ( this.mode ) {\r\n\r\n\t\t\tcase 'translate':\r\n\t\t\tcase 'scale':\r\n\t\t\t\tswitch ( this.axis ) {\r\n\r\n\t\t\t\t\tcase 'X':\r\n\t\t\t\t\t\t_alignVector.copy( this.eye ).cross( _v1 );\r\n\t\t\t\t\t\t_dirVector.copy( _v1 ).cross( _alignVector );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'Y':\r\n\t\t\t\t\t\t_alignVector.copy( this.eye ).cross( _v2 );\r\n\t\t\t\t\t\t_dirVector.copy( _v2 ).cross( _alignVector );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'Z':\r\n\t\t\t\t\t\t_alignVector.copy( this.eye ).cross( _v3 );\r\n\t\t\t\t\t\t_dirVector.copy( _v3 ).cross( _alignVector );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'XY':\r\n\t\t\t\t\t\t_dirVector.copy( _v3 );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'YZ':\r\n\t\t\t\t\t\t_dirVector.copy( _v1 );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'XZ':\r\n\t\t\t\t\t\t_alignVector.copy( _v3 );\r\n\t\t\t\t\t\t_dirVector.copy( _v2 );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'XYZ':\r\n\t\t\t\t\tcase 'E':\r\n\t\t\t\t\t\t_dirVector.set( 0, 0, 0 );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'rotate':\r\n\t\t\tdefault:\r\n\t\t\t\t// special case for rotate\r\n\t\t\t\t_dirVector.set( 0, 0, 0 );\r\n\r\n\t\t}\r\n\r\n\t\tif ( _dirVector.length() === 0 ) {\r\n\r\n\t\t\t// If in rotate mode, make the plane parallel to camera\r\n\t\t\tthis.quaternion.copy( this.cameraQuaternion );\r\n\r\n\t\t} else {\r\n\r\n\t\t\t_tempMatrix.lookAt( _tempVector.set( 0, 0, 0 ), _dirVector, _alignVector );\r\n\r\n\t\t\tthis.quaternion.setFromRotationMatrix( _tempMatrix );\r\n\r\n\t\t}\r\n\r\n\t\tsuper.updateMatrixWorld( force );\r\n\r\n\t}\r\n\r\n}\r\n\r\nTransformControlsPlane.prototype.isTransformControlsPlane = true;\r\n\r\nexport { TransformControls, TransformControlsGizmo, TransformControlsPlane };\r\n","import * as THREE from 'three'\r\n\r\nfunction EditorControls( object, domElement ) {\r\n\r\n\t// API\r\n\r\n\tthis.enabled = true;\r\n\tthis.center = new THREE.Vector3();\r\n\tthis.panSpeed = 0.002;\r\n\tthis.zoomSpeed = 0.1;\r\n\tthis.rotationSpeed = 0.005;\r\n\r\n\t// internals\r\n\r\n\tvar scope = this;\r\n\tvar vector = new THREE.Vector3();\r\n\tvar delta = new THREE.Vector3();\r\n\tvar box = new THREE.Box3();\r\n\r\n\tvar STATE = { NONE: - 1, ROTATE: 0, ZOOM: 1, PAN: 2 };\r\n\tvar state = STATE.NONE;\r\n\r\n\tvar center = this.center;\r\n\tvar normalMatrix = new THREE.Matrix3();\r\n\tvar pointer = new THREE.Vector2();\r\n\tvar pointerOld = new THREE.Vector2();\r\n\tvar spherical = new THREE.Spherical();\r\n\tvar sphere = new THREE.Sphere();\r\n\r\n\t// events\r\n\r\n\tvar changeEvent = { type: 'change' };\r\n\r\n\tthis.focus = function ( target ) {\r\n\r\n\t\tvar distance;\r\n\r\n\t\tbox.setFromObject( target );\r\n\r\n\t\tif ( box.isEmpty() === false ) {\r\n\r\n\t\t\tbox.getCenter( center );\r\n\t\t\tdistance = box.getBoundingSphere( sphere ).radius;\r\n\r\n\t\t} else {\r\n\r\n\t\t\t// Focusing on an Group, AmbientLight, etc\r\n\r\n\t\t\tcenter.setFromMatrixPosition( target.matrixWorld );\r\n\t\t\tdistance = 0.1;\r\n\r\n\t\t}\r\n\r\n\t\tdelta.set( 0, 0, 1 );\r\n\t\tdelta.applyQuaternion( object.quaternion );\r\n\t\tdelta.multiplyScalar( distance * 4 );\r\n\r\n\t\tobject.position.copy( center ).add( delta );\r\n\r\n\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t};\r\n\r\n\tthis.pan = function ( delta ) {\r\n\r\n\t\tvar distance = object.position.distanceTo( center );\r\n\r\n\t\tdelta.multiplyScalar( distance * scope.panSpeed );\r\n\t\tdelta.applyMatrix3( normalMatrix.getNormalMatrix( object.matrix ) );\r\n\r\n\t\tobject.position.add( delta );\r\n\t\tcenter.add( delta );\r\n\r\n\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t};\r\n\r\n\tthis.zoom = function ( delta ) {\r\n\r\n\t\tvar distance = object.position.distanceTo( center );\r\n\r\n\t\tdelta.multiplyScalar( distance * scope.zoomSpeed );\r\n\r\n\t\tif ( delta.length() > distance ) return;\r\n\r\n\t\tdelta.applyMatrix3( normalMatrix.getNormalMatrix( object.matrix ) );\r\n\r\n\t\tobject.position.add( delta );\r\n\r\n\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t};\r\n\r\n\tthis.rotate = function ( delta ) {\r\n\r\n\t\tvector.copy( object.position ).sub( center );\r\n\r\n\t\tspherical.setFromVector3( vector );\r\n\r\n\t\tspherical.theta += delta.x * scope.rotationSpeed;\r\n\t\tspherical.phi += delta.y * scope.rotationSpeed;\r\n\r\n\t\tspherical.makeSafe();\r\n\r\n\t\tvector.setFromSpherical( spherical );\r\n\r\n\t\tobject.position.copy( center ).add( vector );\r\n\r\n\t\tobject.lookAt( center );\r\n\r\n\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t};\r\n\r\n\t//\r\n\r\n\tfunction onPointerDown( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tswitch ( event.pointerType ) {\r\n\r\n\t\t\tcase 'mouse':\r\n\t\t\tcase 'pen':\r\n\t\t\t\tonMouseDown( event );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t// TODO touch\r\n\r\n\t\t}\r\n\r\n\t\tdomElement.ownerDocument.addEventListener( 'pointermove', onPointerMove, false );\r\n\t\tdomElement.ownerDocument.addEventListener( 'pointerup', onPointerUp, false );\r\n\r\n\t}\r\n\r\n\tfunction onPointerMove( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tswitch ( event.pointerType ) {\r\n\r\n\t\t\tcase 'mouse':\r\n\t\t\tcase 'pen':\r\n\t\t\t\tonMouseMove( event );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t// TODO touch\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onPointerUp( event ) {\r\n\r\n\t\tswitch ( event.pointerType ) {\r\n\r\n\t\t\tcase 'mouse':\r\n\t\t\tcase 'pen':\r\n\t\t\t\tonMouseUp();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t// TODO touch\r\n\r\n\t\t}\r\n\r\n\t\tdomElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove, false );\r\n\t\tdomElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp, false );\r\n\r\n\t}\r\n\r\n\t// mouse\r\n\r\n\tfunction onMouseDown( event ) {\r\n\r\n\t\tif ( event.button === 0 ) {\r\n\r\n\t\t\tstate = STATE.ROTATE;\r\n\r\n\t\t} else if ( event.button === 1 ) {\r\n\r\n\t\t\tstate = STATE.ZOOM;\r\n\r\n\t\t} else if ( event.button === 2 ) {\r\n\r\n\t\t\tstate = STATE.PAN;\r\n\r\n\t\t}\r\n\r\n\t\tpointerOld.set( event.clientX, event.clientY );\r\n\r\n\t}\r\n\r\n\tfunction onMouseMove( event ) {\r\n\r\n\t\tpointer.set( event.clientX, event.clientY );\r\n\r\n\t\tvar movementX = pointer.x - pointerOld.x;\r\n\t\tvar movementY = pointer.y - pointerOld.y;\r\n\r\n\t\tif ( state === STATE.ROTATE ) {\r\n\r\n\t\t\tscope.rotate( delta.set( - movementX, - movementY, 0 ) );\r\n\r\n\t\t} else if ( state === STATE.ZOOM ) {\r\n\r\n\t\t\tscope.zoom( delta.set( 0, 0, movementY ) );\r\n\r\n\t\t} else if ( state === STATE.PAN ) {\r\n\r\n\t\t\tscope.pan( delta.set( - movementX, movementY, 0 ) );\r\n\r\n\t\t}\r\n\r\n\t\tpointerOld.set( event.clientX, event.clientY );\r\n\r\n\t}\r\n\r\n\tfunction onMouseUp() {\r\n\r\n\t\tstate = STATE.NONE;\r\n\r\n\t}\r\n\r\n\tfunction onMouseWheel( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\t// Normalize deltaY due to https://bugzilla.mozilla.org/show_bug.cgi?id=1392460\r\n\t\tscope.zoom( delta.set( 0, 0, event.deltaY > 0 ? 1 : - 1 ) );\r\n\r\n\t}\r\n\r\n\tfunction contextmenu( event ) {\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t}\r\n\r\n\tthis.dispose = function () {\r\n\r\n\t\tdomElement.removeEventListener( 'contextmenu', contextmenu, false );\r\n\t\tdomElement.removeEventListener( 'dblclick', onMouseUp, false );\r\n\t\tdomElement.removeEventListener( 'wheel', onMouseWheel, false );\r\n\r\n\t\tdomElement.removeEventListener( 'pointerdown', onPointerDown, false );\r\n\r\n\t\tdomElement.removeEventListener( 'touchstart', touchStart, false );\r\n\t\tdomElement.removeEventListener( 'touchmove', touchMove, false );\r\n\r\n\t};\r\n\r\n\tdomElement.addEventListener( 'contextmenu', contextmenu, false );\r\n\tdomElement.addEventListener( 'dblclick', onMouseUp, false );\r\n\tdomElement.addEventListener( 'wheel', onMouseWheel, false );\r\n\r\n\tdomElement.addEventListener( 'pointerdown', onPointerDown, false );\r\n\r\n\t// touch\r\n\r\n\tvar touches = [ new THREE.Vector3(), new THREE.Vector3(), new THREE.Vector3() ];\r\n\tvar prevTouches = [ new THREE.Vector3(), new THREE.Vector3(), new THREE.Vector3() ];\r\n\r\n\tvar prevDistance = null;\r\n\r\n\tfunction touchStart( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tswitch ( event.touches.length ) {\r\n\r\n\t\t\tcase 1:\r\n\t\t\t\ttouches[ 0 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 ).divideScalar( window.devicePixelRatio );\r\n\t\t\t\ttouches[ 1 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 ).divideScalar( window.devicePixelRatio );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 2:\r\n\t\t\t\ttouches[ 0 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 ).divideScalar( window.devicePixelRatio );\r\n\t\t\t\ttouches[ 1 ].set( event.touches[ 1 ].pageX, event.touches[ 1 ].pageY, 0 ).divideScalar( window.devicePixelRatio );\r\n\t\t\t\tprevDistance = touches[ 0 ].distanceTo( touches[ 1 ] );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tprevTouches[ 0 ].copy( touches[ 0 ] );\r\n\t\tprevTouches[ 1 ].copy( touches[ 1 ] );\r\n\r\n\t}\r\n\r\n\r\n\tfunction touchMove( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tfunction getClosest( touch, touches ) {\r\n\r\n\t\t\tvar closest = touches[ 0 ];\r\n\r\n\t\t\tfor ( var i in touches ) {\r\n\r\n\t\t\t\tif ( closest.distanceTo( touch ) > touches[ i ].distanceTo( touch ) ) closest = touches[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn closest;\r\n\r\n\t\t}\r\n\r\n\t\tswitch ( event.touches.length ) {\r\n\r\n\t\t\tcase 1:\r\n\t\t\t\ttouches[ 0 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 ).divideScalar( window.devicePixelRatio );\r\n\t\t\t\ttouches[ 1 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 ).divideScalar( window.devicePixelRatio );\r\n\t\t\t\tscope.rotate( touches[ 0 ].sub( getClosest( touches[ 0 ], prevTouches ) ).multiplyScalar( - 1 ) );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 2:\r\n\t\t\t\ttouches[ 0 ].set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY, 0 ).divideScalar( window.devicePixelRatio );\r\n\t\t\t\ttouches[ 1 ].set( event.touches[ 1 ].pageX, event.touches[ 1 ].pageY, 0 ).divideScalar( window.devicePixelRatio );\r\n\t\t\t\tvar distance = touches[ 0 ].distanceTo( touches[ 1 ] );\r\n\t\t\t\tscope.zoom( delta.set( 0, 0, prevDistance - distance ) );\r\n\t\t\t\tprevDistance = distance;\r\n\r\n\r\n\t\t\t\tvar offset0 = touches[ 0 ].clone().sub( getClosest( touches[ 0 ], prevTouches ) );\r\n\t\t\t\tvar offset1 = touches[ 1 ].clone().sub( getClosest( touches[ 1 ], prevTouches ) );\r\n\t\t\t\toffset0.x = - offset0.x;\r\n\t\t\t\toffset1.x = - offset1.x;\r\n\r\n\t\t\t\tscope.pan( offset0.add( offset1 ) );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tprevTouches[ 0 ].copy( touches[ 0 ] );\r\n\t\tprevTouches[ 1 ].copy( touches[ 1 ] );\r\n\r\n\t}\r\n\r\n\tdomElement.addEventListener( 'touchstart', touchStart, false );\r\n\tdomElement.addEventListener( 'touchmove', touchMove, false );\r\n\r\n}\r\n\r\nEditorControls.prototype = Object.create( THREE.EventDispatcher.prototype );\r\nEditorControls.prototype.constructor = EditorControls;\r\n\r\nexport { EditorControls };\r\n","import { UISelect } from './libs/ui.js';\r\n\r\nfunction ViewportCamera( editor ) {\r\n\r\n\tvar signals = editor.signals;\r\n\r\n\t//\r\n\r\n\tvar cameraSelect = new UISelect();\r\n\tcameraSelect.setPosition( 'absolute' );\r\n\tcameraSelect.setRight( '10px' );\r\n\tcameraSelect.setTop( '10px' );\r\n\tcameraSelect.onChange( function () {\r\n\r\n\t\teditor.setViewportCamera( this.getValue() );\r\n\r\n\t} );\r\n\r\n\tsignals.cameraAdded.add( update );\r\n\tsignals.cameraRemoved.add( update );\r\n\r\n\tupdate();\r\n\r\n\t//\r\n\r\n\tfunction update() {\r\n\r\n\t\tvar options = {};\r\n\r\n\t\tvar cameras = editor.cameras;\r\n\r\n\t\tfor ( var key in cameras ) {\r\n\r\n\t\t\tvar camera = cameras[ key ];\r\n\t\t\toptions[ camera.uuid ] = camera.name;\r\n\r\n\t\t}\r\n\r\n\t\tcameraSelect.setOptions( options );\r\n\t\tcameraSelect.setValue( editor.viewportCamera.uuid );\r\n\r\n\t}\r\n\r\n\treturn cameraSelect;\r\n\r\n}\r\n\r\nexport { ViewportCamera };\r\n","import { UIPanel, UIBreak, UIText } from './libs/ui.js';\r\n\r\nfunction ViewportInfo( editor ) {\r\n\r\n\tvar signals = editor.signals;\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setId( 'info' );\r\n\tcontainer.setPosition( 'absolute' );\r\n\tcontainer.setLeft( '10px' );\r\n\tcontainer.setBottom( '10px' );\r\n\tcontainer.setFontSize( '12px' );\r\n\tcontainer.setColor( '#fff' );\r\n\r\n\tvar objectsText = new UIText( '0' ).setMarginLeft( '6px' );\r\n\tvar verticesText = new UIText( '0' ).setMarginLeft( '6px' );\r\n\tvar trianglesText = new UIText( '0' ).setMarginLeft( '6px' );\r\n\tvar frametimeText = new UIText( '0' ).setMarginLeft( '6px' );\r\n\r\n\tcontainer.add( new UIText( strings.getKey( 'viewport/info/objects' ) ).setTextTransform( 'lowercase' ) );\r\n\tcontainer.add( objectsText, new UIBreak() );\r\n\tcontainer.add( new UIText( strings.getKey( 'viewport/info/vertices' ) ).setTextTransform( 'lowercase' ) );\r\n\tcontainer.add( verticesText, new UIBreak() );\r\n\tcontainer.add( new UIText( strings.getKey( 'viewport/info/triangles' ) ).setTextTransform( 'lowercase' ) );\r\n\tcontainer.add( trianglesText, new UIBreak() );\r\n\tcontainer.add( new UIText( strings.getKey( 'viewport/info/frametime' ) ).setTextTransform( 'lowercase' ) );\r\n\tcontainer.add( frametimeText, new UIBreak() );\r\n\r\n\tsignals.objectAdded.add( update );\r\n\tsignals.objectRemoved.add( update );\r\n\tsignals.geometryChanged.add( update );\r\n\r\n\t//\r\n\r\n\tfunction update() {\r\n\r\n\t\tvar scene = editor.scene;\r\n\r\n\t\tvar objects = 0, vertices = 0, triangles = 0;\r\n\r\n\t\tfor ( var i = 0, l = scene.children.length; i < l; i ++ ) {\r\n\r\n\t\t\tvar object = scene.children[ i ];\r\n\r\n\t\t\tobject.traverseVisible( function ( object ) {\r\n\r\n\t\t\t\tobjects ++;\r\n\r\n\t\t\t\tif ( object.isMesh ) {\r\n\r\n\t\t\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\t\t\tif ( geometry.isGeometry ) {\r\n\r\n\t\t\t\t\t\tvertices += geometry.vertices.length;\r\n\t\t\t\t\t\ttriangles += geometry.faces.length;\r\n\r\n\t\t\t\t\t} else if ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t\t\tvertices += geometry.attributes.position.count;\r\n\r\n\t\t\t\t\t\tif ( geometry.index !== null ) {\r\n\r\n\t\t\t\t\t\t\ttriangles += geometry.index.count / 3;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\ttriangles += geometry.attributes.position.count / 3;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tobjectsText.setValue( objects.format() );\r\n\t\tverticesText.setValue( vertices.format() );\r\n\t\ttrianglesText.setValue( triangles.format() );\r\n\r\n\t}\r\n\r\n\tsignals.sceneRendered.add( updateFrametime );\r\n\r\n\tfunction updateFrametime( frametime ) {\r\n\r\n\t\tframetimeText.setValue( Number( frametime ).toFixed( 2 ) + ' ms' );\r\n\r\n\t}\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { ViewportInfo };\r\n","import { UIPanel } from './libs/ui.js';\r\n\r\nimport * as THREE from 'three'\r\n\r\nclass ViewHelper extends THREE.Object3D {\r\n\r\n\tconstructor( editorCamera, container ) {\r\n\r\n\t\tsuper();\r\n\r\n\t\tthis.animating = false;\r\n\t\tthis.controls = null;\r\n\r\n\t\tconst panel = new UIPanel();\r\n\t\tpanel.setId( 'viewHelper' );\r\n\t\tpanel.setPosition( 'absolute' );\r\n\t\tpanel.setRight( '0px' );\r\n\t\tpanel.setBottom( '0px' );\r\n\t\tpanel.setHeight( '128px' );\r\n\t\tpanel.setWidth( '128px' );\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\tpanel.dom.addEventListener( 'mouseup', function ( event ) {\r\n\r\n\t\t\tevent.stopPropagation();\r\n\r\n\t\t\tscope.handleClick( event );\r\n\r\n\t\t} );\r\n\r\n\t\tpanel.dom.addEventListener( 'mousedown', function ( event ) {\r\n\r\n\t\t\tevent.stopPropagation();\r\n\r\n\t\t} );\r\n\r\n\t\tcontainer.add( panel );\r\n\r\n\t\tconst color1 = new THREE.Color( '#ff3653' );\r\n\t\tconst color2 = new THREE.Color( '#8adb00' );\r\n\t\tconst color3 = new THREE.Color( '#2c8fff' );\r\n\r\n\t\tconst interactiveObjects = [];\r\n\t\tconst raycaster = new THREE.Raycaster();\r\n\t\tconst mouse = new THREE.Vector2();\r\n\t\tconst dummy = new THREE.Object3D();\r\n\r\n\t\tconst camera = new THREE.OrthographicCamera( - 2, 2, 2, - 2, 0, 4 );\r\n\t\tcamera.position.set( 0, 0, 2 );\r\n\r\n\t\tconst geometry = new THREE.BoxGeometry( 0.8, 0.05, 0.05 ).translate( 0.4, 0, 0 );\r\n\r\n\t\tconst xAxis = new THREE.Mesh( geometry, getAxisMaterial( color1 ) );\r\n\t\tconst yAxis = new THREE.Mesh( geometry, getAxisMaterial( color2 ) );\r\n\t\tconst zAxis = new THREE.Mesh( geometry, getAxisMaterial( color3 ) );\r\n\r\n\t\tyAxis.rotation.z = Math.PI / 2;\r\n\t\tzAxis.rotation.y = - Math.PI / 2;\r\n\r\n\t\tthis.add( xAxis );\r\n\t\tthis.add( zAxis );\r\n\t\tthis.add( yAxis );\r\n\r\n\t\tconst posXAxisHelper = new THREE.Sprite( getSpriteMaterial( color1, 'X' ) );\r\n\t\tposXAxisHelper.userData.type = 'posX';\r\n\t\tconst posYAxisHelper = new THREE.Sprite( getSpriteMaterial( color2, 'Y' ) );\r\n\t\tposYAxisHelper.userData.type = 'posY';\r\n\t\tconst posZAxisHelper = new THREE.Sprite( getSpriteMaterial( color3, 'Z' ) );\r\n\t\tposZAxisHelper.userData.type = 'posZ';\r\n\t\tconst negXAxisHelper = new THREE.Sprite( getSpriteMaterial( color1 ) );\r\n\t\tnegXAxisHelper.userData.type = 'negX';\r\n\t\tconst negYAxisHelper = new THREE.Sprite( getSpriteMaterial( color2 ) );\r\n\t\tnegYAxisHelper.userData.type = 'negY';\r\n\t\tconst negZAxisHelper = new THREE.Sprite( getSpriteMaterial( color3 ) );\r\n\t\tnegZAxisHelper.userData.type = 'negZ';\r\n\r\n\t\tposXAxisHelper.position.x = 1;\r\n\t\tposYAxisHelper.position.y = 1;\r\n\t\tposZAxisHelper.position.z = 1;\r\n\t\tnegXAxisHelper.position.x = - 1;\r\n\t\tnegXAxisHelper.scale.setScalar( 0.8 );\r\n\t\tnegYAxisHelper.position.y = - 1;\r\n\t\tnegYAxisHelper.scale.setScalar( 0.8 );\r\n\t\tnegZAxisHelper.position.z = - 1;\r\n\t\tnegZAxisHelper.scale.setScalar( 0.8 );\r\n\r\n\t\tthis.add( posXAxisHelper );\r\n\t\tthis.add( posYAxisHelper );\r\n\t\tthis.add( posZAxisHelper );\r\n\t\tthis.add( negXAxisHelper );\r\n\t\tthis.add( negYAxisHelper );\r\n\t\tthis.add( negZAxisHelper );\r\n\r\n\t\tinteractiveObjects.push( posXAxisHelper );\r\n\t\tinteractiveObjects.push( posYAxisHelper );\r\n\t\tinteractiveObjects.push( posZAxisHelper );\r\n\t\tinteractiveObjects.push( negXAxisHelper );\r\n\t\tinteractiveObjects.push( negYAxisHelper );\r\n\t\tinteractiveObjects.push( negZAxisHelper );\r\n\r\n\t\tconst point = new THREE.Vector3();\r\n\t\tconst dim = 128;\r\n\t\tconst turnRate = 2 * Math.PI; // turn rate in angles per second\r\n\r\n\t\tthis.render = function ( renderer ) {\r\n\r\n\t\t\tthis.quaternion.copy( editorCamera.quaternion ).invert();\r\n\t\t\tthis.updateMatrixWorld();\r\n\r\n\t\t\tpoint.set( 0, 0, 1 );\r\n\t\t\tpoint.applyQuaternion( editorCamera.quaternion );\r\n\r\n\t\t\tif ( point.x >= 0 ) {\r\n\r\n\t\t\t\tposXAxisHelper.material.opacity = 1;\r\n\t\t\t\tnegXAxisHelper.material.opacity = 0.5;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tposXAxisHelper.material.opacity = 0.5;\r\n\t\t\t\tnegXAxisHelper.material.opacity = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( point.y >= 0 ) {\r\n\r\n\t\t\t\tposYAxisHelper.material.opacity = 1;\r\n\t\t\t\tnegYAxisHelper.material.opacity = 0.5;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tposYAxisHelper.material.opacity = 0.5;\r\n\t\t\t\tnegYAxisHelper.material.opacity = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( point.z >= 0 ) {\r\n\r\n\t\t\t\tposZAxisHelper.material.opacity = 1;\r\n\t\t\t\tnegZAxisHelper.material.opacity = 0.5;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tposZAxisHelper.material.opacity = 0.5;\r\n\t\t\t\tnegZAxisHelper.material.opacity = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tconst x = container.dom.offsetWidth - dim;\r\n\r\n\t\t\trenderer.clearDepth();\r\n\t\t\trenderer.setViewport( x, 0, dim, dim );\r\n\t\t\trenderer.render( this, camera );\r\n\r\n\t\t};\r\n\r\n\t\tconst targetPosition = new THREE.Vector3();\r\n\t\tconst targetQuaternion = new THREE.Quaternion();\r\n\r\n\t\tconst q1 = new THREE.Quaternion();\r\n\t\tconst q2 = new THREE.Quaternion();\r\n\t\tlet radius = 0;\r\n\r\n\t\tthis.handleClick = function ( event ) {\r\n\r\n\t\t\tif ( this.animating === true ) return false;\r\n\r\n\t\t\tconst rect = container.dom.getBoundingClientRect();\r\n\t\t\tconst offsetX = rect.left + ( container.dom.offsetWidth - dim );\r\n\t\t\tconst offsetY = rect.top + ( container.dom.offsetHeight - dim );\r\n\t\t\tmouse.x = ( ( event.clientX - offsetX ) / ( rect.width - offsetX ) ) * 2 - 1;\r\n\t\t\tmouse.y = - ( ( event.clientY - offsetY ) / ( rect.bottom - offsetY ) ) * 2 + 1;\r\n\r\n\t\t\traycaster.setFromCamera( mouse, camera );\r\n\r\n\t\t\tconst intersects = raycaster.intersectObjects( interactiveObjects );\r\n\r\n\t\t\tif ( intersects.length > 0 ) {\r\n\r\n\t\t\t\tconst intersection = intersects[ 0 ];\r\n\t\t\t\tconst object = intersection.object;\r\n\r\n\t\t\t\tprepareAnimationData( object, this.controls.center );\r\n\r\n\t\t\t\tthis.animating = true;\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tthis.update = function ( delta ) {\r\n\r\n\t\t\tconst step = delta * turnRate;\r\n\t\t\tconst focusPoint = this.controls.center;\r\n\r\n\t\t\t// animate position by doing a slerp and then scaling the position on the unit sphere\r\n\r\n\t\t\tq1.rotateTowards( q2, step );\r\n\t\t\teditorCamera.position.set( 0, 0, 1 ).applyQuaternion( q1 ).multiplyScalar( radius ).add( focusPoint );\r\n\r\n\t\t\t// animate orientation\r\n\r\n\t\t\teditorCamera.quaternion.rotateTowards( targetQuaternion, step );\r\n\r\n\t\t\tif ( q1.angleTo( q2 ) === 0 ) {\r\n\r\n\t\t\t\tthis.animating = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t\tfunction prepareAnimationData( object, focusPoint ) {\r\n\r\n\t\t\tswitch ( object.userData.type ) {\r\n\r\n\t\t\t\tcase 'posX':\r\n\t\t\t\t\ttargetPosition.set( 1, 0, 0 );\r\n\t\t\t\t\ttargetQuaternion.setFromEuler( new THREE.Euler( 0, Math.PI * 0.5, 0 ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'posY':\r\n\t\t\t\t\ttargetPosition.set( 0, 1, 0 );\r\n\t\t\t\t\ttargetQuaternion.setFromEuler( new THREE.Euler( - Math.PI * 0.5, 0, 0 ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'posZ':\r\n\t\t\t\t\ttargetPosition.set( 0, 0, 1 );\r\n\t\t\t\t\ttargetQuaternion.setFromEuler( new THREE.Euler() );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'negX':\r\n\t\t\t\t\ttargetPosition.set( - 1, 0, 0 );\r\n\t\t\t\t\ttargetQuaternion.setFromEuler( new THREE.Euler( 0, - Math.PI * 0.5, 0 ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'negY':\r\n\t\t\t\t\ttargetPosition.set( 0, - 1, 0 );\r\n\t\t\t\t\ttargetQuaternion.setFromEuler( new THREE.Euler( Math.PI * 0.5, 0, 0 ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'negZ':\r\n\t\t\t\t\ttargetPosition.set( 0, 0, - 1 );\r\n\t\t\t\t\ttargetQuaternion.setFromEuler( new THREE.Euler( 0, Math.PI, 0 ) );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.error( 'ViewHelper: Invalid axis.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//\r\n\r\n\t\t\tradius = editorCamera.position.distanceTo( focusPoint );\r\n\t\t\ttargetPosition.multiplyScalar( radius ).add( focusPoint );\r\n\r\n\t\t\tdummy.position.copy( focusPoint );\r\n\r\n\t\t\tdummy.lookAt( editorCamera.position );\r\n\t\t\tq1.copy( dummy.quaternion );\r\n\r\n\t\t\tdummy.lookAt( targetPosition );\r\n\t\t\tq2.copy( dummy.quaternion );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getAxisMaterial( color ) {\r\n\r\n\t\t\treturn new THREE.MeshBasicMaterial( { color: color, toneMapped: false } );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getSpriteMaterial( color, text = null ) {\r\n\r\n\t\t\tconst canvas = document.createElement( 'canvas' );\r\n\t\t\tcanvas.width = 64;\r\n\t\t\tcanvas.height = 64;\r\n\r\n\t\t\tconst context = canvas.getContext( '2d' );\r\n\t\t\tcontext.beginPath();\r\n\t\t\tcontext.arc( 32, 32, 16, 0, 2 * Math.PI );\r\n\t\t\tcontext.closePath();\r\n\t\t\tcontext.fillStyle = color.getStyle();\r\n\t\t\tcontext.fill();\r\n\r\n\t\t\tif ( text !== null ) {\r\n\r\n\t\t\t\tcontext.font = '24px Arial';\r\n\t\t\t\tcontext.textAlign = 'center';\r\n\t\t\t\tcontext.fillStyle = '#000000';\r\n\t\t\t\tcontext.fillText( text, 32, 41 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst texture = new THREE.CanvasTexture( canvas );\r\n\r\n\t\t\treturn new THREE.SpriteMaterial( { map: texture, toneMapped: false } );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nViewHelper.prototype.isViewHelper = true;\r\n\r\nexport { ViewHelper };\r\n","/**\r\n * https://github.com/google/model-viewer/blob/master/packages/model-viewer/src/three-components/EnvironmentScene.ts\r\n */\r\n\r\nimport {\r\n \tBackSide,\r\n \tBoxGeometry,\r\n \tMesh,\r\n\tMeshBasicMaterial,\r\n \tMeshStandardMaterial,\r\n \tPointLight,\r\n \tScene,\r\n} from 'three';\r\n\r\nclass RoomEnvironment extends Scene {\r\n\r\n\tconstructor() {\r\n\r\n\t\tsuper();\r\n\r\n\t\tconst geometry = new BoxGeometry();\r\n\t\tgeometry.deleteAttribute( 'uv' );\r\n\r\n\t\tconst roomMaterial = new MeshStandardMaterial( { side: BackSide } );\r\n\t\tconst boxMaterial = new MeshStandardMaterial();\r\n\r\n\t\tconst mainLight = new PointLight( 0xffffff, 5.0, 28, 2 );\r\n\t\tmainLight.position.set( 0.418, 16.199, 0.300 );\r\n\t\tthis.add( mainLight );\r\n\r\n\t\tconst room = new Mesh( geometry, roomMaterial );\r\n\t\troom.position.set( - 0.757, 13.219, 0.717 );\r\n\t\troom.scale.set( 31.713, 28.305, 28.591 );\r\n\t\tthis.add( room );\r\n\r\n\t\tconst box1 = new Mesh( geometry, boxMaterial );\r\n\t\tbox1.position.set( - 10.906, 2.009, 1.846 );\r\n\t\tbox1.rotation.set( 0, - 0.195, 0 );\r\n\t\tbox1.scale.set( 2.328, 7.905, 4.651 );\r\n\t\tthis.add( box1 );\r\n\r\n\t\tconst box2 = new Mesh( geometry, boxMaterial );\r\n\t\tbox2.position.set( - 5.607, - 0.754, - 0.758 );\r\n\t\tbox2.rotation.set( 0, 0.994, 0 );\r\n\t\tbox2.scale.set( 1.970, 1.534, 3.955 );\r\n\t\tthis.add( box2 );\r\n\r\n\t\tconst box3 = new Mesh( geometry, boxMaterial );\r\n\t\tbox3.position.set( 6.167, 0.857, 7.803 );\r\n\t\tbox3.rotation.set( 0, 0.561, 0 );\r\n\t\tbox3.scale.set( 3.927, 6.285, 3.687 );\r\n\t\tthis.add( box3 );\r\n\r\n\t\tconst box4 = new Mesh( geometry, boxMaterial );\r\n\t\tbox4.position.set( - 2.017, 0.018, 6.124 );\r\n\t\tbox4.rotation.set( 0, 0.333, 0 );\r\n\t\tbox4.scale.set( 2.002, 4.566, 2.064 );\r\n\t\tthis.add( box4 );\r\n\r\n\t\tconst box5 = new Mesh( geometry, boxMaterial );\r\n\t\tbox5.position.set( 2.291, - 0.756, - 2.621 );\r\n\t\tbox5.rotation.set( 0, - 0.286, 0 );\r\n\t\tbox5.scale.set( 1.546, 1.552, 1.496 );\r\n\t\tthis.add( box5 );\r\n\r\n\t\tconst box6 = new Mesh( geometry, boxMaterial );\r\n\t\tbox6.position.set( - 2.193, - 0.369, - 5.547 );\r\n\t\tbox6.rotation.set( 0, 0.516, 0 );\r\n\t\tbox6.scale.set( 3.875, 3.487, 2.986 );\r\n\t\tthis.add( box6 );\r\n\r\n\r\n\t\t// -x right\r\n\t\tconst light1 = new Mesh( geometry, createAreaLightMaterial( 50 ) );\r\n\t\tlight1.position.set( - 16.116, 14.37, 8.208 );\r\n\t\tlight1.scale.set( 0.1, 2.428, 2.739 );\r\n\t\tthis.add( light1 );\r\n\r\n\t\t// -x left\r\n\t\tconst light2 = new Mesh( geometry, createAreaLightMaterial( 50 ) );\r\n\t\tlight2.position.set( - 16.109, 18.021, - 8.207 );\r\n\t\tlight2.scale.set( 0.1, 2.425, 2.751 );\r\n\t\tthis.add( light2 );\r\n\r\n\t\t// +x\r\n\t\tconst light3 = new Mesh( geometry, createAreaLightMaterial( 17 ) );\r\n\t\tlight3.position.set( 14.904, 12.198, - 1.832 );\r\n\t\tlight3.scale.set( 0.15, 4.265, 6.331 );\r\n\t\tthis.add( light3 );\r\n\r\n\t\t// +z\r\n\t\tconst light4 = new Mesh( geometry, createAreaLightMaterial( 43 ) );\r\n\t\tlight4.position.set( - 0.462, 8.89, 14.520 );\r\n\t\tlight4.scale.set( 4.38, 5.441, 0.088 );\r\n\t\tthis.add( light4 );\r\n\r\n\t\t// -z\r\n\t\tconst light5 = new Mesh( geometry, createAreaLightMaterial( 20 ) );\r\n\t\tlight5.position.set( 3.235, 11.486, - 12.541 );\r\n\t\tlight5.scale.set( 2.5, 2.0, 0.1 );\r\n\t\tthis.add( light5 );\r\n\r\n\t\t// +y\r\n\t\tconst light6 = new Mesh( geometry, createAreaLightMaterial( 100 ) );\r\n\t\tlight6.position.set( 0.0, 20.0, 0.0 );\r\n\t\tlight6.scale.set( 1.0, 0.1, 1.0 );\r\n\t\tthis.add( light6 );\r\n\r\n\t}\r\n\r\n}\r\n\r\nfunction createAreaLightMaterial( intensity ) {\r\n\r\n\tconst material = new MeshBasicMaterial();\r\n\tmaterial.color.setScalar( intensity );\r\n\treturn material;\r\n\r\n}\r\n\r\nexport { RoomEnvironment };\r\n","import * as THREE from 'three'\r\n\r\nimport { TransformControls } from './libs/controls/TransformControls.js';\r\n\r\nimport { UIPanel } from './libs/ui.js';\r\n\r\nimport { EditorControls } from './EditorControls.js';\r\n\r\nimport { ViewportCamera } from './Viewport.Camera.js';\r\nimport { ViewportInfo } from './Viewport.Info.js';\r\nimport { ViewHelper } from './Viewport.ViewHelper.js';\r\n\r\nimport { SetPositionCommand } from './commands/SetPositionCommand.js';\r\nimport { SetRotationCommand } from './commands/SetRotationCommand.js';\r\nimport { SetScaleCommand } from './commands/SetScaleCommand.js';\r\n\r\nimport { RoomEnvironment } from './libs/environments/RoomEnvironment.js';\r\n\r\nfunction Viewport( editor ) {\r\n\r\n\tvar signals = editor.signals;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setId( 'viewport' );\r\n\tcontainer.setPosition( 'absolute' );\r\n\r\n\tcontainer.add( new ViewportCamera( editor ) );\r\n\tcontainer.add( new ViewportInfo( editor ) );\r\n\r\n\t//\r\n\r\n\tvar renderer = null;\r\n\tvar pmremGenerator = null;\r\n\r\n\tvar camera = editor.camera;\r\n\tvar scene = editor.scene;\r\n\tvar sceneHelpers = editor.sceneHelpers;\r\n\tvar showSceneHelpers = true;\r\n\r\n\tvar objects = [];\r\n\r\n\t// helpers\r\n\r\n\tvar grid = new THREE.Group();\r\n\r\n\tvar grid1 = new THREE.GridHelper( 30, 30, 0x888888 );\r\n\tgrid1.material.color.setHex( 0x888888 );\r\n\tgrid1.material.vertexColors = false;\r\n\tgrid.add( grid1 );\r\n\r\n\tvar grid2 = new THREE.GridHelper( 30, 6, 0x222222 );\r\n\tgrid2.material.color.setHex( 0x222222 );\r\n\tgrid2.material.depthFunc = THREE.AlwaysDepth;\r\n\tgrid2.material.vertexColors = false;\r\n\tgrid.add( grid2 );\r\n\r\n\tvar viewHelper = new ViewHelper( camera, container );\r\n\r\n\r\n\t//\r\n\r\n\tvar box = new THREE.Box3();\r\n\r\n\tvar selectionBox = new THREE.BoxHelper();\r\n\tselectionBox.material.depthTest = false;\r\n\tselectionBox.material.transparent = true;\r\n\tselectionBox.visible = false;\r\n\tsceneHelpers.add( selectionBox );\r\n\r\n\tvar objectPositionOnDown = null;\r\n\tvar objectRotationOnDown = null;\r\n\tvar objectScaleOnDown = null;\r\n\r\n\tvar transformControls = new TransformControls( camera, container.dom );\r\n\ttransformControls.addEventListener( 'change', function () {\r\n\r\n\t\tvar object = transformControls.object;\r\n\r\n\t\tif ( object !== undefined ) {\r\n\r\n\t\t\tselectionBox.setFromObject( object );\r\n\r\n\t\t\tvar helper = editor.helpers[ object.id ];\r\n\r\n\t\t\tif ( helper !== undefined && helper.isSkeletonHelper !== true ) {\r\n\r\n\t\t\t\thelper.update();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsignals.refreshSidebarObject3D.dispatch( object );\r\n\r\n\t\t}\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\ttransformControls.addEventListener( 'mouseDown', function () {\r\n\r\n\t\tvar object = transformControls.object;\r\n\r\n\t\tobjectPositionOnDown = object.position.clone();\r\n\t\tobjectRotationOnDown = object.rotation.clone();\r\n\t\tobjectScaleOnDown = object.scale.clone();\r\n\r\n\t\tcontrols.enabled = false;\r\n\r\n\t} );\r\n\ttransformControls.addEventListener( 'mouseUp', function () {\r\n\r\n\t\tvar object = transformControls.object;\r\n\r\n\t\tif ( object !== undefined ) {\r\n\r\n\t\t\tswitch ( transformControls.getMode() ) {\r\n\r\n\t\t\t\tcase 'translate':\r\n\r\n\t\t\t\t\tif ( ! objectPositionOnDown.equals( object.position ) ) {\r\n\r\n\t\t\t\t\t\teditor.execute( new SetPositionCommand( editor, object, object.position, objectPositionOnDown ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'rotate':\r\n\r\n\t\t\t\t\tif ( ! objectRotationOnDown.equals( object.rotation ) ) {\r\n\r\n\t\t\t\t\t\teditor.execute( new SetRotationCommand( editor, object, object.rotation, objectRotationOnDown ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase 'scale':\r\n\r\n\t\t\t\t\tif ( ! objectScaleOnDown.equals( object.scale ) ) {\r\n\r\n\t\t\t\t\t\teditor.execute( new SetScaleCommand( editor, object, object.scale, objectScaleOnDown ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tcontrols.enabled = true;\r\n\r\n\t} );\r\n\r\n\tsceneHelpers.add( transformControls );\r\n\r\n\t// object picking\r\n\r\n\tvar raycaster = new THREE.Raycaster();\r\n\tvar mouse = new THREE.Vector2();\r\n\r\n\t// events\r\n\r\n\tfunction updateAspectRatio() {\r\n\r\n\t\tcamera.aspect = container.dom.offsetWidth / container.dom.offsetHeight;\r\n\t\tcamera.updateProjectionMatrix();\r\n\r\n\t}\r\n\r\n\tfunction getIntersects( point, objects ) {\r\n\r\n\t\tmouse.set( ( point.x * 2 ) - 1, - ( point.y * 2 ) + 1 );\r\n\r\n\t\traycaster.setFromCamera( mouse, camera );\r\n\r\n\t\treturn raycaster.intersectObjects( objects )\r\n\t\t\t.filter( intersect => intersect.object.visible === true );\r\n\r\n\t}\r\n\r\n\tvar onDownPosition = new THREE.Vector2();\r\n\tvar onUpPosition = new THREE.Vector2();\r\n\tvar onDoubleClickPosition = new THREE.Vector2();\r\n\r\n\tfunction getMousePosition( dom, x, y ) {\r\n\r\n\t\tvar rect = dom.getBoundingClientRect();\r\n\t\treturn [ ( x - rect.left ) / rect.width, ( y - rect.top ) / rect.height ];\r\n\r\n\t}\r\n\r\n\tfunction handleClick() {\r\n\r\n\t\tif ( onDownPosition.distanceTo( onUpPosition ) === 0 ) {\r\n\r\n\t\t\tvar intersects = getIntersects( onUpPosition, objects );\r\n\r\n\t\t\tif ( intersects.length > 0 ) {\r\n\r\n\t\t\t\tvar object = intersects[ 0 ].object;\r\n\r\n\t\t\t\tif ( object.userData.object !== undefined ) {\r\n\r\n\t\t\t\t\t// helper\r\n\r\n\t\t\t\t\teditor.select( object.userData.object );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\teditor.select( object );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\teditor.select( null );\r\n\r\n\t\t\t}\r\n\r\n\t\t\trender();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onMouseDown( event ) {\r\n\r\n\t\t// event.preventDefault();\r\n\r\n\t\tvar array = getMousePosition( container.dom, event.clientX, event.clientY );\r\n\t\tonDownPosition.fromArray( array );\r\n\r\n\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\r\n\r\n\t}\r\n\r\n\tfunction onMouseUp( event ) {\r\n\r\n\t\tvar array = getMousePosition( container.dom, event.clientX, event.clientY );\r\n\t\tonUpPosition.fromArray( array );\r\n\r\n\t\thandleClick();\r\n\r\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\r\n\r\n\t}\r\n\r\n\tfunction onTouchStart( event ) {\r\n\r\n\t\tvar touch = event.changedTouches[ 0 ];\r\n\r\n\t\tvar array = getMousePosition( container.dom, touch.clientX, touch.clientY );\r\n\t\tonDownPosition.fromArray( array );\r\n\r\n\t\tdocument.addEventListener( 'touchend', onTouchEnd, false );\r\n\r\n\t}\r\n\r\n\tfunction onTouchEnd( event ) {\r\n\r\n\t\tvar touch = event.changedTouches[ 0 ];\r\n\r\n\t\tvar array = getMousePosition( container.dom, touch.clientX, touch.clientY );\r\n\t\tonUpPosition.fromArray( array );\r\n\r\n\t\thandleClick();\r\n\r\n\t\tdocument.removeEventListener( 'touchend', onTouchEnd, false );\r\n\r\n\t}\r\n\r\n\tfunction onDoubleClick( event ) {\r\n\r\n\t\tvar array = getMousePosition( container.dom, event.clientX, event.clientY );\r\n\t\tonDoubleClickPosition.fromArray( array );\r\n\r\n\t\tvar intersects = getIntersects( onDoubleClickPosition, objects );\r\n\r\n\t\tif ( intersects.length > 0 ) {\r\n\r\n\t\t\tvar intersect = intersects[ 0 ];\r\n\r\n\t\t\tsignals.objectFocused.dispatch( intersect.object );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tcontainer.dom.addEventListener( 'mousedown', onMouseDown, false );\r\n\tcontainer.dom.addEventListener( 'touchstart', onTouchStart, false );\r\n\tcontainer.dom.addEventListener( 'dblclick', onDoubleClick, false );\r\n\r\n\t// controls need to be added *after* main logic,\r\n\t// otherwise controls.enabled doesn't work.\r\n\r\n\tvar controls = new EditorControls( camera, container.dom );\r\n\tcontrols.addEventListener( 'change', function () {\r\n\r\n\t\tsignals.cameraChanged.dispatch( camera );\r\n\t\tsignals.refreshSidebarObject3D.dispatch( camera );\r\n\r\n\t} );\r\n\tviewHelper.controls = controls;\r\n\r\n\t// signals\r\n\r\n\tsignals.editorCleared.add( function () {\r\n\r\n\t\tcontrols.center.set( 0, 0, 0 );\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.transformModeChanged.add( function ( mode ) {\r\n\r\n\t\ttransformControls.setMode( mode );\r\n\r\n\t} );\r\n\r\n\tsignals.snapChanged.add( function ( dist ) {\r\n\r\n\t\ttransformControls.setTranslationSnap( dist );\r\n\r\n\t} );\r\n\r\n\tsignals.spaceChanged.add( function ( space ) {\r\n\r\n\t\ttransformControls.setSpace( space );\r\n\r\n\t} );\r\n\r\n\tsignals.rendererUpdated.add( function () {\r\n\r\n\t\tscene.traverse( function ( child ) {\r\n\r\n\t\t\tif ( child.material !== undefined ) {\r\n\r\n\t\t\t\tchild.material.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.rendererCreated.add( function ( newRenderer ) {\r\n\r\n\t\tif ( renderer !== null ) {\r\n\r\n\t\t\trenderer.setAnimationLoop( null );\r\n\t\t\trenderer.dispose();\r\n\t\t\tpmremGenerator.dispose();\r\n\r\n\t\t\tcontainer.dom.removeChild( renderer.domElement );\r\n\r\n\t\t}\r\n\r\n\t\trenderer = newRenderer;\r\n\r\n\t\trenderer.setAnimationLoop( animate );\r\n\t\trenderer.setClearColor( 0xaaaaaa );\r\n\r\n\t\tif ( window.matchMedia ) {\r\n\r\n\t\t\tvar mediaQuery = window.matchMedia( '(prefers-color-scheme: dark)' );\r\n\t\t\tmediaQuery.addListener( function ( event ) {\r\n\r\n\t\t\t\trenderer.setClearColor( event.matches ? 0x333333 : 0xaaaaaa );\r\n\t\t\t\tupdateGridColors( grid1, grid2, event.matches ? [ 0x222222, 0x888888 ] : [ 0x888888, 0x282828 ] );\r\n\r\n\t\t\t\trender();\r\n\r\n\t\t\t} );\r\n\r\n\t\t\trenderer.setClearColor( mediaQuery.matches ? 0x333333 : 0xaaaaaa );\r\n\t\t\tupdateGridColors( grid1, grid2, mediaQuery.matches ? [ 0x222222, 0x888888 ] : [ 0x888888, 0x282828 ] );\r\n\r\n\t\t}\r\n\r\n\t\trenderer.setPixelRatio( window.devicePixelRatio );\r\n\t\trenderer.setSize( container.dom.offsetWidth, container.dom.offsetHeight );\r\n\r\n\t\tpmremGenerator = new THREE.PMREMGenerator( renderer );\r\n\t\tpmremGenerator.compileEquirectangularShader();\r\n\r\n\t\tcontainer.dom.appendChild( renderer.domElement );\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.sceneGraphChanged.add( function () {\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.cameraChanged.add( function () {\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.objectSelected.add( function ( object ) {\r\n\r\n\t\tselectionBox.visible = false;\r\n\t\ttransformControls.detach();\r\n\r\n\t\tif ( object !== null && object !== scene && object !== camera ) {\r\n\r\n\t\t\tbox.setFromObject( object );\r\n\r\n\t\t\tif ( box.isEmpty() === false ) {\r\n\r\n\t\t\t\tselectionBox.setFromObject( object );\r\n\t\t\t\tselectionBox.visible = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttransformControls.attach( object );\r\n\r\n\t\t}\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.objectFocused.add( function ( object ) {\r\n\r\n\t\tcontrols.focus( object );\r\n\r\n\t} );\r\n\r\n\tsignals.geometryChanged.add( function ( object ) {\r\n\r\n\t\tif ( object !== undefined ) {\r\n\r\n\t\t\tselectionBox.setFromObject( object );\r\n\r\n\t\t}\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.objectAdded.add( function ( object ) {\r\n\r\n\t\tobject.traverse( function ( child ) {\r\n\r\n\t\t\tobjects.push( child );\r\n\r\n\t\t} );\r\n\r\n\t} );\r\n\r\n\tsignals.objectChanged.add( function ( object ) {\r\n\r\n\t\tif ( editor.selected === object ) {\r\n\r\n\t\t\tselectionBox.setFromObject( object );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.isPerspectiveCamera ) {\r\n\r\n\t\t\tobject.updateProjectionMatrix();\r\n\r\n\t\t}\r\n\r\n\t\tif ( editor.helpers[ object.id ] !== undefined ) {\r\n\r\n\t\t\teditor.helpers[ object.id ].update();\r\n\r\n\t\t}\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.objectRemoved.add( function ( object ) {\r\n\r\n\t\tcontrols.enabled = true; // see #14180\r\n\t\tif ( object === transformControls.object ) {\r\n\r\n\t\t\ttransformControls.detach();\r\n\r\n\t\t}\r\n\r\n\t\tobject.traverse( function ( child ) {\r\n\r\n\t\t\tobjects.splice( objects.indexOf( child ), 1 );\r\n\r\n\t\t} );\r\n\r\n\t} );\r\n\r\n\tsignals.helperAdded.add( function ( object ) {\r\n\r\n\t\tvar picker = object.getObjectByName( 'picker' );\r\n\r\n\t\tif ( picker !== undefined ) {\r\n\r\n\t\t\tobjects.push( picker );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tsignals.helperRemoved.add( function ( object ) {\r\n\r\n\t\tvar picker = object.getObjectByName( 'picker' );\r\n\r\n\t\tif ( picker !== undefined ) {\r\n\r\n\t\t\tobjects.splice( objects.indexOf( picker ), 1 );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tsignals.materialChanged.add( function () {\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.animationStopped.add( function () {\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\t// background\r\n\r\n\tsignals.sceneBackgroundChanged.add( function ( backgroundType, backgroundColor, backgroundTexture, backgroundEquirectangularTexture ) {\r\n\r\n\t\tswitch ( backgroundType ) {\r\n\r\n\t\t\tcase 'None':\r\n\r\n\t\t\t\tscene.background = null;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'Color':\r\n\r\n\t\t\t\tscene.background = new THREE.Color( backgroundColor );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'Texture':\r\n\r\n\t\t\t\tif ( backgroundTexture ) {\r\n\r\n\t\t\t\t\tscene.background = backgroundTexture;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'Equirectangular':\r\n\r\n\t\t\t\tif ( backgroundEquirectangularTexture ) {\r\n\r\n\t\t\t\t\tbackgroundEquirectangularTexture.mapping = THREE.EquirectangularReflectionMapping;\r\n\t\t\t\t\tscene.background = backgroundEquirectangularTexture;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\t// environment\r\n\r\n\tsignals.sceneEnvironmentChanged.add( function ( environmentType, environmentEquirectangularTexture ) {\r\n\r\n\t\tswitch ( environmentType ) {\r\n\r\n\t\t\tcase 'None':\r\n\r\n\t\t\t\tscene.environment = null;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'Equirectangular':\r\n\r\n\t\t\t\tscene.environment = null;\r\n\r\n\t\t\t\tif ( environmentEquirectangularTexture ) {\r\n\r\n\t\t\t\t\tenvironmentEquirectangularTexture.mapping = THREE.EquirectangularReflectionMapping;\r\n\t\t\t\t\tscene.environment = environmentEquirectangularTexture;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'ModelViewer':\r\n\r\n\t\t\t\tscene.environment = pmremGenerator.fromScene( new RoomEnvironment(), 0.04 ).texture;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\t// fog\r\n\r\n\tsignals.sceneFogChanged.add( function ( fogType, fogColor, fogNear, fogFar, fogDensity ) {\r\n\r\n\t\tswitch ( fogType ) {\r\n\r\n\t\t\tcase 'None':\r\n\t\t\t\tscene.fog = null;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'Fog':\r\n\t\t\t\tscene.fog = new THREE.Fog( fogColor, fogNear, fogFar );\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'FogExp2':\r\n\t\t\t\tscene.fog = new THREE.FogExp2( fogColor, fogDensity );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.sceneFogSettingsChanged.add( function ( fogType, fogColor, fogNear, fogFar, fogDensity ) {\r\n\r\n\t\tswitch ( fogType ) {\r\n\r\n\t\t\tcase 'Fog':\r\n\t\t\t\tscene.fog.color.setHex( fogColor );\r\n\t\t\t\tscene.fog.near = fogNear;\r\n\t\t\t\tscene.fog.far = fogFar;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'FogExp2':\r\n\t\t\t\tscene.fog.color.setHex( fogColor );\r\n\t\t\t\tscene.fog.density = fogDensity;\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.viewportCameraChanged.add( function () {\r\n\r\n\t\tvar viewportCamera = editor.viewportCamera;\r\n\r\n\t\tif ( viewportCamera.isPerspectiveCamera ) {\r\n\r\n\t\t\tviewportCamera.aspect = editor.camera.aspect;\r\n\t\t\tviewportCamera.projectionMatrix.copy( editor.camera.projectionMatrix );\r\n\r\n\t\t} else if ( viewportCamera.isOrthographicCamera ) {\r\n\r\n\t\t\t// TODO\r\n\r\n\t\t}\r\n\r\n\t\t// disable EditorControls when setting a user camera\r\n\r\n\t\tcontrols.enabled = ( viewportCamera === editor.camera );\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\r\n\t//\r\n\r\n\tsignals.windowResize.add( function () {\r\n\r\n\t\tupdateAspectRatio();\r\n\r\n\t\trenderer.setSize( container.dom.offsetWidth, container.dom.offsetHeight );\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.showGridChanged.add( function ( showGrid ) {\r\n\r\n\t\tgrid.visible = showGrid;\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.showHelpersChanged.add( function ( showHelpers ) {\r\n\r\n\t\tshowSceneHelpers = showHelpers;\r\n\t\ttransformControls.enabled = showHelpers;\r\n\r\n\t\trender();\r\n\r\n\t} );\r\n\r\n\tsignals.cameraResetted.add( updateAspectRatio );\r\n\r\n\t// animations\r\n\r\n\tvar clock = new THREE.Clock(); // only used for animations\r\n\r\n\tfunction animate() {\r\n\r\n\t\tvar mixer = editor.mixer;\r\n\t\tvar delta = clock.getDelta();\r\n\r\n\t\tvar needsUpdate = false;\r\n\r\n\t\tif ( mixer.stats.actions.inUse > 0 ) {\r\n\r\n\t\t\tmixer.update( delta );\r\n\t\t\tneedsUpdate = true;\r\n\r\n\t\t}\r\n\r\n\t\tif ( viewHelper.animating === true ) {\r\n\r\n\t\t\tviewHelper.update( delta );\r\n\t\t\tneedsUpdate = true;\r\n\r\n\t\t}\r\n\t\t\r\n\r\n\t\tif ( needsUpdate === true ) render();\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tvar startTime = 0;\r\n\tvar endTime = 0;\r\n\r\n\tfunction render() {\r\n\r\n\t\tstartTime = performance.now();\r\n\r\n\t\t// Adding/removing grid to scene so materials with depthWrite false\r\n\t\t// don't render under the grid.\r\n\r\n\t\tscene.add( grid );\r\n\t\trenderer.setViewport( 0, 0, container.dom.offsetWidth, container.dom.offsetHeight );\r\n\t\trenderer.render( scene, editor.viewportCamera );\r\n\t\tscene.remove( grid );\r\n\r\n\t\tif ( camera === editor.viewportCamera ) {\r\n\r\n\t\t\trenderer.autoClear = false;\r\n\t\t\tif ( showSceneHelpers === true ) renderer.render( sceneHelpers, camera );\r\n\t\t\t\r\n\t\t\trenderer.autoClear = true;\r\n\r\n\t\t}\r\n\r\n\t\tendTime = performance.now();\r\n\t\teditor.signals.sceneRendered.dispatch( endTime - startTime );\r\n\r\n\t}\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nfunction updateGridColors( grid1, grid2, colors ) {\r\n\r\n\tgrid1.material.color.setHex( colors[ 0 ] );\r\n\tgrid2.material.color.setHex( colors[ 1 ] );\r\n\r\n}\r\n\r\nexport { Viewport };\r\n","import { UIPanel, UIButton, UICheckbox } from './libs/ui.js';\r\n\r\nfunction Toolbar( editor ) {\r\n\r\n\tvar signals = editor.signals;\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setId( 'toolbar' );\r\n\r\n\t// translate / rotate / scale\r\n\r\n\tvar translateIcon = document.createElement( 'img' );\r\n\ttranslateIcon.title = strings.getKey( 'toolbar/translate' );\r\n\ttranslateIcon.src = 'images/translate.svg';\r\n\r\n\tvar translate = new UIButton();\r\n\ttranslate.dom.className = 'Button selected';\r\n\ttranslate.dom.appendChild( translateIcon );\r\n\ttranslate.onClick( function () {\r\n\r\n\t\tsignals.transformModeChanged.dispatch( 'translate' );\r\n\r\n\t} );\r\n\tcontainer.add( translate );\r\n\r\n\tvar rotateIcon = document.createElement( 'img' );\r\n\trotateIcon.title = strings.getKey( 'toolbar/rotate' );\r\n\trotateIcon.src = 'images/rotate.svg';\r\n\r\n\tvar rotate = new UIButton();\r\n\trotate.dom.appendChild( rotateIcon );\r\n\trotate.onClick( function () {\r\n\r\n\t\tsignals.transformModeChanged.dispatch( 'rotate' );\r\n\r\n\t} );\r\n\tcontainer.add( rotate );\r\n\r\n\tvar scaleIcon = document.createElement( 'img' );\r\n\tscaleIcon.title = strings.getKey( 'toolbar/scale' );\r\n\tscaleIcon.src = 'images/scale.svg';\r\n\r\n\tvar scale = new UIButton();\r\n\tscale.dom.appendChild( scaleIcon );\r\n\tscale.onClick( function () {\r\n\r\n\t\tsignals.transformModeChanged.dispatch( 'scale' );\r\n\r\n\t} );\r\n\tcontainer.add( scale );\r\n\r\n\tvar local = new UICheckbox( false );\r\n\tlocal.dom.title = strings.getKey( 'toolbar/local' );\r\n\tlocal.onChange( function () {\r\n\r\n\t\tsignals.spaceChanged.dispatch( this.getValue() === true ? 'local' : 'world' );\r\n\r\n\t} );\r\n\tcontainer.add( local );\r\n\r\n\t//\r\n\r\n\tsignals.transformModeChanged.add( function ( mode ) {\r\n\r\n\t\ttranslate.dom.classList.remove( 'selected' );\r\n\t\trotate.dom.classList.remove( 'selected' );\r\n\t\tscale.dom.classList.remove( 'selected' );\r\n\r\n\t\tswitch ( mode ) {\r\n\r\n\t\t\tcase 'translate': translate.dom.classList.add( 'selected' ); break;\r\n\t\t\tcase 'rotate': rotate.dom.classList.add( 'selected' ); break;\r\n\t\t\tcase 'scale': scale.dom.classList.add( 'selected' ); break;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { Toolbar };\r\n","import * as THREE from 'three'\r\n\r\nimport { UIPanel, UIBreak, UIRow, UIColor, UISelect, UIText, UINumber } from './libs/ui.js';\r\nimport { UIOutliner, UITexture } from './libs/ui.three.js';\r\n\r\nfunction SidebarScene( editor ) {\r\n\r\n\tvar signals = editor.signals;\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setBorderTop( '0' );\r\n\tcontainer.setPaddingTop( '20px' );\r\n\r\n\t// outliner\r\n\r\n\tvar nodeStates = new WeakMap();\r\n\r\n\tfunction buildOption( object, draggable ) {\r\n\r\n\t\tvar option = document.createElement( 'div' );\r\n\t\toption.draggable = draggable;\r\n\t\toption.innerHTML = buildHTML( object );\r\n\t\toption.value = object.id;\r\n\r\n\t\t// opener\r\n\r\n\t\tif ( nodeStates.has( object ) ) {\r\n\r\n\t\t\tvar state = nodeStates.get( object );\r\n\r\n\t\t\tvar opener = document.createElement( 'span' );\r\n\t\t\topener.classList.add( 'opener' );\r\n\r\n\t\t\tif ( object.children.length > 0 ) {\r\n\r\n\t\t\t\topener.classList.add( state ? 'open' : 'closed' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\topener.addEventListener( 'click', function () {\r\n\r\n\t\t\t\tnodeStates.set( object, nodeStates.get( object ) === false ); // toggle\r\n\t\t\t\trefreshUI();\r\n\r\n\t\t\t}, false );\r\n\r\n\t\t\toption.insertBefore( opener, option.firstChild );\r\n\r\n\t\t}\r\n\r\n\t\treturn option;\r\n\r\n\t}\r\n\r\n\tfunction getMaterialName( material ) {\r\n\r\n\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\tvar array = [];\r\n\r\n\t\t\tfor ( var i = 0; i < material.length; i ++ ) {\r\n\r\n\t\t\t\tarray.push( material[ i ].name );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn array.join( ',' );\r\n\r\n\t\t}\r\n\r\n\t\treturn material.name;\r\n\r\n\t}\r\n\r\n\tfunction escapeHTML( html ) {\r\n\r\n\t\treturn html\r\n\t\t\t.replace( /&/g, '&amp;' )\r\n\t\t\t.replace( /\"/g, '&quot;' )\r\n\t\t\t.replace( /'/g, '&#39;' )\r\n\t\t\t.replace( /</g, '&lt;' )\r\n\t\t\t.replace( />/g, '&gt;' );\r\n\r\n\t}\r\n\r\n\tfunction getObjectType( object ) {\r\n\r\n\t\tif ( object.isScene ) return 'Scene';\r\n\t\tif ( object.isCamera ) return 'Camera';\r\n\t\tif ( object.isLight ) return 'Light';\r\n\t\tif ( object.isMesh ) return 'Mesh';\r\n\t\tif ( object.isLine ) return 'Line';\r\n\t\tif ( object.isPoints ) return 'Points';\r\n\r\n\t\treturn 'Object3D';\r\n\r\n\t}\r\n\r\n\tfunction buildHTML( object ) {\r\n\r\n\t\tvar html = `<span class=\"type ${ getObjectType( object ) }\"></span> ${ escapeHTML( object.name ) }`;\r\n\r\n\t\tif ( object.isMesh ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\t\t\tvar material = object.material;\r\n\r\n\t\t\thtml += ` <span class=\"type Geometry\"></span> ${ escapeHTML( geometry.name ) }`;\r\n\t\t\thtml += ` <span class=\"type Material\"></span> ${ escapeHTML( getMaterialName( material ) ) }`;\r\n\r\n\t\t}\r\n\r\n\t\thtml += getScript( object.uuid );\r\n\r\n\t\treturn html;\r\n\r\n\t}\r\n\r\n\tfunction getScript( uuid ) {\r\n\r\n\t\tif ( editor.scripts[ uuid ] !== undefined ) {\r\n\r\n\t\t\treturn ' <span class=\"type Script\"></span>';\r\n\r\n\t\t}\r\n\r\n\t\treturn '';\r\n\r\n\t}\r\n\r\n\tvar ignoreObjectSelectedSignal = false;\r\n\r\n\tvar outliner = new UIOutliner( editor );\r\n\toutliner.setId( 'outliner' );\r\n\toutliner.onChange( function () {\r\n\r\n\t\tignoreObjectSelectedSignal = true;\r\n\r\n\t\teditor.selectById( parseInt( outliner.getValue() ) );\r\n\r\n\t\tignoreObjectSelectedSignal = false;\r\n\r\n\t} );\r\n\toutliner.onDblClick( function () {\r\n\r\n\t\teditor.focusById( parseInt( outliner.getValue() ) );\r\n\r\n\t} );\r\n\tcontainer.add( outliner );\r\n\tcontainer.add( new UIBreak() );\r\n\r\n\t// background\r\n\r\n\tvar backgroundRow = new UIRow();\r\n\r\n\tvar backgroundType = new UISelect().setOptions( {\r\n\r\n\t\t'None': '',\r\n\t\t'Color': 'Color',\r\n\t\t'Texture': 'Texture',\r\n\t\t'Equirectangular': 'Equirect'\r\n\r\n\t} ).setWidth( '150px' );\r\n\tbackgroundType.onChange( function () {\r\n\r\n\t\tonBackgroundChanged();\r\n\t\trefreshBackgroundUI();\r\n\r\n\t} );\r\n\r\n\tbackgroundRow.add( new UIText( strings.getKey( 'sidebar/scene/background' ) ).setWidth( '90px' ) );\r\n\tbackgroundRow.add( backgroundType );\r\n\r\n\tvar backgroundColor = new UIColor().setValue( '#000000' ).setMarginLeft( '8px' ).onInput( onBackgroundChanged );\r\n\tbackgroundRow.add( backgroundColor );\r\n\r\n\tvar backgroundTexture = new UITexture().setMarginLeft( '8px' ).onChange( onBackgroundChanged );\r\n\tbackgroundTexture.setDisplay( 'none' );\r\n\tbackgroundRow.add( backgroundTexture );\r\n\r\n\tvar backgroundEquirectangularTexture = new UITexture().setMarginLeft( '8px' ).onChange( onBackgroundChanged );\r\n\tbackgroundEquirectangularTexture.setDisplay( 'none' );\r\n\tbackgroundRow.add( backgroundEquirectangularTexture );\r\n\r\n\tcontainer.add( backgroundRow );\r\n\r\n\tfunction onBackgroundChanged() {\r\n\r\n\t\tsignals.sceneBackgroundChanged.dispatch(\r\n\t\t\tbackgroundType.getValue(),\r\n\t\t\tbackgroundColor.getHexValue(),\r\n\t\t\tbackgroundTexture.getValue(),\r\n\t\t\tbackgroundEquirectangularTexture.getValue()\r\n\t\t);\r\n\r\n\t}\r\n\r\n\tfunction refreshBackgroundUI() {\r\n\r\n\t\tvar type = backgroundType.getValue();\r\n\r\n\t\tbackgroundType.setWidth( type === 'None' ? '150px' : '110px' );\r\n\t\tbackgroundColor.setDisplay( type === 'Color' ? '' : 'none' );\r\n\t\tbackgroundTexture.setDisplay( type === 'Texture' ? '' : 'none' );\r\n\t\tbackgroundEquirectangularTexture.setDisplay( type === 'Equirectangular' ? '' : 'none' );\r\n\r\n\t}\r\n\r\n\t// environment\r\n\r\n\tvar environmentRow = new UIRow();\r\n\r\n\tvar environmentType = new UISelect().setOptions( {\r\n\r\n\t\t'None': '',\r\n\t\t'Equirectangular': 'Equirect',\r\n\t\t'ModelViewer': 'ModelViewer'\r\n\r\n\t} ).setWidth( '150px' );\r\n\tenvironmentType.setValue( 'None' );\r\n\tenvironmentType.onChange( function () {\r\n\r\n\t\tonEnvironmentChanged();\r\n\t\trefreshEnvironmentUI();\r\n\r\n\t} );\r\n\r\n\tenvironmentRow.add( new UIText( strings.getKey( 'sidebar/scene/environment' ) ).setWidth( '90px' ) );\r\n\tenvironmentRow.add( environmentType );\r\n\r\n\tvar environmentEquirectangularTexture = new UITexture().setMarginLeft( '8px' ).onChange( onEnvironmentChanged );\r\n\tenvironmentEquirectangularTexture.setDisplay( 'none' );\r\n\tenvironmentRow.add( environmentEquirectangularTexture );\r\n\r\n\tcontainer.add( environmentRow );\r\n\r\n\tfunction onEnvironmentChanged() {\r\n\r\n\t\tsignals.sceneEnvironmentChanged.dispatch(\r\n\t\t\tenvironmentType.getValue(),\r\n\t\t\tenvironmentEquirectangularTexture.getValue()\r\n\t\t);\r\n\r\n\t}\r\n\r\n\tfunction refreshEnvironmentUI() {\r\n\r\n\t\tvar type = environmentType.getValue();\r\n\r\n\t\tenvironmentType.setWidth( type !== 'Equirectangular' ? '150px' : '110px' );\r\n\t\tenvironmentEquirectangularTexture.setDisplay( type === 'Equirectangular' ? '' : 'none' );\r\n\r\n\t}\r\n\r\n\t// fog\r\n\r\n\tfunction onFogChanged() {\r\n\r\n\t\tsignals.sceneFogChanged.dispatch(\r\n\t\t\tfogType.getValue(),\r\n\t\t\tfogColor.getHexValue(),\r\n\t\t\tfogNear.getValue(),\r\n\t\t\tfogFar.getValue(),\r\n\t\t\tfogDensity.getValue()\r\n\t\t);\r\n\r\n\t}\r\n\r\n\tfunction onFogSettingsChanged() {\r\n\r\n\t\tsignals.sceneFogSettingsChanged.dispatch(\r\n\t\t\tfogType.getValue(),\r\n\t\t\tfogColor.getHexValue(),\r\n\t\t\tfogNear.getValue(),\r\n\t\t\tfogFar.getValue(),\r\n\t\t\tfogDensity.getValue()\r\n\t\t);\r\n\r\n\t}\r\n\r\n\tvar fogTypeRow = new UIRow();\r\n\tvar fogType = new UISelect().setOptions( {\r\n\r\n\t\t'None': '',\r\n\t\t'Fog': 'Linear',\r\n\t\t'FogExp2': 'Exponential'\r\n\r\n\t} ).setWidth( '150px' );\r\n\tfogType.onChange( function () {\r\n\r\n\t\tonFogChanged();\r\n\t\trefreshFogUI();\r\n\r\n\t} );\r\n\r\n\tfogTypeRow.add( new UIText( strings.getKey( 'sidebar/scene/fog' ) ).setWidth( '90px' ) );\r\n\tfogTypeRow.add( fogType );\r\n\r\n\tcontainer.add( fogTypeRow );\r\n\r\n\t// fog color\r\n\r\n\tvar fogPropertiesRow = new UIRow();\r\n\tfogPropertiesRow.setDisplay( 'none' );\r\n\tfogPropertiesRow.setMarginLeft( '90px' );\r\n\tcontainer.add( fogPropertiesRow );\r\n\r\n\tvar fogColor = new UIColor().setValue( '#aaaaaa' );\r\n\tfogColor.onInput( onFogSettingsChanged );\r\n\tfogPropertiesRow.add( fogColor );\r\n\r\n\t// fog near\r\n\r\n\tvar fogNear = new UINumber( 0.1 ).setWidth( '40px' ).setRange( 0, Infinity ).onChange( onFogSettingsChanged );\r\n\tfogPropertiesRow.add( fogNear );\r\n\r\n\t// fog far\r\n\r\n\tvar fogFar = new UINumber( 50 ).setWidth( '40px' ).setRange( 0, Infinity ).onChange( onFogSettingsChanged );\r\n\tfogPropertiesRow.add( fogFar );\r\n\r\n\t// fog density\r\n\r\n\tvar fogDensity = new UINumber( 0.05 ).setWidth( '40px' ).setRange( 0, 0.1 ).setStep( 0.001 ).setPrecision( 3 ).onChange( onFogSettingsChanged );\r\n\tfogPropertiesRow.add( fogDensity );\r\n\r\n\t//\r\n\r\n\tfunction refreshUI() {\r\n\r\n\t\tvar camera = editor.camera;\r\n\t\tvar scene = editor.scene;\r\n\r\n\t\tvar options = [];\r\n\r\n\t\toptions.push( buildOption( camera, false ) );\r\n\t\toptions.push( buildOption( scene, false ) );\r\n\r\n\t\t( function addObjects( objects, pad ) {\r\n\r\n\t\t\tfor ( var i = 0, l = objects.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar object = objects[ i ];\r\n\r\n\t\t\t\tif ( nodeStates.has( object ) === false ) {\r\n\r\n\t\t\t\t\tnodeStates.set( object, false );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar option = buildOption( object, true );\r\n\t\t\t\toption.style.paddingLeft = ( pad * 18 ) + 'px';\r\n\t\t\t\toptions.push( option );\r\n\r\n\t\t\t\tif ( nodeStates.get( object ) === true ) {\r\n\r\n\t\t\t\t\taddObjects( object.children, pad + 1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} )( scene.children, 0 );\r\n\r\n\t\toutliner.setOptions( options );\r\n\r\n\t\tif ( editor.selected !== null ) {\r\n\r\n\t\t\toutliner.setValue( editor.selected.id );\r\n\r\n\t\t}\r\n\r\n\t\tif ( scene.background ) {\r\n\r\n\t\t\tif ( scene.background.isColor ) {\r\n\r\n\t\t\t\tbackgroundType.setValue( 'Color' );\r\n\t\t\t\tbackgroundColor.setHexValue( scene.background.getHex() );\r\n\r\n\t\t\t} else if ( scene.background.isTexture ) {\r\n\r\n\t\t\t\tif ( scene.background.mapping === THREE.EquirectangularReflectionMapping ) {\r\n\r\n\t\t\t\t\tbackgroundType.setValue( 'Equirectangular' );\r\n\t\t\t\t\tbackgroundEquirectangularTexture.setValue( scene.background );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tbackgroundType.setValue( 'Texture' );\r\n\t\t\t\t\tbackgroundTexture.setValue( scene.background );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tbackgroundType.setValue( 'None' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( scene.environment ) {\r\n\r\n\t\t\tif ( scene.environment.mapping === THREE.EquirectangularReflectionMapping ) {\r\n\r\n\t\t\t\tenvironmentType.setValue( 'Equirectangular' );\r\n\t\t\t\tenvironmentEquirectangularTexture.setValue( scene.environment );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tenvironmentType.setValue( 'None' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( scene.fog ) {\r\n\r\n\t\t\tfogColor.setHexValue( scene.fog.color.getHex() );\r\n\r\n\t\t\tif ( scene.fog.isFog ) {\r\n\r\n\t\t\t\tfogType.setValue( 'Fog' );\r\n\t\t\t\tfogNear.setValue( scene.fog.near );\r\n\t\t\t\tfogFar.setValue( scene.fog.far );\r\n\r\n\t\t\t} else if ( scene.fog.isFogExp2 ) {\r\n\r\n\t\t\t\tfogType.setValue( 'FogExp2' );\r\n\t\t\t\tfogDensity.setValue( scene.fog.density );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfogType.setValue( 'None' );\r\n\r\n\t\t}\r\n\r\n\t\trefreshBackgroundUI();\r\n\t\trefreshEnvironmentUI();\r\n\t\trefreshFogUI();\r\n\r\n\t}\r\n\r\n\tfunction refreshFogUI() {\r\n\r\n\t\tvar type = fogType.getValue();\r\n\r\n\t\tfogPropertiesRow.setDisplay( type === 'None' ? 'none' : '' );\r\n\t\tfogNear.setDisplay( type === 'Fog' ? '' : 'none' );\r\n\t\tfogFar.setDisplay( type === 'Fog' ? '' : 'none' );\r\n\t\tfogDensity.setDisplay( type === 'FogExp2' ? '' : 'none' );\r\n\r\n\t}\r\n\r\n\trefreshUI();\r\n\r\n\t// events\r\n\r\n\tsignals.editorCleared.add( refreshUI );\r\n\r\n\tsignals.sceneGraphChanged.add( refreshUI );\r\n\r\n\t/*\r\n\tsignals.objectChanged.add( function ( object ) {\r\n\r\n\t\tvar options = outliner.options;\r\n\r\n\t\tfor ( var i = 0; i < options.length; i ++ ) {\r\n\r\n\t\t\tvar option = options[ i ];\r\n\r\n\t\t\tif ( option.value === object.id ) {\r\n\r\n\t\t\t\toption.innerHTML = buildHTML( object );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\t*/\r\n\r\n\tsignals.objectSelected.add( function ( object ) {\r\n\r\n\t\tif ( ignoreObjectSelectedSignal === true ) return;\r\n\r\n\t\tif ( object !== null && object.parent !== null ) {\r\n\r\n\t\t\tlet needsRefresh = false;\r\n\t\t\tlet parent = object.parent;\r\n\r\n\t\t\twhile ( parent !== editor.scene ) {\r\n\r\n\t\t\t\tif ( nodeStates.get( parent ) !== true ) {\r\n\r\n\t\t\t\t\tnodeStates.set( parent, true );\r\n\t\t\t\t\tneedsRefresh = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tparent = parent.parent;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( needsRefresh ) refreshUI();\r\n\r\n\t\t\toutliner.setValue( object.id );\r\n\r\n\t\t} else {\r\n\r\n\t\t\toutliner.setValue( null );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarScene };\r\n","import * as THREE from 'three'\r\n\r\nimport { UIPanel, UIRow, UIInput, UIButton, UIColor, UICheckbox, UIInteger, UITextArea, UIText, UINumber } from './libs/ui.js';\r\nimport { UIBoolean } from './libs/ui.three.js';\r\n\r\nimport { SetUuidCommand } from './commands/SetUuidCommand.js';\r\nimport { SetValueCommand } from './commands/SetValueCommand.js';\r\nimport { SetPositionCommand } from './commands/SetPositionCommand.js';\r\nimport { SetRotationCommand } from './commands/SetRotationCommand.js';\r\nimport { SetScaleCommand } from './commands/SetScaleCommand.js';\r\nimport { SetColorCommand } from './commands/SetColorCommand.js';\r\n\r\nfunction SidebarObject( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar signals = editor.signals;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setBorderTop( '0' );\r\n\tcontainer.setPaddingTop( '20px' );\r\n\tcontainer.setDisplay( 'none' );\r\n\r\n\t// Actions\r\n\r\n\t/*\r\n\tvar objectActions = new UI.Select().setPosition( 'absolute' ).setRight( '8px' ).setFontSize( '11px' );\r\n\tobjectActions.setOptions( {\r\n\r\n\t\t'Actions': 'Actions',\r\n\t\t'Reset Position': 'Reset Position',\r\n\t\t'Reset Rotation': 'Reset Rotation',\r\n\t\t'Reset Scale': 'Reset Scale'\r\n\r\n\t} );\r\n\tobjectActions.onClick( function ( event ) {\r\n\r\n\t\tevent.stopPropagation(); // Avoid panel collapsing\r\n\r\n\t} );\r\n\tobjectActions.onChange( function ( event ) {\r\n\r\n\t\tvar object = editor.selected;\r\n\r\n\t\tswitch ( this.getValue() ) {\r\n\r\n\t\t\tcase 'Reset Position':\r\n\t\t\t\teditor.execute( new SetPositionCommand( editor, object, new Vector3( 0, 0, 0 ) ) );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'Reset Rotation':\r\n\t\t\t\teditor.execute( new SetRotationCommand( editor, object, new Euler( 0, 0, 0 ) ) );\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'Reset Scale':\r\n\t\t\t\teditor.execute( new SetScaleCommand( editor, object, new Vector3( 1, 1, 1 ) ) );\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tthis.setValue( 'Actions' );\r\n\r\n\t} );\r\n\tcontainer.addStatic( objectActions );\r\n\t*/\r\n\r\n\t// type\r\n\r\n\tvar objectTypeRow = new UIRow();\r\n\tvar objectType = new UIText();\r\n\r\n\tobjectTypeRow.add( new UIText( strings.getKey( 'sidebar/object/type' ) ).setWidth( '90px' ) );\r\n\tobjectTypeRow.add( objectType );\r\n\r\n\tcontainer.add( objectTypeRow );\r\n\r\n\t// uuid\r\n\r\n\tvar objectUUIDRow = new UIRow();\r\n\tvar objectUUID = new UIInput().setWidth( '102px' ).setFontSize( '12px' ).setDisabled( true );\r\n\tvar objectUUIDRenew = new UIButton( strings.getKey( 'sidebar/object/new' ) ).setMarginLeft( '7px' ).onClick( function () {\r\n\r\n\t\tobjectUUID.setValue( THREE.MathUtils.generateUUID() );\r\n\r\n\t\teditor.execute( new SetUuidCommand( editor, editor.selected, objectUUID.getValue() ) );\r\n\r\n\t} );\r\n\r\n\tobjectUUIDRow.add( new UIText( strings.getKey( 'sidebar/object/uuid' ) ).setWidth( '90px' ) );\r\n\tobjectUUIDRow.add( objectUUID );\r\n\tobjectUUIDRow.add( objectUUIDRenew );\r\n\r\n\tcontainer.add( objectUUIDRow );\r\n\r\n\t// name\r\n\r\n\tvar objectNameRow = new UIRow();\r\n\tvar objectName = new UIInput().setWidth( '150px' ).setFontSize( '12px' ).onChange( function () {\r\n\r\n\t\teditor.execute( new SetValueCommand( editor, editor.selected, 'name', objectName.getValue() ) );\r\n\r\n\t} );\r\n\r\n\tobjectNameRow.add( new UIText( strings.getKey( 'sidebar/object/name' ) ).setWidth( '90px' ) );\r\n\tobjectNameRow.add( objectName );\r\n\r\n\tcontainer.add( objectNameRow );\r\n\r\n\t// position\r\n\r\n\tvar objectPositionRow = new UIRow();\r\n\tvar objectPositionX = new UINumber().setPrecision( 3 ).setWidth( '50px' ).onChange( update );\r\n\tvar objectPositionY = new UINumber().setPrecision( 3 ).setWidth( '50px' ).onChange( update );\r\n\tvar objectPositionZ = new UINumber().setPrecision( 3 ).setWidth( '50px' ).onChange( update );\r\n\r\n\tobjectPositionRow.add( new UIText( strings.getKey( 'sidebar/object/position' ) ).setWidth( '90px' ) );\r\n\tobjectPositionRow.add( objectPositionX, objectPositionY, objectPositionZ );\r\n\r\n\tcontainer.add( objectPositionRow );\r\n\r\n\t// rotation\r\n\r\n\tvar objectRotationRow = new UIRow();\r\n\tvar objectRotationX = new UINumber().setStep( 10 ).setNudge( 0.1 ).setUnit( '°' ).setWidth( '50px' ).onChange( update );\r\n\tvar objectRotationY = new UINumber().setStep( 10 ).setNudge( 0.1 ).setUnit( '°' ).setWidth( '50px' ).onChange( update );\r\n\tvar objectRotationZ = new UINumber().setStep( 10 ).setNudge( 0.1 ).setUnit( '°' ).setWidth( '50px' ).onChange( update );\r\n\r\n\tobjectRotationRow.add( new UIText( strings.getKey( 'sidebar/object/rotation' ) ).setWidth( '90px' ) );\r\n\tobjectRotationRow.add( objectRotationX, objectRotationY, objectRotationZ );\r\n\r\n\tcontainer.add( objectRotationRow );\r\n\r\n\t// scale\r\n\r\n\tvar objectScaleRow = new UIRow();\r\n\tvar objectScaleX = new UINumber( 1 ).setPrecision( 3 ).setWidth( '50px' ).onChange( update );\r\n\tvar objectScaleY = new UINumber( 1 ).setPrecision( 3 ).setWidth( '50px' ).onChange( update );\r\n\tvar objectScaleZ = new UINumber( 1 ).setPrecision( 3 ).setWidth( '50px' ).onChange( update );\r\n\r\n\tobjectScaleRow.add( new UIText( strings.getKey( 'sidebar/object/scale' ) ).setWidth( '90px' ) );\r\n\tobjectScaleRow.add( objectScaleX, objectScaleY, objectScaleZ );\r\n\r\n\tcontainer.add( objectScaleRow );\r\n\r\n\t// fov\r\n\r\n\tvar objectFovRow = new UIRow();\r\n\tvar objectFov = new UINumber().onChange( update );\r\n\r\n\tobjectFovRow.add( new UIText( strings.getKey( 'sidebar/object/fov' ) ).setWidth( '90px' ) );\r\n\tobjectFovRow.add( objectFov );\r\n\r\n\tcontainer.add( objectFovRow );\r\n\r\n\t// left\r\n\r\n\tvar objectLeftRow = new UIRow();\r\n\tvar objectLeft = new UINumber().onChange( update );\r\n\r\n\tobjectLeftRow.add( new UIText( strings.getKey( 'sidebar/object/left' ) ).setWidth( '90px' ) );\r\n\tobjectLeftRow.add( objectLeft );\r\n\r\n\tcontainer.add( objectLeftRow );\r\n\r\n\t// right\r\n\r\n\tvar objectRightRow = new UIRow();\r\n\tvar objectRight = new UINumber().onChange( update );\r\n\r\n\tobjectRightRow.add( new UIText( strings.getKey( 'sidebar/object/right' ) ).setWidth( '90px' ) );\r\n\tobjectRightRow.add( objectRight );\r\n\r\n\tcontainer.add( objectRightRow );\r\n\r\n\t// top\r\n\r\n\tvar objectTopRow = new UIRow();\r\n\tvar objectTop = new UINumber().onChange( update );\r\n\r\n\tobjectTopRow.add( new UIText( strings.getKey( 'sidebar/object/top' ) ).setWidth( '90px' ) );\r\n\tobjectTopRow.add( objectTop );\r\n\r\n\tcontainer.add( objectTopRow );\r\n\r\n\t// bottom\r\n\r\n\tvar objectBottomRow = new UIRow();\r\n\tvar objectBottom = new UINumber().onChange( update );\r\n\r\n\tobjectBottomRow.add( new UIText( strings.getKey( 'sidebar/object/bottom' ) ).setWidth( '90px' ) );\r\n\tobjectBottomRow.add( objectBottom );\r\n\r\n\tcontainer.add( objectBottomRow );\r\n\r\n\t// near\r\n\r\n\tvar objectNearRow = new UIRow();\r\n\tvar objectNear = new UINumber().onChange( update );\r\n\r\n\tobjectNearRow.add( new UIText( strings.getKey( 'sidebar/object/near' ) ).setWidth( '90px' ) );\r\n\tobjectNearRow.add( objectNear );\r\n\r\n\tcontainer.add( objectNearRow );\r\n\r\n\t// far\r\n\r\n\tvar objectFarRow = new UIRow();\r\n\tvar objectFar = new UINumber().onChange( update );\r\n\r\n\tobjectFarRow.add( new UIText( strings.getKey( 'sidebar/object/far' ) ).setWidth( '90px' ) );\r\n\tobjectFarRow.add( objectFar );\r\n\r\n\tcontainer.add( objectFarRow );\r\n\r\n\t// intensity\r\n\r\n\tvar objectIntensityRow = new UIRow();\r\n\tvar objectIntensity = new UINumber().onChange( update );\r\n\r\n\tobjectIntensityRow.add( new UIText( strings.getKey( 'sidebar/object/intensity' ) ).setWidth( '90px' ) );\r\n\tobjectIntensityRow.add( objectIntensity );\r\n\r\n\tcontainer.add( objectIntensityRow );\r\n\r\n\t// color\r\n\r\n\tvar objectColorRow = new UIRow();\r\n\tvar objectColor = new UIColor().onInput( update );\r\n\r\n\tobjectColorRow.add( new UIText( strings.getKey( 'sidebar/object/color' ) ).setWidth( '90px' ) );\r\n\tobjectColorRow.add( objectColor );\r\n\r\n\tcontainer.add( objectColorRow );\r\n\r\n\t// ground color\r\n\r\n\tvar objectGroundColorRow = new UIRow();\r\n\tvar objectGroundColor = new UIColor().onInput( update );\r\n\r\n\tobjectGroundColorRow.add( new UIText( strings.getKey( 'sidebar/object/groundcolor' ) ).setWidth( '90px' ) );\r\n\tobjectGroundColorRow.add( objectGroundColor );\r\n\r\n\tcontainer.add( objectGroundColorRow );\r\n\r\n\t// distance\r\n\r\n\tvar objectDistanceRow = new UIRow();\r\n\tvar objectDistance = new UINumber().setRange( 0, Infinity ).onChange( update );\r\n\r\n\tobjectDistanceRow.add( new UIText( strings.getKey( 'sidebar/object/distance' ) ).setWidth( '90px' ) );\r\n\tobjectDistanceRow.add( objectDistance );\r\n\r\n\tcontainer.add( objectDistanceRow );\r\n\r\n\t// angle\r\n\r\n\tvar objectAngleRow = new UIRow();\r\n\tvar objectAngle = new UINumber().setPrecision( 3 ).setRange( 0, Math.PI / 2 ).onChange( update );\r\n\r\n\tobjectAngleRow.add( new UIText( strings.getKey( 'sidebar/object/angle' ) ).setWidth( '90px' ) );\r\n\tobjectAngleRow.add( objectAngle );\r\n\r\n\tcontainer.add( objectAngleRow );\r\n\r\n\t// penumbra\r\n\r\n\tvar objectPenumbraRow = new UIRow();\r\n\tvar objectPenumbra = new UINumber().setRange( 0, 1 ).onChange( update );\r\n\r\n\tobjectPenumbraRow.add( new UIText( strings.getKey( 'sidebar/object/penumbra' ) ).setWidth( '90px' ) );\r\n\tobjectPenumbraRow.add( objectPenumbra );\r\n\r\n\tcontainer.add( objectPenumbraRow );\r\n\r\n\t// decay\r\n\r\n\tvar objectDecayRow = new UIRow();\r\n\tvar objectDecay = new UINumber().setRange( 0, Infinity ).onChange( update );\r\n\r\n\tobjectDecayRow.add( new UIText( strings.getKey( 'sidebar/object/decay' ) ).setWidth( '90px' ) );\r\n\tobjectDecayRow.add( objectDecay );\r\n\r\n\tcontainer.add( objectDecayRow );\r\n\r\n\t// shadow\r\n\r\n\tvar objectShadowRow = new UIRow();\r\n\r\n\tobjectShadowRow.add( new UIText( strings.getKey( 'sidebar/object/shadow' ) ).setWidth( '90px' ) );\r\n\r\n\tvar objectCastShadow = new UIBoolean( false, strings.getKey( 'sidebar/object/cast' ) ).onChange( update );\r\n\tobjectShadowRow.add( objectCastShadow );\r\n\r\n\tvar objectReceiveShadow = new UIBoolean( false, strings.getKey( 'sidebar/object/receive' ) ).onChange( update );\r\n\tobjectShadowRow.add( objectReceiveShadow );\r\n\r\n\tcontainer.add( objectShadowRow );\r\n\r\n\t// shadow bias\r\n\r\n\tvar objectShadowBiasRow = new UIRow();\r\n\r\n\tobjectShadowBiasRow.add( new UIText( strings.getKey( 'sidebar/object/shadowBias' ) ).setWidth( '90px' ) );\r\n\r\n\tvar objectShadowBias = new UINumber( 0 ).setPrecision( 5 ).setStep( 0.0001 ).setNudge( 0.00001 ).onChange( update );\r\n\tobjectShadowBiasRow.add( objectShadowBias );\r\n\r\n\tcontainer.add( objectShadowBiasRow );\r\n\r\n\t// shadow normal offset\r\n\r\n\tvar objectShadowNormalBiasRow = new UIRow();\r\n\r\n\tobjectShadowNormalBiasRow.add( new UIText( strings.getKey( 'sidebar/object/shadowNormalBias' ) ).setWidth( '90px' ) );\r\n\r\n\tvar objectShadowNormalBias = new UINumber( 0 ).onChange( update );\r\n\tobjectShadowNormalBiasRow.add( objectShadowNormalBias );\r\n\r\n\tcontainer.add( objectShadowNormalBiasRow );\r\n\r\n\t// shadow radius\r\n\r\n\tvar objectShadowRadiusRow = new UIRow();\r\n\r\n\tobjectShadowRadiusRow.add( new UIText( strings.getKey( 'sidebar/object/shadowRadius' ) ).setWidth( '90px' ) );\r\n\r\n\tvar objectShadowRadius = new UINumber( 1 ).onChange( update );\r\n\tobjectShadowRadiusRow.add( objectShadowRadius );\r\n\r\n\tcontainer.add( objectShadowRadiusRow );\r\n\r\n\t// visible\r\n\r\n\tvar objectVisibleRow = new UIRow();\r\n\tvar objectVisible = new UICheckbox().onChange( update );\r\n\r\n\tobjectVisibleRow.add( new UIText( strings.getKey( 'sidebar/object/visible' ) ).setWidth( '90px' ) );\r\n\tobjectVisibleRow.add( objectVisible );\r\n\r\n\tcontainer.add( objectVisibleRow );\r\n\r\n\t// frustumCulled\r\n\r\n\tvar objectFrustumCulledRow = new UIRow();\r\n\tvar objectFrustumCulled = new UICheckbox().onChange( update );\r\n\r\n\tobjectFrustumCulledRow.add( new UIText( strings.getKey( 'sidebar/object/frustumcull' ) ).setWidth( '90px' ) );\r\n\tobjectFrustumCulledRow.add( objectFrustumCulled );\r\n\r\n\tcontainer.add( objectFrustumCulledRow );\r\n\r\n\t// renderOrder\r\n\r\n\tvar objectRenderOrderRow = new UIRow();\r\n\tvar objectRenderOrder = new UIInteger().setWidth( '50px' ).onChange( update );\r\n\r\n\tobjectRenderOrderRow.add( new UIText( strings.getKey( 'sidebar/object/renderorder' ) ).setWidth( '90px' ) );\r\n\tobjectRenderOrderRow.add( objectRenderOrder );\r\n\r\n\tcontainer.add( objectRenderOrderRow );\r\n\r\n\t// user data\r\n\r\n\tvar objectUserDataRow = new UIRow();\r\n\tvar objectUserData = new UITextArea().setWidth( '150px' ).setHeight( '40px' ).setFontSize( '12px' ).onChange( update );\r\n\tobjectUserData.onKeyUp( function () {\r\n\r\n\t\ttry {\r\n\r\n\t\t\tJSON.parse( objectUserData.getValue() );\r\n\r\n\t\t\tobjectUserData.dom.classList.add( 'success' );\r\n\t\t\tobjectUserData.dom.classList.remove( 'fail' );\r\n\r\n\t\t} catch ( error ) {\r\n\r\n\t\t\tobjectUserData.dom.classList.remove( 'success' );\r\n\t\t\tobjectUserData.dom.classList.add( 'fail' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tobjectUserDataRow.add( new UIText( strings.getKey( 'sidebar/object/userdata' ) ).setWidth( '90px' ) );\r\n\tobjectUserDataRow.add( objectUserData );\r\n\r\n\tcontainer.add( objectUserDataRow );\r\n\r\n\r\n\t//\r\n\r\n\tfunction update() {\r\n\r\n\t\tvar object = editor.selected;\r\n\r\n\t\tif ( object !== null ) {\r\n\r\n\t\t\tvar newPosition = new THREE.Vector3( objectPositionX.getValue(), objectPositionY.getValue(), objectPositionZ.getValue() );\r\n\t\t\tif ( object.position.distanceTo( newPosition ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetPositionCommand( editor, object, newPosition ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar newRotation = new THREE.Euler( objectRotationX.getValue() * THREE.MathUtils.DEG2RAD, objectRotationY.getValue() * THREE.MathUtils.DEG2RAD, objectRotationZ.getValue() * THREE.MathUtils.DEG2RAD );\r\n\t\t\tif ( object.rotation.toVector3().distanceTo( newRotation.toVector3() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetRotationCommand( editor, object, newRotation ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar newScale = new THREE.Vector3( objectScaleX.getValue(), objectScaleY.getValue(), objectScaleZ.getValue() );\r\n\t\t\tif ( object.scale.distanceTo( newScale ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetScaleCommand( editor, object, newScale ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.fov !== undefined && Math.abs( object.fov - objectFov.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'fov', objectFov.getValue() ) );\r\n\t\t\t\tobject.updateProjectionMatrix();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.left !== undefined && Math.abs( object.left - objectLeft.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'left', objectLeft.getValue() ) );\r\n\t\t\t\tobject.updateProjectionMatrix();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.right !== undefined && Math.abs( object.right - objectRight.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'right', objectRight.getValue() ) );\r\n\t\t\t\tobject.updateProjectionMatrix();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.top !== undefined && Math.abs( object.top - objectTop.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'top', objectTop.getValue() ) );\r\n\t\t\t\tobject.updateProjectionMatrix();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.bottom !== undefined && Math.abs( object.bottom - objectBottom.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'bottom', objectBottom.getValue() ) );\r\n\t\t\t\tobject.updateProjectionMatrix();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.near !== undefined && Math.abs( object.near - objectNear.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'near', objectNear.getValue() ) );\r\n\t\t\t\tif ( object.isOrthographicCamera ) {\r\n\r\n\t\t\t\t\tobject.updateProjectionMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.far !== undefined && Math.abs( object.far - objectFar.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'far', objectFar.getValue() ) );\r\n\t\t\t\tif ( object.isOrthographicCamera ) {\r\n\r\n\t\t\t\t\tobject.updateProjectionMatrix();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.intensity !== undefined && Math.abs( object.intensity - objectIntensity.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'intensity', objectIntensity.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.color !== undefined && object.color.getHex() !== objectColor.getHexValue() ) {\r\n\r\n\t\t\t\teditor.execute( new SetColorCommand( editor, object, 'color', objectColor.getHexValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.groundColor !== undefined && object.groundColor.getHex() !== objectGroundColor.getHexValue() ) {\r\n\r\n\t\t\t\teditor.execute( new SetColorCommand( editor, object, 'groundColor', objectGroundColor.getHexValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.distance !== undefined && Math.abs( object.distance - objectDistance.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'distance', objectDistance.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.angle !== undefined && Math.abs( object.angle - objectAngle.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'angle', objectAngle.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.penumbra !== undefined && Math.abs( object.penumbra - objectPenumbra.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'penumbra', objectPenumbra.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.decay !== undefined && Math.abs( object.decay - objectDecay.getValue() ) >= 0.01 ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'decay', objectDecay.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.visible !== objectVisible.getValue() ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'visible', objectVisible.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.frustumCulled !== objectFrustumCulled.getValue() ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'frustumCulled', objectFrustumCulled.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.renderOrder !== objectRenderOrder.getValue() ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'renderOrder', objectRenderOrder.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.castShadow !== undefined && object.castShadow !== objectCastShadow.getValue() ) {\r\n\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'castShadow', objectCastShadow.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.receiveShadow !== objectReceiveShadow.getValue() ) {\r\n\r\n\t\t\t\tif ( object.material !== undefined ) object.material.needsUpdate = true;\r\n\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'receiveShadow', objectReceiveShadow.getValue() ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( object.shadow !== undefined ) {\r\n\r\n\t\t\t\tif ( object.shadow.bias !== objectShadowBias.getValue() ) {\r\n\r\n\t\t\t\t\teditor.execute( new SetValueCommand( editor, object.shadow, 'bias', objectShadowBias.getValue() ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( object.shadow.normalBias !== objectShadowNormalBias.getValue() ) {\r\n\r\n\t\t\t\t\teditor.execute( new SetValueCommand( editor, object.shadow, 'normalBias', objectShadowNormalBias.getValue() ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( object.shadow.radius !== objectShadowRadius.getValue() ) {\r\n\r\n\t\t\t\t\teditor.execute( new SetValueCommand( editor, object.shadow, 'radius', objectShadowRadius.getValue() ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tvar userData = JSON.parse( objectUserData.getValue() );\r\n\t\t\t\tif ( JSON.stringify( object.userData ) != JSON.stringify( userData ) ) {\r\n\r\n\t\t\t\t\teditor.execute( new SetValueCommand( editor, object, 'userData', userData ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} catch ( exception ) {\r\n\r\n\t\t\t\tconsole.warn( exception );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction updateRows( object ) {\r\n\r\n\t\tvar properties = {\r\n\t\t\t'fov': objectFovRow,\r\n\t\t\t'left': objectLeftRow,\r\n\t\t\t'right': objectRightRow,\r\n\t\t\t'top': objectTopRow,\r\n\t\t\t'bottom': objectBottomRow,\r\n\t\t\t'near': objectNearRow,\r\n\t\t\t'far': objectFarRow,\r\n\t\t\t'intensity': objectIntensityRow,\r\n\t\t\t'color': objectColorRow,\r\n\t\t\t'groundColor': objectGroundColorRow,\r\n\t\t\t'distance': objectDistanceRow,\r\n\t\t\t'angle': objectAngleRow,\r\n\t\t\t'penumbra': objectPenumbraRow,\r\n\t\t\t'decay': objectDecayRow,\r\n\t\t\t'castShadow': objectShadowRow,\r\n\t\t\t'receiveShadow': objectReceiveShadow,\r\n\t\t\t'shadow': [ objectShadowBiasRow, objectShadowNormalBiasRow, objectShadowRadiusRow ]\r\n\t\t};\r\n\r\n\t\tfor ( var property in properties ) {\r\n\r\n\t\t\tvar uiElement = properties[ property ];\r\n\r\n\t\t\tif ( Array.isArray( uiElement ) === true ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < uiElement.length; i ++ ) {\r\n\r\n\t\t\t\t\tuiElement[ i ].setDisplay( object[ property ] !== undefined ? '' : 'none' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tuiElement.setDisplay( object[ property ] !== undefined ? '' : 'none' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tif ( object.isLight ) {\r\n\r\n\t\t\tobjectReceiveShadow.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.isAmbientLight || object.isHemisphereLight ) {\r\n\r\n\t\t\tobjectShadowRow.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction updateTransformRows( object ) {\r\n\r\n\t\tif ( object.isLight ||\r\n\t\t   ( object.isObject3D && object.userData.targetInverse ) ) {\r\n\r\n\t\t\tobjectRotationRow.setDisplay( 'none' );\r\n\t\t\tobjectScaleRow.setDisplay( 'none' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tobjectRotationRow.setDisplay( '' );\r\n\t\t\tobjectScaleRow.setDisplay( '' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t// events\r\n\r\n\tsignals.objectSelected.add( function ( object ) {\r\n\r\n\t\tif ( object !== null ) {\r\n\r\n\t\t\tcontainer.setDisplay( 'block' );\r\n\r\n\t\t\tupdateRows( object );\r\n\t\t\tupdateUI( object );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcontainer.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tsignals.objectChanged.add( function ( object ) {\r\n\r\n\t\tif ( object !== editor.selected ) return;\r\n\r\n\t\tupdateUI( object );\r\n\r\n\t} );\r\n\r\n\tsignals.refreshSidebarObject3D.add( function ( object ) {\r\n\r\n\t\tif ( object !== editor.selected ) return;\r\n\r\n\t\tupdateUI( object );\r\n\r\n\t} );\r\n\r\n\tfunction updateUI( object ) {\r\n\r\n\t\tobjectType.setValue( object.type );\r\n\r\n\t\tobjectUUID.setValue( object.uuid );\r\n\t\tobjectName.setValue( object.name );\r\n\r\n\t\tobjectPositionX.setValue( object.position.x );\r\n\t\tobjectPositionY.setValue( object.position.y );\r\n\t\tobjectPositionZ.setValue( object.position.z );\r\n\r\n\t\tobjectRotationX.setValue( object.rotation.x * THREE.MathUtils.RAD2DEG );\r\n\t\tobjectRotationY.setValue( object.rotation.y * THREE.MathUtils.RAD2DEG );\r\n\t\tobjectRotationZ.setValue( object.rotation.z * THREE.MathUtils.RAD2DEG );\r\n\r\n\t\tobjectScaleX.setValue( object.scale.x );\r\n\t\tobjectScaleY.setValue( object.scale.y );\r\n\t\tobjectScaleZ.setValue( object.scale.z );\r\n\r\n\t\tif ( object.fov !== undefined ) {\r\n\r\n\t\t\tobjectFov.setValue( object.fov );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.left !== undefined ) {\r\n\r\n\t\t\tobjectLeft.setValue( object.left );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.right !== undefined ) {\r\n\r\n\t\t\tobjectRight.setValue( object.right );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.top !== undefined ) {\r\n\r\n\t\t\tobjectTop.setValue( object.top );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.bottom !== undefined ) {\r\n\r\n\t\t\tobjectBottom.setValue( object.bottom );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.near !== undefined ) {\r\n\r\n\t\t\tobjectNear.setValue( object.near );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.far !== undefined ) {\r\n\r\n\t\t\tobjectFar.setValue( object.far );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.intensity !== undefined ) {\r\n\r\n\t\t\tobjectIntensity.setValue( object.intensity );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.color !== undefined ) {\r\n\r\n\t\t\tobjectColor.setHexValue( object.color.getHexString() );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.groundColor !== undefined ) {\r\n\r\n\t\t\tobjectGroundColor.setHexValue( object.groundColor.getHexString() );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.distance !== undefined ) {\r\n\r\n\t\t\tobjectDistance.setValue( object.distance );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.angle !== undefined ) {\r\n\r\n\t\t\tobjectAngle.setValue( object.angle );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.penumbra !== undefined ) {\r\n\r\n\t\t\tobjectPenumbra.setValue( object.penumbra );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.decay !== undefined ) {\r\n\r\n\t\t\tobjectDecay.setValue( object.decay );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.castShadow !== undefined ) {\r\n\r\n\t\t\tobjectCastShadow.setValue( object.castShadow );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.receiveShadow !== undefined ) {\r\n\r\n\t\t\tobjectReceiveShadow.setValue( object.receiveShadow );\r\n\r\n\t\t}\r\n\r\n\t\tif ( object.shadow !== undefined ) {\r\n\r\n\t\t\tobjectShadowBias.setValue( object.shadow.bias );\r\n\t\t\tobjectShadowNormalBias.setValue( object.shadow.normalBias );\r\n\t\t\tobjectShadowRadius.setValue( object.shadow.radius );\r\n\r\n\t\t}\r\n\r\n\t\tobjectVisible.setValue( object.visible );\r\n\t\tobjectFrustumCulled.setValue( object.frustumCulled );\r\n\t\tobjectRenderOrder.setValue( object.renderOrder );\r\n\r\n\t\ttry {\r\n\r\n\t\t\tobjectUserData.setValue( JSON.stringify( object.userData, null, '  ' ) );\r\n\r\n\t\t} catch ( error ) {\r\n\r\n\t\t\tconsole.log( error );\r\n\r\n\t\t}\r\n\r\n\t\tobjectUserData.setBorderColor( 'transparent' );\r\n\t\tobjectUserData.setBackgroundColor( '' );\r\n\r\n\t\tupdateTransformRows( object );\r\n\r\n\t}\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarObject };\r\n","import {\r\n\tBufferGeometry,\r\n\tFloat32BufferAttribute,\r\n\tLineSegments,\r\n\tLineBasicMaterial,\r\n\tMatrix3,\r\n\tVector3\r\n} from 'three';\r\n\r\nconst _v1 = new Vector3();\r\nconst _v2 = new Vector3();\r\nconst _normalMatrix = new Matrix3();\r\n\r\nclass VertexNormalsHelper extends LineSegments {\r\n\r\n\tconstructor( object, size = 1, color = 0xff0000 ) {\r\n\r\n\t\tlet nNormals = 0;\r\n\r\n\t\tconst objGeometry = object.geometry;\r\n\r\n\t\tif ( objGeometry && objGeometry.isGeometry ) {\r\n\r\n\t\t\tconsole.error( 'THREE.VertexNormalsHelper no longer supports Geometry. Use BufferGeometry instead.' );\r\n\t\t\treturn;\r\n\r\n\t\t} else if ( objGeometry && objGeometry.isBufferGeometry ) {\r\n\r\n\t\t\tnNormals = objGeometry.attributes.normal.count;\r\n\r\n\t\t}\r\n\r\n\t\t//\r\n\r\n\t\tconst geometry = new BufferGeometry();\r\n\r\n\t\tconst positions = new Float32BufferAttribute( nNormals * 2 * 3, 3 );\r\n\r\n\t\tgeometry.setAttribute( 'position', positions );\r\n\r\n\t\tsuper( geometry, new LineBasicMaterial( { color, toneMapped: false } ) );\r\n\r\n\t\tthis.object = object;\r\n\t\tthis.size = size;\r\n\t\tthis.type = 'VertexNormalsHelper';\r\n\r\n\t\t//\r\n\r\n\t\tthis.matrixAutoUpdate = false;\r\n\r\n\t\tthis.update();\r\n\r\n\t}\r\n\r\n\tupdate() {\r\n\r\n\t\tthis.object.updateMatrixWorld( true );\r\n\r\n\t\t_normalMatrix.getNormalMatrix( this.object.matrixWorld );\r\n\r\n\t\tconst matrixWorld = this.object.matrixWorld;\r\n\r\n\t\tconst position = this.geometry.attributes.position;\r\n\r\n\t\t//\r\n\r\n\t\tconst objGeometry = this.object.geometry;\r\n\r\n\t\tif ( objGeometry && objGeometry.isGeometry ) {\r\n\r\n\t\t\tconsole.error( 'THREE.VertexNormalsHelper no longer supports Geometry. Use BufferGeometry instead.' );\r\n\t\t\treturn;\r\n\r\n\t\t} else if ( objGeometry && objGeometry.isBufferGeometry ) {\r\n\r\n\t\t\tconst objPos = objGeometry.attributes.position;\r\n\r\n\t\t\tconst objNorm = objGeometry.attributes.normal;\r\n\r\n\t\t\tlet idx = 0;\r\n\r\n\t\t\t// for simplicity, ignore index and drawcalls, and render every normal\r\n\r\n\t\t\tfor ( let j = 0, jl = objPos.count; j < jl; j ++ ) {\r\n\r\n\t\t\t\t_v1.set( objPos.getX( j ), objPos.getY( j ), objPos.getZ( j ) ).applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\t_v2.set( objNorm.getX( j ), objNorm.getY( j ), objNorm.getZ( j ) );\r\n\r\n\t\t\t\t_v2.applyMatrix3( _normalMatrix ).normalize().multiplyScalar( this.size ).add( _v1 );\r\n\r\n\t\t\t\tposition.setXYZ( idx, _v1.x, _v1.y, _v1.z );\r\n\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t\tposition.setXYZ( idx, _v2.x, _v2.y, _v2.z );\r\n\r\n\t\t\t\tidx = idx + 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tposition.needsUpdate = true;\r\n\r\n\t}\r\n\r\n}\r\n\r\n\r\nexport { VertexNormalsHelper };\r\n","import * as THREE from 'three'\r\n\r\nimport { UIPanel, UIRow, UIText, UIInput, UIButton, UISpan } from './libs/ui.js';\r\n\r\nimport { SetGeometryValueCommand } from './commands/SetGeometryValueCommand.js';\r\n\r\nimport { SidebarGeometryBufferGeometry } from './Sidebar.Geometry.BufferGeometry.js';\r\nimport { SidebarGeometryModifiers } from './Sidebar.Geometry.Modifiers.js';\r\n\r\nimport { VertexNormalsHelper } from './libs/helpers/VertexNormalsHelper.js';\r\n\r\nfunction SidebarGeometry( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar signals = editor.signals;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setBorderTop( '0' );\r\n\tcontainer.setDisplay( 'none' );\r\n\tcontainer.setPaddingTop( '20px' );\r\n\r\n\tvar currentGeometryType = null;\r\n\r\n\t// Actions\r\n\r\n\t/*\r\n\tvar objectActions = new UISelect().setPosition( 'absolute' ).setRight( '8px' ).setFontSize( '11px' );\r\n\tobjectActions.setOptions( {\r\n\r\n\t\t'Actions': 'Actions',\r\n\t\t'Center': 'Center',\r\n\t\t'Convert': 'Convert',\r\n\t\t'Flatten': 'Flatten'\r\n\r\n\t} );\r\n\tobjectActions.onClick( function ( event ) {\r\n\r\n\t\tevent.stopPropagation(); // Avoid panel collapsing\r\n\r\n\t} );\r\n\tobjectActions.onChange( function ( event ) {\r\n\r\n\t\tvar action = this.getValue();\r\n\r\n\t\tvar object = editor.selected;\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( confirm( action + ' ' + object.name + '?' ) === false ) return;\r\n\r\n\t\tswitch ( action ) {\r\n\r\n\t\t\tcase 'Center':\r\n\r\n\t\t\t\tvar offset = geometry.center();\r\n\r\n\t\t\t\tvar newPosition = object.position.clone();\r\n\t\t\t\tnewPosition.sub( offset );\r\n\t\t\t\teditor.execute( new SetPositionCommand( editor, object, newPosition ) );\r\n\r\n\t\t\t\teditor.signals.geometryChanged.dispatch( object );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'Convert':\r\n\r\n\t\t\t\tif ( geometry && geometry.isGeometry ) {\r\n\r\n\t\t\t\t\teditor.execute( new SetGeometryCommand( editor, object, new THREE.BufferGeometry().fromGeometry( geometry ) ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 'Flatten':\r\n\r\n\t\t\t\tvar newGeometry = geometry.clone();\r\n\t\t\t\tnewGeometry.uuid = geometry.uuid;\r\n\t\t\t\tnewGeometry.applyMatrix( object.matrix );\r\n\r\n\t\t\t\tvar cmds = [ new SetGeometryCommand( editor, object, newGeometry ),\r\n\t\t\t\t\tnew SetPositionCommand( editor, object, new THREE.Vector3( 0, 0, 0 ) ),\r\n\t\t\t\t\tnew SetRotationCommand( editor, object, new THREE.Euler( 0, 0, 0 ) ),\r\n\t\t\t\t\tnew SetScaleCommand( editor, object, new THREE.Vector3( 1, 1, 1 ) ) ];\r\n\r\n\t\t\t\teditor.execute( new MultiCmdsCommand( editor, cmds ), 'Flatten Geometry' );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tthis.setValue( 'Actions' );\r\n\r\n\t} );\r\n\tcontainer.addStatic( objectActions );\r\n\t*/\r\n\r\n\t// type\r\n\r\n\tvar geometryTypeRow = new UIRow();\r\n\tvar geometryType = new UIText();\r\n\r\n\tgeometryTypeRow.add( new UIText( strings.getKey( 'sidebar/geometry/type' ) ).setWidth( '90px' ) );\r\n\tgeometryTypeRow.add( geometryType );\r\n\r\n\tcontainer.add( geometryTypeRow );\r\n\r\n\t// uuid\r\n\r\n\tvar geometryUUIDRow = new UIRow();\r\n\tvar geometryUUID = new UIInput().setWidth( '102px' ).setFontSize( '12px' ).setDisabled( true );\r\n\tvar geometryUUIDRenew = new UIButton( strings.getKey( 'sidebar/geometry/new' ) ).setMarginLeft( '7px' ).onClick( function () {\r\n\r\n\t\tgeometryUUID.setValue( THREE.MathUtils.generateUUID() );\r\n\r\n\t\teditor.execute( new SetGeometryValueCommand( editor, editor.selected, 'uuid', geometryUUID.getValue() ) );\r\n\r\n\t} );\r\n\r\n\tgeometryUUIDRow.add( new UIText( strings.getKey( 'sidebar/geometry/uuid' ) ).setWidth( '90px' ) );\r\n\tgeometryUUIDRow.add( geometryUUID );\r\n\tgeometryUUIDRow.add( geometryUUIDRenew );\r\n\r\n\tcontainer.add( geometryUUIDRow );\r\n\r\n\t// name\r\n\r\n\tvar geometryNameRow = new UIRow();\r\n\tvar geometryName = new UIInput().setWidth( '150px' ).setFontSize( '12px' ).onChange( function () {\r\n\r\n\t\teditor.execute( new SetGeometryValueCommand( editor, editor.selected, 'name', geometryName.getValue() ) );\r\n\r\n\t} );\r\n\r\n\tgeometryNameRow.add( new UIText( strings.getKey( 'sidebar/geometry/name' ) ).setWidth( '90px' ) );\r\n\tgeometryNameRow.add( geometryName );\r\n\r\n\tcontainer.add( geometryNameRow );\r\n\r\n\t// parameters\r\n\r\n\tvar parameters = new UISpan();\r\n\tcontainer.add( parameters );\r\n\r\n\t// buffergeometry\r\n\r\n\tcontainer.add( new SidebarGeometryBufferGeometry( editor ) );\r\n\r\n\t// Size\r\n\r\n\tvar geometryBoundingBox = new UIText().setFontSize( '12px' ).setVerticalAlign( 'middle' );\r\n\r\n\tcontainer.add( new UIText( strings.getKey( 'sidebar/geometry/bounds' ) ).setWidth( '90px' ) );\r\n\tcontainer.add( geometryBoundingBox );\r\n\r\n\t// Helpers\r\n\r\n\tvar helpersRow = new UIRow().setMarginTop( '16px' ).setPaddingLeft( '90px' );\r\n\tcontainer.add( helpersRow );\r\n\r\n\tvar vertexNormalsButton = new UIButton( strings.getKey( 'sidebar/geometry/show_vertex_normals' ) );\r\n\tvertexNormalsButton.onClick( function () {\r\n\r\n\t\tvar object = editor.selected;\r\n\r\n\t\tif ( editor.helpers[ object.id ] === undefined ) {\r\n\r\n\t\t\tvar helper = new VertexNormalsHelper( object );\r\n\t\t\teditor.addHelper( object, helper );\r\n\r\n\t\t} else {\r\n\r\n\t\t\teditor.removeHelper( object );\r\n\r\n\t\t}\r\n\r\n\t\tsignals.sceneGraphChanged.dispatch();\r\n\r\n\t} );\r\n\thelpersRow.add( vertexNormalsButton );\r\n\r\n\tasync function build() {\r\n\r\n\t\tvar object = editor.selected;\r\n\r\n\t\tif ( object && object.geometry ) {\r\n\r\n\t\t\tvar geometry = object.geometry;\r\n\r\n\t\t\tcontainer.setDisplay( 'block' );\r\n\r\n\t\t\tgeometryType.setValue( geometry.type );\r\n\r\n\t\t\tgeometryUUID.setValue( geometry.uuid );\r\n\t\t\tgeometryName.setValue( geometry.name );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tif ( currentGeometryType !== geometry.type ) {\r\n\r\n\t\t\t\tparameters.clear();\r\n\r\n\t\t\t\tif ( geometry.type === 'BufferGeometry' ) {\r\n\r\n\t\t\t\t\tparameters.add( new SidebarGeometryModifiers( editor, object ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tvar { GeometryParametersPanel } = await import( `./Sidebar.Geometry.${ geometry.type }.js` );\r\n\r\n\t\t\t\t\tparameters.add( new GeometryParametersPanel( editor, object ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcurrentGeometryType = geometry.type;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( geometry.boundingBox === null ) geometry.computeBoundingBox();\r\n\r\n\t\t\tconst boundingBox = geometry.boundingBox;\r\n\t\t\tconst x = Math.floor( ( boundingBox.max.x - boundingBox.min.x ) * 1000 ) / 1000;\r\n\t\t\tconst y = Math.floor( ( boundingBox.max.y - boundingBox.min.y ) * 1000 ) / 1000;\r\n\t\t\tconst z = Math.floor( ( boundingBox.max.z - boundingBox.min.z ) * 1000 ) / 1000;\r\n\r\n\t\t\tgeometryBoundingBox.setInnerHTML( `${x}<br/>${y}<br/>${z}` );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcontainer.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tsignals.objectSelected.add( function () {\r\n\r\n\t\tcurrentGeometryType = null;\r\n\r\n\t\tbuild();\r\n\r\n\t} );\r\n\r\n\tsignals.geometryChanged.add( build );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarGeometry };\r\n","import { UICheckbox, UIRow, UIText } from './libs/ui.js';\r\nimport { SetMaterialValueCommand } from './commands/SetMaterialValueCommand.js';\r\n\r\nfunction SidebarMaterialBooleanProperty( editor, property, name ) {\r\n\r\n\tconst signals = editor.signals;\r\n\r\n\tconst container = new UIRow();\r\n\tcontainer.add( new UIText( name ).setWidth( '90px' ) );\r\n\r\n\tconst boolean = new UICheckbox().setLeft( '100px' ).onChange( onChange );\r\n\tcontainer.add( boolean );\r\n\r\n\tlet object = null;\r\n\tlet material = null;\r\n\r\n\tfunction onChange() {\r\n\r\n\t\tif ( material[ property ] !== boolean.getValue() ) {\r\n\r\n\t\t\teditor.execute( new SetMaterialValueCommand( editor, object, property, boolean.getValue(), 0 /* TODO: currentMaterialSlot */ ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction update() {\r\n\r\n\t\tif ( object === null ) return;\r\n\t\tif ( object.material === undefined ) return;\r\n\r\n\t\tmaterial = object.material;\r\n\r\n\t\tif ( property in material ) {\r\n\r\n\t\t\tboolean.setValue( material[ property ] );\r\n\t\t\tcontainer.setDisplay( '' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcontainer.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tsignals.objectSelected.add( function ( selected ) {\r\n\r\n\t\tobject = selected;\r\n\r\n\t\tupdate();\r\n\r\n\t} );\r\n\r\n\tsignals.materialChanged.add( update );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarMaterialBooleanProperty };\r\n","import { UIColor, UINumber, UIRow, UIText } from './libs/ui.js';\r\nimport { SetMaterialColorCommand } from './commands/SetMaterialColorCommand.js';\r\nimport { SetMaterialValueCommand } from './commands/SetMaterialValueCommand.js';\r\n\r\nfunction SidebarMaterialColorProperty( editor, property, name ) {\r\n\r\n\tconst signals = editor.signals;\r\n\r\n\tconst container = new UIRow();\r\n\tcontainer.add( new UIText( name ).setWidth( '90px' ) );\r\n\r\n\tconst color = new UIColor().onInput( onChange );\r\n\tcontainer.add( color );\r\n\r\n\tlet intensity;\r\n\r\n\tif ( property === 'emissive' ) {\r\n\r\n\t\tintensity = new UINumber().setWidth( '30px' ).onChange( onChange );\r\n\t\tcontainer.add( intensity );\r\n\r\n\t}\r\n\r\n\tlet object = null;\r\n\tlet material = null;\r\n\r\n\tfunction onChange() {\r\n\r\n\t\tif ( material[ property ].getHex() !== color.getHexValue() ) {\r\n\r\n\t\t\teditor.execute( new SetMaterialColorCommand( editor, object, property, color.getHexValue(), 0 /* TODO: currentMaterialSlot */ ) );\r\n\r\n\t\t}\r\n\r\n\t\tif ( intensity !== undefined ) {\r\n\r\n\t\t\tif ( material[ `${ property }Intensity` ] !== intensity.getValue() ) {\r\n\r\n\t\t\t\teditor.execute( new SetMaterialValueCommand( editor, object, `${ property }Intensity`, intensity.getValue(), /* TODO: currentMaterialSlot*/ 0 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction update() {\r\n\r\n\t\tif ( object === null ) return;\r\n\t\tif ( object.material === undefined ) return;\r\n\r\n\t\tmaterial = object.material;\r\n\r\n\t\tif ( property in material ) {\r\n\r\n\t\t\tcolor.setHexValue( material[ property ].getHexString() );\r\n\r\n\t\t\tif ( intensity !== undefined ) {\r\n\r\n\t\t\t\tintensity.setValue( material[ `${ property }Intensity` ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcontainer.setDisplay( '' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcontainer.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tsignals.objectSelected.add( function ( selected ) {\r\n\r\n\t\tobject = selected;\r\n\r\n\t\tupdate();\r\n\r\n\t} );\r\n\r\n\tsignals.materialChanged.add( update );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarMaterialColorProperty };\r\n","import { UIRow, UISelect, UIText } from './libs/ui.js';\r\nimport { SetMaterialValueCommand } from './commands/SetMaterialValueCommand.js';\r\n\r\nfunction SidebarMaterialConstantProperty( editor, property, name, options ) {\r\n\r\n\tconst signals = editor.signals;\r\n\r\n\tconst container = new UIRow();\r\n\tcontainer.add( new UIText( name ).setWidth( '90px' ) );\r\n\r\n\tconst constant = new UISelect().setOptions( options ).onChange( onChange );\r\n\tcontainer.add( constant );\r\n\r\n\tlet object = null;\r\n\tlet material = null;\r\n\r\n\tfunction onChange() {\r\n\r\n\t\tconst value = parseInt( constant.getValue() );\r\n\r\n\t\tif ( material[ property ] !== value ) {\r\n\r\n\t\t\teditor.execute( new SetMaterialValueCommand( editor, object, property, value, 0 /* TODO: currentMaterialSlot */ ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction update() {\r\n\r\n\t\tif ( object === null ) return;\r\n\t\tif ( object.material === undefined ) return;\r\n\r\n\t\tmaterial = object.material;\r\n\r\n\t\tif ( property in material ) {\r\n\r\n\t\t\tconstant.setValue( material[ property ] );\r\n\t\t\tcontainer.setDisplay( '' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcontainer.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tsignals.objectSelected.add( function ( selected ) {\r\n\r\n\t\tobject = selected;\r\n\r\n\t\tupdate();\r\n\r\n\t} );\r\n\r\n\tsignals.materialChanged.add( update );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarMaterialConstantProperty };\r\n","import * as THREE from 'three'\r\n\r\nimport { UICheckbox, UINumber, UIRow, UIText } from './libs/ui.js';\r\nimport { UITexture } from './libs/ui.three.js';\r\nimport { SetMaterialMapCommand } from './commands/SetMaterialMapCommand.js';\r\nimport { SetMaterialValueCommand } from './commands/SetMaterialValueCommand.js';\r\nimport { SetMaterialVectorCommand } from './commands/SetMaterialVectorCommand.js';\r\n\r\nfunction SidebarMaterialMapProperty( editor, property, name ) {\r\n\r\n\tconst signals = editor.signals;\r\n\r\n\tconst container = new UIRow();\r\n\tcontainer.add( new UIText( name ).setWidth( '90px' ) );\r\n\r\n\tconst enabled = new UICheckbox( false ).setMarginRight( '8px' ).onChange( onChange );\r\n\tcontainer.add( enabled );\r\n\r\n\tconst map = new UITexture().onChange( onMapChange );\r\n\tcontainer.add( map );\r\n\r\n\tconst mapType = property.replace( 'Map', '' );\r\n\r\n\tlet intensity;\r\n\r\n\tif ( property === 'aoMap' ) {\r\n\r\n\t\tintensity = new UINumber().setWidth( '30px' ).onChange( onIntensityChange );\r\n\t\tcontainer.add( intensity );\r\n\r\n\t}\r\n\r\n\tlet scale;\r\n\r\n\tif ( property === 'bumpMap' || property === 'displacementMap' ) {\r\n\r\n\t\tscale = new UINumber().setWidth( '30px' ).onChange( onScaleChange );\r\n\t\tcontainer.add( scale );\r\n\r\n\t}\r\n\r\n\tlet scaleX, scaleY;\r\n\r\n\tif ( property === 'normalMap' || property === 'clearcoatNormalMap' ) {\r\n\r\n\t\tscaleX = new UINumber().setWidth( '30px' ).onChange( onScaleXYChange );\r\n\t\tcontainer.add( scaleX );\r\n\r\n\t\tscaleY = new UINumber().setWidth( '30px' ).onChange( onScaleXYChange );\r\n\t\tcontainer.add( scaleY );\r\n\r\n\t}\r\n\r\n\tlet object = null;\r\n\tlet material = null;\r\n\r\n\tfunction onChange() {\r\n\r\n\t\tconst newMap = enabled.getValue() ? map.getValue() : null;\r\n\r\n\t\tif ( material[ 'property' ] !== newMap ) {\r\n\r\n\t\t\tconst geometry = object.geometry;\r\n\r\n\t\t\tif ( newMap !== null && geometry.isBufferGeometry && geometry.attributes.uv === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'Geometry doesn\\'t have uvs:', geometry );\r\n\r\n\t\t\t}\r\n\r\n\t\t\teditor.execute( new SetMaterialMapCommand( editor, object, property, newMap, 0 /* TODO: currentMaterialSlot */ ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onMapChange( texture ) {\r\n\r\n\t\tif ( texture !== null ) {\r\n\r\n\t\t\tif ( texture.isDataTexture !== true && texture.encoding !== THREE.sRGBEncoding ) {\r\n\r\n\t\t\t\ttexture.encoding = THREE.sRGBEncoding;\r\n\t\t\t\tmaterial.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tenabled.setDisabled( false );\r\n\r\n\t\tonChange();\r\n\r\n\t}\r\n\r\n\tfunction onIntensityChange() {\r\n\r\n\t\tif ( material[ `${ property }Intensity` ] !== intensity.getValue() ) {\r\n\r\n\t\t\teditor.execute( new SetMaterialValueCommand( editor, object, `${ property }Intensity`, intensity.getValue(), 0 /* TODO: currentMaterialSlot */ ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onScaleChange() {\r\n\r\n\t\tif ( material[ `${ mapType }Scale` ] !== scale.getValue() ) {\r\n\r\n\t\t\teditor.execute( new SetMaterialValueCommand( editor, object, `${ mapType }Scale`, scale.getValue(), 0 /* TODO: currentMaterialSlot */ ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onScaleXYChange() {\r\n\r\n\t\tconst value = [ scaleX.getValue(), scaleY.getValue() ];\r\n\r\n\t\tif ( material[ `${ mapType }Scale` ].x !== value[ 0 ] || material[ `${ mapType }Scale` ].y !== value[ 1 ] ) {\r\n\r\n\t\t\teditor.execute( new SetMaterialVectorCommand( editor, object, `${ mapType }Scale`, value, 0 /* TODOL currentMaterialSlot */ ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction update() {\r\n\r\n\t\tif ( object === null ) return;\r\n\t\tif ( object.material === undefined ) return;\r\n\r\n\t\tmaterial = object.material;\r\n\r\n\t\tif ( property in material ) {\r\n\r\n\t\t\tif ( material[ property ] !== null ) {\r\n\r\n\t\t\t\tmap.setValue( material[ property ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tenabled.setValue( material[ property ] !== null );\r\n\t\t\tenabled.setDisabled( map.getValue() === null );\r\n\r\n\t\t\tif ( intensity !== undefined ) {\r\n\r\n\t\t\t\tintensity.setValue( material[ `${ property }Intensity` ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( scale !== undefined ) {\r\n\r\n\t\t\t\tscale.setValue( material[ `${ mapType }Scale` ] );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( scaleX !== undefined ) {\r\n\r\n\t\t\t\tscaleX.setValue( material[ `${ mapType }Scale` ].x );\r\n\t\t\t\tscaleY.setValue( material[ `${ mapType }Scale` ].y );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcontainer.setDisplay( '' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcontainer.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tsignals.objectSelected.add( function ( selected ) {\r\n\r\n\t\tobject = selected;\r\n\r\n\t\tmap.setValue( null );\r\n\r\n\t\tupdate();\r\n\r\n\t} );\r\n\r\n\tsignals.materialChanged.add( update );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarMaterialMapProperty };\r\n","import { UINumber, UIRow, UIText } from './libs/ui.js';\r\nimport { SetMaterialValueCommand } from './commands/SetMaterialValueCommand.js';\r\n\r\nfunction SidebarMaterialNumberProperty( editor, property, name, range = [ - Infinity, Infinity ] ) {\r\n\r\n\tconst signals = editor.signals;\r\n\r\n\tconst container = new UIRow();\r\n\tcontainer.add( new UIText( name ).setWidth( '90px' ) );\r\n\r\n\tconst number = new UINumber().setWidth( '60px' ).setRange( range[ 0 ], range[ 1 ] ).onChange( onChange );\r\n\tcontainer.add( number );\r\n\r\n\tlet object = null;\r\n\tlet material = null;\r\n\r\n\tfunction onChange() {\r\n\r\n\t\tif ( material[ property ] !== number.getValue() ) {\r\n\r\n\t\t\teditor.execute( new SetMaterialValueCommand( editor, object, property, number.getValue(), 0 /* TODO: currentMaterialSlot */ ) );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction update() {\r\n\r\n\t\tif ( object === null ) return;\r\n\t\tif ( object.material === undefined ) return;\r\n\r\n\t\tmaterial = object.material;\r\n\r\n\t\tif ( property in material ) {\r\n\r\n\t\t\tnumber.setValue( material[ property ] );\r\n\t\t\tcontainer.setDisplay( '' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcontainer.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tsignals.objectSelected.add( function ( selected ) {\r\n\r\n\t\tobject = selected;\r\n\r\n\t\tupdate();\r\n\r\n\t} );\r\n\r\n\tsignals.materialChanged.add( update );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarMaterialNumberProperty };\r\n","import { UIButton, UIRow, UIText } from './libs/ui.js';\r\n\r\nfunction SidebarMaterialProgram( editor, property ) {\r\n\r\n\tconst signals = editor.signals;\r\n\tconst strings = editor.strings;\r\n\r\n\tlet object = null;\r\n\tlet material = null;\r\n\r\n\tconst container = new UIRow();\r\n\tcontainer.add( new UIText( strings.getKey( 'sidebar/material/program' ) ).setWidth( '90px' ) );\r\n\r\n\tconst programInfo = new UIButton( strings.getKey( 'sidebar/material/info' ) );\r\n\tprogramInfo.setMarginRight( '4px' );\r\n\tprogramInfo.onClick( function () {\r\n\r\n\t\tsignals.editScript.dispatch( object, 'programInfo' );\r\n\r\n\t} );\r\n\tcontainer.add( programInfo );\r\n\r\n\tconst programVertex = new UIButton( strings.getKey( 'sidebar/material/vertex' ) );\r\n\tprogramVertex.setMarginRight( '4px' );\r\n\tprogramVertex.onClick( function () {\r\n\r\n\t\tsignals.editScript.dispatch( object, 'vertexShader' );\r\n\r\n\t} );\r\n\tcontainer.add( programVertex );\r\n\r\n\tconst programFragment = new UIButton( strings.getKey( 'sidebar/material/fragment' ) );\r\n\tprogramFragment.setMarginRight( '4px' );\r\n\tprogramFragment.onClick( function () {\r\n\r\n\t\tsignals.editScript.dispatch( object, 'fragmentShader' );\r\n\r\n\t} );\r\n\tcontainer.add( programFragment );\r\n\r\n\tfunction update() {\r\n\r\n\t\tif ( object === null ) return;\r\n\t\tif ( object.material === undefined ) return;\r\n\r\n\t\tmaterial = object.material;\r\n\r\n\t\tif ( property in material ) {\r\n\r\n\t\t\tcontainer.setDisplay( '' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcontainer.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tsignals.objectSelected.add( function ( selected ) {\r\n\r\n\t\tobject = selected;\r\n\r\n\t\tupdate();\r\n\r\n\t} );\r\n\r\n\tsignals.materialChanged.add( update );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarMaterialProgram };\r\n","import * as THREE from 'three'\r\n\r\nimport { UIButton, UIInput, UIPanel, UIRow, UISelect, UIText } from './libs/ui.js';\r\n\r\nimport { SetMaterialCommand } from './commands/SetMaterialCommand.js';\r\nimport { SetMaterialValueCommand } from './commands/SetMaterialValueCommand.js';\r\n\r\nimport { SidebarMaterialBooleanProperty } from './Sidebar.Material.BooleanProperty.js';\r\nimport { SidebarMaterialColorProperty } from './Sidebar.Material.ColorProperty.js';\r\nimport { SidebarMaterialConstantProperty } from './Sidebar.Material.ConstantProperty.js';\r\nimport { SidebarMaterialMapProperty } from './Sidebar.Material.MapProperty.js';\r\nimport { SidebarMaterialNumberProperty } from './Sidebar.Material.NumberProperty.js';\r\nimport { SidebarMaterialProgram } from './Sidebar.Material.Program.js';\r\n\r\nfunction SidebarMaterial( editor ) {\r\n\r\n\tconst signals = editor.signals;\r\n\tconst strings = editor.strings;\r\n\r\n\tlet currentObject;\r\n\r\n\tlet currentMaterialSlot = 0;\r\n\r\n\tconst container = new UIPanel();\r\n\tcontainer.setBorderTop( '0' );\r\n\tcontainer.setDisplay( 'none' );\r\n\tcontainer.setPaddingTop( '20px' );\r\n\r\n\t// Current material slot\r\n\r\n\tconst materialSlotRow = new UIRow();\r\n\r\n\tmaterialSlotRow.add( new UIText( strings.getKey( 'sidebar/material/slot' ) ).setWidth( '90px' ) );\r\n\r\n\tconst materialSlotSelect = new UISelect().setWidth( '170px' ).setFontSize( '12px' ).onChange( update );\r\n\tmaterialSlotSelect.setOptions( { 0: '' } ).setValue( 0 );\r\n\tmaterialSlotRow.add( materialSlotSelect );\r\n\r\n\tcontainer.add( materialSlotRow );\r\n\r\n\t// type\r\n\r\n\tconst materialClassRow = new UIRow();\r\n\tconst materialClass = new UISelect().setWidth( '150px' ).setFontSize( '12px' ).onChange( update );\r\n\r\n\tmaterialClassRow.add( new UIText( strings.getKey( 'sidebar/material/type' ) ).setWidth( '90px' ) );\r\n\tmaterialClassRow.add( materialClass );\r\n\r\n\tcontainer.add( materialClassRow );\r\n\r\n\t// uuid\r\n\r\n\tconst materialUUIDRow = new UIRow();\r\n\tconst materialUUID = new UIInput().setWidth( '102px' ).setFontSize( '12px' ).setDisabled( true );\r\n\tconst materialUUIDRenew = new UIButton( strings.getKey( 'sidebar/material/new' ) ).setMarginLeft( '7px' );\r\n\tmaterialUUIDRenew.onClick( function () {\r\n\r\n\t\tmaterialUUID.setValue( THREE.MathUtils.generateUUID() );\r\n\t\tupdate();\r\n\r\n\t} );\r\n\r\n\tmaterialUUIDRow.add( new UIText( strings.getKey( 'sidebar/material/uuid' ) ).setWidth( '90px' ) );\r\n\tmaterialUUIDRow.add( materialUUID );\r\n\tmaterialUUIDRow.add( materialUUIDRenew );\r\n\r\n\tcontainer.add( materialUUIDRow );\r\n\r\n\t// name\r\n\r\n\tconst materialNameRow = new UIRow();\r\n\tconst materialName = new UIInput().setWidth( '150px' ).setFontSize( '12px' ).onChange( function () {\r\n\r\n\t\teditor.execute( new SetMaterialValueCommand( editor, editor.selected, 'name', materialName.getValue(), currentMaterialSlot ) );\r\n\r\n\t} );\r\n\r\n\tmaterialNameRow.add( new UIText( strings.getKey( 'sidebar/material/name' ) ).setWidth( '90px' ) );\r\n\tmaterialNameRow.add( materialName );\r\n\r\n\tcontainer.add( materialNameRow );\r\n\r\n\t// program\r\n\r\n\tconst materialProgram = new SidebarMaterialProgram( editor, 'vertexShader' );\r\n\tcontainer.add( materialProgram );\r\n\r\n\t// color\r\n\r\n\tconst materialColor = new SidebarMaterialColorProperty( editor, 'color', strings.getKey( 'sidebar/material/color' ) );\r\n\tcontainer.add( materialColor );\r\n\r\n\t// specular\r\n\r\n\tconst materialSpecular = new SidebarMaterialColorProperty( editor, 'specular', strings.getKey( 'sidebar/material/specular' ) );\r\n\tcontainer.add( materialSpecular );\r\n\r\n\t// shininess\r\n\r\n\tconst materialShininess = new SidebarMaterialNumberProperty( editor, 'shininess', strings.getKey( 'sidebar/material/shininess' ) );\r\n\tcontainer.add( materialShininess );\r\n\r\n\t// emissive\r\n\r\n\tconst materialEmissive = new SidebarMaterialColorProperty( editor, 'emissive', strings.getKey( 'sidebar/material/emissive' ) );\r\n\tcontainer.add( materialEmissive );\r\n\r\n\t// reflectivity\r\n\r\n\tconst materialReflectivity = new SidebarMaterialNumberProperty( editor, 'reflectivity', strings.getKey( 'sidebar/material/reflectivity' ) );\r\n\tcontainer.add( materialReflectivity );\r\n\r\n\t// roughness\r\n\r\n\tconst materialRoughness = new SidebarMaterialNumberProperty( editor, 'roughness', strings.getKey( 'sidebar/material/roughness' ), [ 0, 1 ] );\r\n\tcontainer.add( materialRoughness );\r\n\r\n\t// metalness\r\n\r\n\tconst materialMetalness = new SidebarMaterialNumberProperty( editor, 'metalness', strings.getKey( 'sidebar/material/metalness' ), [ 0, 1 ] );\r\n\tcontainer.add( materialMetalness );\r\n\r\n\t// clearcoat\r\n\r\n\tconst materialClearcoat = new SidebarMaterialNumberProperty( editor, 'clearcoat', strings.getKey( 'sidebar/material/clearcoat' ), [ 0, 1 ] );\r\n\tcontainer.add( materialClearcoat );\r\n\r\n\t// clearcoatRoughness\r\n\r\n\tconst materialClearcoatRoughness = new SidebarMaterialNumberProperty( editor, 'clearcoatRoughness', strings.getKey( 'sidebar/material/clearcoatroughness' ), [ 0, 1 ] );\r\n\tcontainer.add( materialClearcoatRoughness );\r\n\r\n\t// transmission\r\n\r\n\tconst materialTransmission = new SidebarMaterialNumberProperty( editor, 'transmission', strings.getKey( 'sidebar/material/transmission' ), [ 0, 1 ] );\r\n\tcontainer.add( materialTransmission );\r\n\r\n\t// attenuation distance\r\n\r\n\tconst materialAttenuationDistance = new SidebarMaterialNumberProperty( editor, 'attenuationDistance', strings.getKey( 'sidebar/material/attenuationDistance' ) );\r\n\tcontainer.add( materialAttenuationDistance );\r\n\r\n\t// attenuation tint\r\n\r\n\tconst materialAttenuationTint = new SidebarMaterialColorProperty( editor, 'attenuationTint', strings.getKey( 'sidebar/material/attenuationTint' ) );\r\n\tcontainer.add( materialAttenuationTint );\r\n\r\n\t// thickness\r\n\r\n\tconst materialThickness = new SidebarMaterialNumberProperty( editor, 'thickness', strings.getKey( 'sidebar/material/thickness' ) );\r\n\tcontainer.add( materialThickness );\r\n\r\n\t// vertex colors\r\n\r\n\tconst materialVertexColors = new SidebarMaterialBooleanProperty( editor, 'vertexColors', strings.getKey( 'sidebar/material/vertexcolors' ) );\r\n\tcontainer.add( materialVertexColors );\r\n\r\n\t// depth packing\r\n\r\n\tconst materialDepthPackingOptions = {\r\n\t\t[ THREE.BasicDepthPacking ]: 'Basic',\r\n\t\t[ THREE.RGBADepthPacking ]: 'RGBA'\r\n\t};\r\n\r\n\tconst materialDepthPacking = new SidebarMaterialConstantProperty( editor, 'depthPacking', strings.getKey( 'sidebar/material/depthPacking' ), materialDepthPackingOptions );\r\n\tcontainer.add( materialDepthPacking );\r\n\r\n\t// map\r\n\r\n\tconst materialMap = new SidebarMaterialMapProperty( editor, 'map', strings.getKey( 'sidebar/material/map' ) );\r\n\tcontainer.add( materialMap );\r\n\r\n\t// specular map\r\n\r\n\tconst materialSpecularMap = new SidebarMaterialMapProperty( editor, 'specularMap', strings.getKey( 'sidebar/material/specularmap' ) );\r\n\tcontainer.add( materialSpecularMap );\r\n\r\n\t// emissive map\r\n\r\n\tconst materialEmissiveMap = new SidebarMaterialMapProperty( editor, 'emissiveMap', strings.getKey( 'sidebar/material/emissivemap' ) );\r\n\tcontainer.add( materialEmissiveMap );\r\n\r\n\t// matcap map\r\n\r\n\tconst materialMatcapMap = new SidebarMaterialMapProperty( editor, 'matcap', strings.getKey( 'sidebar/material/matcap' ) );\r\n\tcontainer.add( materialMatcapMap );\r\n\r\n\t// alpha map\r\n\r\n\tconst materialAlphaMap = new SidebarMaterialMapProperty( editor, 'alphaMap', strings.getKey( 'sidebar/material/alphamap' ) );\r\n\tcontainer.add( materialAlphaMap );\r\n\r\n\t// bump map\r\n\r\n\tconst materialBumpMap = new SidebarMaterialMapProperty( editor, 'bumpMap', strings.getKey( 'sidebar/material/bumpmap' ) );\r\n\tcontainer.add( materialBumpMap );\r\n\r\n\t// normal map\r\n\r\n\tconst materialNormalMap = new SidebarMaterialMapProperty( editor, 'normalMap', strings.getKey( 'sidebar/material/normalmap' ) );\r\n\tcontainer.add( materialNormalMap );\r\n\r\n\t// clearcoat normal map\r\n\r\n\tconst materialClearcoatNormalMap = new SidebarMaterialMapProperty( editor, 'clearcoatNormalMap', strings.getKey( 'sidebar/material/clearcoatnormalmap' ) );\r\n\tcontainer.add( materialClearcoatNormalMap );\r\n\r\n\t// displacement map\r\n\r\n\tconst materialDisplacementMap = new SidebarMaterialMapProperty( editor, 'displacementMap', strings.getKey( 'sidebar/material/displacementmap' ) );\r\n\tcontainer.add( materialDisplacementMap );\r\n\r\n\t// roughness map\r\n\r\n\tconst materialRoughnessMap = new SidebarMaterialMapProperty( editor, 'roughnessMap', strings.getKey( 'sidebar/material/roughnessmap' ) );\r\n\tcontainer.add( materialRoughnessMap );\r\n\r\n\t// metalness map\r\n\r\n\tconst materialMetalnessMap = new SidebarMaterialMapProperty( editor, 'metalnessMap', strings.getKey( 'sidebar/material/metalnessmap' ) );\r\n\tcontainer.add( materialMetalnessMap );\r\n\r\n\t// env map\r\n\r\n\tconst materialEnvMap = new SidebarMaterialMapProperty( editor, 'envMap', strings.getKey( 'sidebar/material/envmap' ) );\r\n\tcontainer.add( materialEnvMap );\r\n\r\n\t// light map\r\n\r\n\tconst materialLightMap = new SidebarMaterialMapProperty( editor, 'lightMap', strings.getKey( 'sidebar/material/lightmap' ) );\r\n\tcontainer.add( materialLightMap );\r\n\r\n\t// ambient occlusion map\r\n\r\n\tconst materialAOMap = new SidebarMaterialMapProperty( editor, 'aoMap', strings.getKey( 'sidebar/material/aomap' ) );\r\n\tcontainer.add( materialAOMap );\r\n\r\n\t// gradient map\r\n\r\n\tconst materialGradientMap = new SidebarMaterialMapProperty( editor, 'gradientMap', strings.getKey( 'sidebar/material/gradientmap' ) );\r\n\tcontainer.add( materialGradientMap );\r\n\r\n\t// side\r\n\r\n\tconst materialSideOptions = {\r\n\t\t0: 'Front',\r\n\t\t1: 'Back',\r\n\t\t2: 'Double'\r\n\t};\r\n\r\n\tconst materialSide = new SidebarMaterialConstantProperty( editor, 'side', strings.getKey( 'sidebar/material/side' ), materialSideOptions );\r\n\tcontainer.add( materialSide );\r\n\r\n\t// size\r\n\r\n\tconst materialSize = new SidebarMaterialNumberProperty( editor, 'size', strings.getKey( 'sidebar/material/size' ), [ 0, Infinity ] );\r\n\tcontainer.add( materialSize );\r\n\r\n\t// sizeAttenuation\r\n\r\n\tconst materialSizeAttenuation = new SidebarMaterialBooleanProperty( editor, 'sizeAttenuation', strings.getKey( 'sidebar/material/sizeAttenuation' ) );\r\n\tcontainer.add( materialSizeAttenuation );\r\n\r\n\t// flatShading\r\n\r\n\tconst materialFlatShading = new SidebarMaterialBooleanProperty( editor, 'flatShading', strings.getKey( 'sidebar/material/flatShading' ) );\r\n\tcontainer.add( materialFlatShading );\r\n\r\n\t// blending\r\n\r\n\tconst materialBlendingOptions = {\r\n\t\t0: 'No',\r\n\t\t1: 'Normal',\r\n\t\t2: 'Additive',\r\n\t\t3: 'Subtractive',\r\n\t\t4: 'Multiply',\r\n\t\t5: 'Custom'\r\n\t};\r\n\r\n\tconst materialBlending = new SidebarMaterialConstantProperty( editor, 'blending', strings.getKey( 'sidebar/material/blending' ), materialBlendingOptions );\r\n\tcontainer.add( materialBlending );\r\n\r\n\t// opacity\r\n\r\n\tconst materialOpacity = new SidebarMaterialNumberProperty( editor, 'opacity', strings.getKey( 'sidebar/material/opacity' ), [ 0, 1 ] );\r\n\tcontainer.add( materialOpacity );\r\n\r\n\t// transparent\r\n\r\n\tconst materialTransparent = new SidebarMaterialBooleanProperty( editor, 'transparent', strings.getKey( 'sidebar/material/transparent' ) );\r\n\tcontainer.add( materialTransparent );\r\n\r\n\t// alpha test\r\n\r\n\tconst materialAlphaTest = new SidebarMaterialNumberProperty( editor, 'alphaTest', strings.getKey( 'sidebar/material/alphatest' ), [ 0, 1 ] );\r\n\tcontainer.add( materialAlphaTest );\r\n\r\n\t// depth test\r\n\r\n\tconst materialDepthTest = new SidebarMaterialBooleanProperty( editor, 'depthTest', strings.getKey( 'sidebar/material/depthtest' ) );\r\n\tcontainer.add( materialDepthTest );\r\n\r\n\t// depth write\r\n\r\n\tconst materialDepthWrite = new SidebarMaterialBooleanProperty( editor, 'depthWrite', strings.getKey( 'sidebar/material/depthwrite' ) );\r\n\tcontainer.add( materialDepthWrite );\r\n\r\n\t// wireframe\r\n\r\n\tconst materialWireframe = new SidebarMaterialBooleanProperty( editor, 'wireframe', strings.getKey( 'sidebar/material/wireframe' ) );\r\n\tcontainer.add( materialWireframe );\r\n\r\n\t//\r\n\r\n\tfunction update() {\r\n\r\n\t\tconst previousSelectedSlot = currentMaterialSlot;\r\n\r\n\t\tcurrentMaterialSlot = parseInt( materialSlotSelect.getValue() );\r\n\r\n\t\tif ( currentMaterialSlot !== previousSelectedSlot ) refreshUI();\r\n\r\n\t\tlet material = editor.getObjectMaterial( currentObject, currentMaterialSlot );\r\n\r\n\t\tif ( material ) {\r\n\r\n\t\t\tif ( material.uuid !== undefined && material.uuid !== materialUUID.getValue() ) {\r\n\r\n\t\t\t\teditor.execute( new SetMaterialValueCommand( editor, currentObject, 'uuid', materialUUID.getValue(), currentMaterialSlot ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( material.type !== materialClass.getValue() ) {\r\n\r\n\t\t\t\tmaterial = new materialClasses[ materialClass.getValue() ]();\r\n\r\n\t\t\t\tif ( material.type === 'RawShaderMaterial' ) {\r\n\r\n\t\t\t\t\tmaterial.vertexShader = vertexShaderVariables + material.vertexShader;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( Array.isArray( currentObject.material ) ) {\r\n\r\n\t\t\t\t\t// don't remove the entire multi-material. just the material of the selected slot\r\n\r\n\t\t\t\t\teditor.removeMaterial( currentObject.material[ currentMaterialSlot ] );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\teditor.removeMaterial( currentObject.material );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\teditor.execute( new SetMaterialCommand( editor, currentObject, material, currentMaterialSlot ), 'New Material: ' + materialClass.getValue() );\r\n\t\t\t\teditor.addMaterial( material );\r\n\t\t\t\t// TODO Copy other references in the scene graph\r\n\t\t\t\t// keeping name and UUID then.\r\n\t\t\t\t// Also there should be means to create a unique\r\n\t\t\t\t// copy for the current object explicitly and to\r\n\t\t\t\t// attach the current material to other objects.\r\n\r\n\t\t\t}\r\n\r\n\t\t\trefreshUI();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tfunction setRowVisibility() {\r\n\r\n\t\tconst material = currentObject.material;\r\n\r\n\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\tmaterialSlotRow.setDisplay( '' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmaterialSlotRow.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction refreshUI() {\r\n\r\n\t\tif ( ! currentObject ) return;\r\n\r\n\t\tlet material = currentObject.material;\r\n\r\n\t\tif ( Array.isArray( material ) ) {\r\n\r\n\t\t\tconst slotOptions = {};\r\n\r\n\t\t\tcurrentMaterialSlot = Math.max( 0, Math.min( material.length, currentMaterialSlot ) );\r\n\r\n\t\t\tfor ( let i = 0; i < material.length; i ++ ) {\r\n\r\n\t\t\t\tslotOptions[ i ] = String( i + 1 ) + ': ' + material[ i ].name;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmaterialSlotSelect.setOptions( slotOptions ).setValue( currentMaterialSlot );\r\n\r\n\t\t}\r\n\r\n\t\tmaterial = editor.getObjectMaterial( currentObject, currentMaterialSlot );\r\n\r\n\t\tif ( material.uuid !== undefined ) {\r\n\r\n\t\t\tmaterialUUID.setValue( material.uuid );\r\n\r\n\t\t}\r\n\r\n\t\tif ( material.name !== undefined ) {\r\n\r\n\t\t\tmaterialName.setValue( material.name );\r\n\r\n\t\t}\r\n\r\n\t\tif ( currentObject.isMesh ) {\r\n\r\n\t\t\tmaterialClass.setOptions( meshMaterialOptions );\r\n\r\n\t\t} else if ( currentObject.isSprite ) {\r\n\r\n\t\t\tmaterialClass.setOptions( spriteMaterialOptions );\r\n\r\n\t\t} else if ( currentObject.isPoints ) {\r\n\r\n\t\t\tmaterialClass.setOptions( pointsMaterialOptions );\r\n\r\n\t\t} else if ( currentObject.isLine ) {\r\n\r\n\t\t\tmaterialClass.setOptions( lineMaterialOptions );\r\n\r\n\t\t}\r\n\r\n\t\tmaterialClass.setValue( material.type );\r\n\r\n\t\tsetRowVisibility();\r\n\r\n\t}\r\n\r\n\t// events\r\n\r\n\tsignals.objectSelected.add( function ( object ) {\r\n\r\n\t\tlet hasMaterial = false;\r\n\r\n\t\tif ( object && object.material ) {\r\n\r\n\t\t\thasMaterial = true;\r\n\r\n\t\t\tif ( Array.isArray( object.material ) && object.material.length === 0 ) {\r\n\r\n\t\t\t\thasMaterial = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif ( hasMaterial ) {\r\n\r\n\t\t\tcurrentObject = object;\r\n\t\t\trefreshUI();\r\n\t\t\tcontainer.setDisplay( '' );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcurrentObject = null;\r\n\t\t\tcontainer.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tsignals.materialChanged.add( refreshUI );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nconst materialClasses = {\r\n\t'LineBasicMaterial': THREE.LineBasicMaterial,\r\n\t'LineDashedMaterial': THREE.LineDashedMaterial,\r\n\t'MeshBasicMaterial': THREE.MeshBasicMaterial,\r\n\t'MeshDepthMaterial': THREE.MeshDepthMaterial,\r\n\t'MeshNormalMaterial': THREE.MeshNormalMaterial,\r\n\t'MeshLambertMaterial': THREE.MeshLambertMaterial,\r\n\t'MeshMatcapMaterial': THREE.MeshMatcapMaterial,\r\n\t'MeshPhongMaterial': THREE.MeshPhongMaterial,\r\n\t'MeshToonMaterial': THREE.MeshToonMaterial,\r\n\t'MeshStandardMaterial': THREE.MeshStandardMaterial,\r\n\t'MeshPhysicalMaterial': THREE.MeshPhysicalMaterial,\r\n\t'RawShaderMaterial': THREE.RawShaderMaterial,\r\n\t'ShaderMaterial': THREE.ShaderMaterial,\r\n\t'ShadowMaterial': THREE.ShadowMaterial,\r\n\t'SpriteMaterial': THREE.SpriteMaterial,\r\n\t'PointsMaterial': THREE.PointsMaterial\r\n};\r\n\r\nconst vertexShaderVariables = [\r\n\t'uniform mat4 projectionMatrix;',\r\n\t'uniform mat4 modelViewMatrix;\\n',\r\n\t'attribute vec3 position;\\n\\n',\r\n].join( '\\n' );\r\n\r\nconst meshMaterialOptions = {\r\n\t'MeshBasicMaterial': 'MeshBasicMaterial',\r\n\t'MeshDepthMaterial': 'MeshDepthMaterial',\r\n\t'MeshNormalMaterial': 'MeshNormalMaterial',\r\n\t'MeshLambertMaterial': 'MeshLambertMaterial',\r\n\t'MeshMatcapMaterial': 'MeshMatcapMaterial',\r\n\t'MeshPhongMaterial': 'MeshPhongMaterial',\r\n\t'MeshToonMaterial': 'MeshToonMaterial',\r\n\t'MeshStandardMaterial': 'MeshStandardMaterial',\r\n\t'MeshPhysicalMaterial': 'MeshPhysicalMaterial',\r\n\t'RawShaderMaterial': 'RawShaderMaterial',\r\n\t'ShaderMaterial': 'ShaderMaterial',\r\n\t'ShadowMaterial': 'ShadowMaterial'\r\n};\r\n\r\nconst lineMaterialOptions = {\r\n\t'LineBasicMaterial': 'LineBasicMaterial',\r\n\t'LineDashedMaterial': 'LineDashedMaterial',\r\n\t'RawShaderMaterial': 'RawShaderMaterial',\r\n\t'ShaderMaterial': 'ShaderMaterial'\r\n};\r\n\r\nconst spriteMaterialOptions = {\r\n\t'SpriteMaterial': 'SpriteMaterial',\r\n\t'RawShaderMaterial': 'RawShaderMaterial',\r\n\t'ShaderMaterial': 'ShaderMaterial'\r\n};\r\n\r\nconst pointsMaterialOptions = {\r\n\t'PointsMaterial': 'PointsMaterial',\r\n\t'RawShaderMaterial': 'RawShaderMaterial',\r\n\t'ShaderMaterial': 'ShaderMaterial'\r\n};\r\n\r\nexport { SidebarMaterial };\r\n","import { UITabbedPanel } from './libs/ui.js';\r\n\r\nimport { SidebarObject } from './Sidebar.Object.js';\r\nimport { SidebarGeometry } from './Sidebar.Geometry.js';\r\nimport { SidebarMaterial } from './Sidebar.Material.js';\r\n\r\nfunction SidebarProperties( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UITabbedPanel();\r\n\tcontainer.setId( 'properties' );\r\n\r\n\tcontainer.addTab( 'object', strings.getKey( 'sidebar/properties/object' ), new SidebarObject( editor ) );\r\n\tcontainer.addTab( 'geometry', strings.getKey( 'sidebar/properties/geometry' ), new SidebarGeometry( editor ) );\r\n\tcontainer.addTab( 'material', strings.getKey( 'sidebar/properties/material' ), new SidebarMaterial( editor ) );\r\n\tcontainer.select( 'object' );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarProperties };\r\n","import { UIPanel, UIBreak, UISelect, UIButton, UIText, UINumber, UIRow } from './libs/ui.js';\r\n\r\nfunction SidebarAnimation( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\tvar signals = editor.signals;\r\n\tvar mixer = editor.mixer;\r\n\r\n\tvar actions = {};\r\n\r\n\tsignals.objectSelected.add( function ( object ) {\r\n\r\n\t\tif ( object !== null && object.animations.length > 0 ) {\r\n\r\n\t\t\tvar animations = object.animations;\r\n\r\n\t\t\tcontainer.setDisplay( '' );\r\n\r\n\t\t\tvar options = {};\r\n\t\t\tvar firstAnimation;\r\n\r\n\t\t\tfor ( var animation of animations ) {\r\n\r\n\t\t\t\tif ( firstAnimation === undefined ) firstAnimation = animation.name;\r\n\r\n\t\t\t\tactions[ animation.name ] = mixer.clipAction( animation, object );\r\n\t\t\t\toptions[ animation.name ] = animation.name;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tanimationsSelect.setOptions( options );\r\n\t\t\tanimationsSelect.setValue( firstAnimation );\r\n\t\t\tmixerTimeScaleNumber.setValue( mixer.timeScale );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tcontainer.setDisplay( 'none' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tsignals.objectRemoved.add( function ( object ) {\r\n\r\n\t\tif ( object !== null && object.animations.length > 0 ) {\r\n\r\n\t\t\tmixer.uncacheRoot( object );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\tfunction playAction() {\r\n\r\n\t\tactions[ animationsSelect.getValue() ].play();\r\n\r\n\t}\r\n\r\n\tfunction stopAction() {\r\n\r\n\t\tactions[ animationsSelect.getValue() ].stop();\r\n\r\n\t\tsignals.animationStopped.dispatch();\r\n\r\n\t}\r\n\r\n\tfunction changeTimeScale() {\r\n\r\n\t\tmixer.timeScale = mixerTimeScaleNumber.getValue();\r\n\r\n\t}\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setDisplay( 'none' );\r\n\r\n\tcontainer.add( new UIText( strings.getKey( 'sidebar/animations' ) ).setTextTransform( 'uppercase' ) );\r\n\tcontainer.add( new UIBreak() );\r\n\tcontainer.add( new UIBreak() );\r\n\r\n\t//\r\n\r\n\tvar animationsRow = new UIRow();\r\n\r\n\tvar animationsSelect = new UISelect().setFontSize( '12px' );\r\n\tanimationsRow.add( animationsSelect );\r\n\tanimationsRow.add( new UIButton( strings.getKey( 'sidebar/animations/play' ) ).setMarginLeft( '4px' ).onClick( playAction ) );\r\n\tanimationsRow.add( new UIButton( strings.getKey( 'sidebar/animations/stop' ) ).setMarginLeft( '4px' ).onClick( stopAction ) );\r\n\r\n\tcontainer.add( animationsRow );\r\n\r\n\t//\r\n\r\n\tvar mixerTimeScaleRow = new UIRow();\r\n\tvar mixerTimeScaleNumber = new UINumber( 0.5 ).setWidth( '60px' ).setRange( - 10, 10 ).onChange( changeTimeScale );\r\n\r\n\tmixerTimeScaleRow.add( new UIText( strings.getKey( 'sidebar/animations/timescale' ) ).setWidth( '90px' ) );\r\n\tmixerTimeScaleRow.add( mixerTimeScaleNumber );\r\n\r\n\tcontainer.add( mixerTimeScaleRow );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarAnimation };\r\n","import * as THREE from 'three'\r\n\r\nimport { UINumber, UIPanel, UIRow, UISelect, UIText } from './libs/ui.js';\r\nimport { UIBoolean } from './libs/ui.three.js';\r\n\r\nfunction SidebarProjectRenderer( editor ) {\r\n\r\n\tvar config = editor.config;\r\n\tvar signals = editor.signals;\r\n\tvar strings = editor.strings;\r\n\r\n\tvar currentRenderer = null;\r\n\r\n\tvar container = new UIPanel();\r\n\r\n\tvar headerRow = new UIRow();\r\n\theaderRow.add( new UIText( strings.getKey( 'sidebar/project/renderer' ).toUpperCase() ) );\r\n\tcontainer.add( headerRow );\r\n\r\n\t// Antialias\r\n\r\n\tvar antialiasRow = new UIRow();\r\n\tcontainer.add( antialiasRow );\r\n\r\n\tantialiasRow.add( new UIText( strings.getKey( 'sidebar/project/antialias' ) ).setWidth( '90px' ) );\r\n\r\n\tvar antialiasBoolean = new UIBoolean( config.getKey( 'project/renderer/antialias' ) ).onChange( createRenderer );\r\n\tantialiasRow.add( antialiasBoolean );\r\n\r\n\t// Physically Correct lights\r\n\r\n\tvar physicallyCorrectLightsRow = new UIRow();\r\n\tcontainer.add( physicallyCorrectLightsRow );\r\n\r\n\tphysicallyCorrectLightsRow.add( new UIText( strings.getKey( 'sidebar/project/physicallyCorrectLights' ) ).setWidth( '90px' ) );\r\n\r\n\tvar physicallyCorrectLightsBoolean = new UIBoolean( config.getKey( 'project/renderer/physicallyCorrectLights' ) ).onChange( function () {\r\n\r\n\t\tcurrentRenderer.physicallyCorrectLights = this.getValue();\r\n\t\tsignals.rendererUpdated.dispatch();\r\n\r\n\t} );\r\n\tphysicallyCorrectLightsRow.add( physicallyCorrectLightsBoolean );\r\n\r\n\t// Shadows\r\n\r\n\tvar shadowsRow = new UIRow();\r\n\tcontainer.add( shadowsRow );\r\n\r\n\tshadowsRow.add( new UIText( strings.getKey( 'sidebar/project/shadows' ) ).setWidth( '90px' ) );\r\n\r\n\tvar shadowsBoolean = new UIBoolean( config.getKey( 'project/renderer/shadows' ) ).onChange( updateShadows );\r\n\tshadowsRow.add( shadowsBoolean );\r\n\r\n\tvar shadowTypeSelect = new UISelect().setOptions( {\r\n\t\t0: 'Basic',\r\n\t\t1: 'PCF',\r\n\t\t2: 'PCF Soft',\r\n\t\t//\t3: 'VSM'\r\n\t} ).setWidth( '125px' ).onChange( updateShadows );\r\n\tshadowTypeSelect.setValue( config.getKey( 'project/renderer/shadowType' ) );\r\n\tshadowsRow.add( shadowTypeSelect );\r\n\r\n\tfunction updateShadows() {\r\n\r\n\t\tcurrentRenderer.shadowMap.enabled = shadowsBoolean.getValue();\r\n\t\tcurrentRenderer.shadowMap.type = parseFloat( shadowTypeSelect.getValue() );\r\n\r\n\t\tsignals.rendererUpdated.dispatch();\r\n\r\n\t}\r\n\r\n\t// Tonemapping\r\n\r\n\tvar toneMappingRow = new UIRow();\r\n\tcontainer.add( toneMappingRow );\r\n\r\n\ttoneMappingRow.add( new UIText( strings.getKey( 'sidebar/project/toneMapping' ) ).setWidth( '90px' ) );\r\n\r\n\tvar toneMappingSelect = new UISelect().setOptions( {\r\n\t\t0: 'No',\r\n\t\t1: 'Linear',\r\n\t\t2: 'Reinhard',\r\n\t\t3: 'Cineon',\r\n\t\t4: 'ACESFilmic'\r\n\t} ).setWidth( '120px' ).onChange( updateToneMapping );\r\n\ttoneMappingSelect.setValue( config.getKey( 'project/renderer/toneMapping' ) );\r\n\ttoneMappingRow.add( toneMappingSelect );\r\n\r\n\tvar toneMappingExposure = new UINumber( config.getKey( 'project/renderer/toneMappingExposure' ) );\r\n\ttoneMappingExposure.setDisplay( toneMappingSelect.getValue() === '0' ? 'none' : '' );\r\n\ttoneMappingExposure.setWidth( '30px' ).setMarginLeft( '10px' );\r\n\ttoneMappingExposure.setRange( 0, 10 );\r\n\ttoneMappingExposure.onChange( updateToneMapping );\r\n\ttoneMappingRow.add( toneMappingExposure );\r\n\r\n\tfunction updateToneMapping() {\r\n\r\n\t\ttoneMappingExposure.setDisplay( toneMappingSelect.getValue() === '0' ? 'none' : '' );\r\n\r\n\t\tcurrentRenderer.toneMapping = parseFloat( toneMappingSelect.getValue() );\r\n\t\tcurrentRenderer.toneMappingExposure = toneMappingExposure.getValue();\r\n\t\tsignals.rendererUpdated.dispatch();\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tfunction createRenderer() {\r\n\r\n\t\tcurrentRenderer = new THREE.WebGLRenderer( { antialias: antialiasBoolean.getValue() } );\r\n\t\tcurrentRenderer.outputEncoding = THREE.sRGBEncoding;\r\n\t\tcurrentRenderer.physicallyCorrectLights = physicallyCorrectLightsBoolean.getValue();\r\n\t\tcurrentRenderer.shadowMap.enabled = shadowsBoolean.getValue();\r\n\t\tcurrentRenderer.shadowMap.type = parseFloat( shadowTypeSelect.getValue() );\r\n\t\tcurrentRenderer.toneMapping = parseFloat( toneMappingSelect.getValue() );\r\n\t\tcurrentRenderer.toneMappingExposure = toneMappingExposure.getValue();\r\n\r\n\t\tsignals.rendererCreated.dispatch( currentRenderer );\r\n\t\tsignals.rendererUpdated.dispatch();\r\n\r\n\t}\r\n\r\n\tcreateRenderer();\r\n\r\n\r\n\t// Signals\r\n\r\n\tsignals.editorCleared.add( function () {\r\n\r\n\t\tcurrentRenderer.physicallyCorrectLights = false;\r\n\t\tcurrentRenderer.shadowMap.enabled = true;\r\n\t\tcurrentRenderer.shadowMap.type = THREE.PCFShadowMap;\r\n\t\tcurrentRenderer.toneMapping = THREE.NoToneMapping;\r\n\t\tcurrentRenderer.toneMappingExposure = 1;\r\n\r\n\t\tphysicallyCorrectLightsBoolean.setValue( currentRenderer.physicallyCorrectLights );\r\n\t\tshadowsBoolean.setValue( currentRenderer.shadowMap.enabled );\r\n\t\tshadowTypeSelect.setValue( currentRenderer.shadowMap.type );\r\n\t\ttoneMappingSelect.setValue( currentRenderer.toneMapping );\r\n\t\ttoneMappingExposure.setValue( currentRenderer.toneMappingExposure );\r\n\t\ttoneMappingExposure.setDisplay( currentRenderer.toneMapping === 0 ? 'none' : '' );\r\n\r\n\t\tsignals.rendererUpdated.dispatch();\r\n\r\n\t} );\r\n\r\n\tsignals.rendererUpdated.add( function () {\r\n\r\n\t\tconfig.setKey(\r\n\t\t\t'project/renderer/antialias', antialiasBoolean.getValue(),\r\n\t\t\t'project/renderer/physicallyCorrectLights', physicallyCorrectLightsBoolean.getValue(),\r\n\t\t\t'project/renderer/shadows', shadowsBoolean.getValue(),\r\n\t\t\t'project/renderer/shadowType', parseFloat( shadowTypeSelect.getValue() ),\r\n\t\t\t'project/renderer/toneMapping', parseFloat( toneMappingSelect.getValue() ),\r\n\t\t\t'project/renderer/toneMappingExposure', toneMappingExposure.getValue()\r\n\t\t);\r\n\r\n\t} );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarProjectRenderer };\r\n","import { UIPanel, UIRow, UIInput, UICheckbox, UIText, UISpan } from './libs/ui.js';\r\n\r\n/* import { SidebarProjectMaterials } from './Sidebar.Project.Materials.js'; */\r\nimport { SidebarProjectRenderer } from './Sidebar.Project.Renderer.js';\r\n\r\nfunction SidebarProject( editor ) {\r\n\r\n\tvar config = editor.config;\r\n\tvar signals = editor.signals;\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UISpan();\r\n\r\n\tvar settings = new UIPanel();\r\n\tsettings.setBorderTop( '0' );\r\n\tsettings.setPaddingTop( '20px' );\r\n\tcontainer.add( settings );\r\n\r\n\t// Title\r\n\r\n\tvar titleRow = new UIRow();\r\n\tvar title = new UIInput( config.getKey( 'project/title' ) ).setLeft( '100px' ).setWidth( '150px' ).onChange( function () {\r\n\r\n\t\tconfig.setKey( 'project/title', this.getValue() );\r\n\r\n\t} );\r\n\r\n\ttitleRow.add( new UIText( strings.getKey( 'sidebar/project/title' ) ).setWidth( '90px' ) );\r\n\ttitleRow.add( title );\r\n\r\n\tsettings.add( titleRow );\r\n\r\n\t// Editable\r\n\r\n\tvar editableRow = new UIRow();\r\n\tvar editable = new UICheckbox( config.getKey( 'project/editable' ) ).setLeft( '100px' ).onChange( function () {\r\n\r\n\t\tconfig.setKey( 'project/editable', this.getValue() );\r\n\r\n\t} );\r\n\r\n\teditableRow.add( new UIText( strings.getKey( 'sidebar/project/editable' ) ).setWidth( '90px' ) );\r\n\teditableRow.add( editable );\r\n\r\n\tsettings.add( editableRow );\r\n\r\n\t// WebVR\r\n\r\n\tvar vrRow = new UIRow();\r\n\tvar vr = new UICheckbox( config.getKey( 'project/vr' ) ).setLeft( '100px' ).onChange( function () {\r\n\r\n\t\tconfig.setKey( 'project/vr', this.getValue() );\r\n\r\n\t} );\r\n\r\n\tvrRow.add( new UIText( strings.getKey( 'sidebar/project/vr' ) ).setWidth( '90px' ) );\r\n\tvrRow.add( vr );\r\n\r\n\tsettings.add( vrRow );\r\n\r\n\t//\r\n\r\n\t/* container.add( new SidebarProjectMaterials( editor ) ); */\r\n\tcontainer.add( new SidebarProjectRenderer( editor ) );\r\n\r\n\r\n\t// Signals\r\n\r\n\tsignals.editorCleared.add( function () {\r\n\r\n\t\ttitle.setValue( '' );\r\n\t\tconfig.setKey( 'project/title', '' );\r\n\r\n\t} );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarProject };\r\n","import { UIPanel, UIText, UIRow } from './libs/ui.js';\r\nimport { UIBoolean } from './libs/ui.three.js';\r\n\r\n\r\nfunction SidebarSettingsViewport( editor ) {\r\n\r\n\tvar signals = editor.signals;\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UIPanel();\r\n\r\n\tvar headerRow = new UIRow();\r\n\theaderRow.add( new UIText( strings.getKey( 'sidebar/settings/viewport' ).toUpperCase() ) );\r\n\tcontainer.add( headerRow );\r\n\r\n\t// grid\r\n\r\n\tvar showGridRow = new UIRow();\r\n\r\n\tshowGridRow.add( new UIText( strings.getKey( 'sidebar/settings/viewport/grid' ) ).setWidth( '90px' ) );\r\n\r\n\tvar showGrid = new UIBoolean( true ).onChange( function () {\r\n\r\n\t\tsignals.showGridChanged.dispatch( showGrid.getValue() );\r\n\r\n\t} );\r\n\tshowGridRow.add( showGrid );\r\n\tcontainer.add( showGridRow );\r\n\r\n\t// helpers\r\n\r\n\tvar showHelpersRow = new UIRow();\r\n\r\n\tshowHelpersRow.add( new UIText( strings.getKey( 'sidebar/settings/viewport/helpers' ) ).setWidth( '90px' ) );\r\n\r\n\tvar showHelpers = new UIBoolean( true ).onChange( function () {\r\n\r\n\t\tsignals.showHelpersChanged.dispatch( showHelpers.getValue() );\r\n\r\n\t} );\r\n\tshowHelpersRow.add( showHelpers );\r\n\tcontainer.add( showHelpersRow );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarSettingsViewport };\r\n","import { UIPanel, UIText, UIRow, UIInput } from './libs/ui.js';\r\n\r\nimport { RemoveObjectCommand } from './commands/RemoveObjectCommand.js';\r\n\r\nfunction SidebarSettingsShortcuts( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar IS_MAC = navigator.platform.toUpperCase().indexOf( 'MAC' ) >= 0;\r\n\r\n\tfunction isValidKeyBinding( key ) {\r\n\r\n\t\treturn key.match( /^[A-Za-z0-9]$/i ); // Can't use z currently due to undo/redo\r\n\r\n\t}\r\n\r\n\tvar config = editor.config;\r\n\tvar signals = editor.signals;\r\n\r\n\tvar container = new UIPanel();\r\n\r\n\tvar headerRow = new UIRow();\r\n\theaderRow.add( new UIText( strings.getKey( 'sidebar/settings/shortcuts' ).toUpperCase() ) );\r\n\tcontainer.add( headerRow );\r\n\r\n\tvar shortcuts = [ 'translate', 'rotate', 'scale', 'undo', 'focus' ];\r\n\r\n\tfunction createShortcutInput( name ) {\r\n\r\n\t\tvar configName = 'settings/shortcuts/' + name;\r\n\t\tvar shortcutRow = new UIRow();\r\n\r\n\t\tvar shortcutInput = new UIInput().setWidth( '15px' ).setFontSize( '12px' );\r\n\t\tshortcutInput.setTextAlign( 'center' );\r\n\t\tshortcutInput.setTextTransform( 'lowercase' );\r\n\t\tshortcutInput.onChange( function () {\r\n\r\n\t\t\tvar value = shortcutInput.getValue().toLowerCase();\r\n\r\n\t\t\tif ( isValidKeyBinding( value ) ) {\r\n\r\n\t\t\t\tconfig.setKey( configName, value );\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\t// Automatically highlight when selecting an input field\r\n\t\tshortcutInput.dom.addEventListener( 'click', function () {\r\n\r\n\t\t\tshortcutInput.dom.select();\r\n\r\n\t\t} );\r\n\r\n\t\t// If the value of the input field is invalid, revert the input field\r\n\t\t// to contain the key binding stored in config\r\n\t\tshortcutInput.dom.addEventListener( 'blur', function () {\r\n\r\n\t\t\tif ( ! isValidKeyBinding( shortcutInput.getValue() ) ) {\r\n\r\n\t\t\t\tshortcutInput.setValue( config.getKey( configName ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\t// If a valid key binding character is entered, blur the input field\r\n\t\tshortcutInput.dom.addEventListener( 'keyup', function ( event ) {\r\n\r\n\t\t\tif ( isValidKeyBinding( event.key ) ) {\r\n\r\n\t\t\t\tshortcutInput.dom.blur();\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\tif ( config.getKey( configName ) !== undefined ) {\r\n\r\n\t\t\tshortcutInput.setValue( config.getKey( configName ) );\r\n\r\n\t\t}\r\n\r\n\t\tshortcutInput.dom.maxLength = 1;\r\n\t\tshortcutRow.add( new UIText( strings.getKey( 'sidebar/settings/shortcuts/' + name ) ).setTextTransform( 'capitalize' ).setWidth( '90px' ) );\r\n\t\tshortcutRow.add( shortcutInput );\r\n\r\n\t\tcontainer.add( shortcutRow );\r\n\r\n\t}\r\n\r\n\tfor ( var i = 0; i < shortcuts.length; i ++ ) {\r\n\r\n\t\tcreateShortcutInput( shortcuts[ i ] );\r\n\r\n\t}\r\n\r\n\tdocument.addEventListener( 'keydown', function ( event ) {\r\n\r\n\t\tswitch ( event.key.toLowerCase() ) {\r\n\r\n\t\t\tcase 'backspace':\r\n\r\n\t\t\t\tevent.preventDefault(); // prevent browser back\r\n\r\n\t\t\t\t// fall-through\r\n\r\n\t\t\tcase 'delete':\r\n\r\n\t\t\t\tvar object = editor.selected;\r\n\r\n\t\t\t\tif ( object === null ) return;\r\n\r\n\t\t\t\tvar parent = object.parent;\r\n\t\t\t\tif ( parent !== null ) editor.execute( new RemoveObjectCommand( editor, object ) );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase config.getKey( 'settings/shortcuts/translate' ):\r\n\r\n\t\t\t\tsignals.transformModeChanged.dispatch( 'translate' );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase config.getKey( 'settings/shortcuts/rotate' ):\r\n\r\n\t\t\t\tsignals.transformModeChanged.dispatch( 'rotate' );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase config.getKey( 'settings/shortcuts/scale' ):\r\n\r\n\t\t\t\tsignals.transformModeChanged.dispatch( 'scale' );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase config.getKey( 'settings/shortcuts/undo' ):\r\n\r\n\t\t\t\tif ( IS_MAC ? event.metaKey : event.ctrlKey ) {\r\n\r\n\t\t\t\t\tevent.preventDefault(); // Prevent browser specific hotkeys\r\n\r\n\t\t\t\t\tif ( event.shiftKey ) {\r\n\r\n\t\t\t\t\t\teditor.redo();\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\teditor.undo();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase config.getKey( 'settings/shortcuts/focus' ):\r\n\r\n\t\t\t\tif ( editor.selected !== null ) {\r\n\r\n\t\t\t\t\teditor.focus( editor.selected );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}, false );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarSettingsShortcuts };\r\n","\r\nimport { UIPanel, UIBreak, UIText } from './libs/ui.js';\r\nimport { UIBoolean, UIOutliner } from './libs/ui.three.js';\r\n\r\nfunction SidebarSettingsHistory( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar signals = editor.signals;\r\n\r\n\tvar config = editor.config;\r\n\r\n\tvar history = editor.history;\r\n\r\n\tvar container = new UIPanel();\r\n\r\n\tcontainer.add( new UIText( strings.getKey( 'sidebar/history' ).toUpperCase() ) );\r\n\r\n\t//\r\n\r\n\tvar persistent = new UIBoolean( config.getKey( 'settings/history' ), strings.getKey( 'sidebar/history/persistent' ) );\r\n\tpersistent.setPosition( 'absolute' ).setRight( '8px' );\r\n\tpersistent.onChange( function () {\r\n\r\n\t\tvar value = this.getValue();\r\n\r\n\t\tconfig.setKey( 'settings/history', value );\r\n\r\n\t\tif ( value ) {\r\n\r\n\t\t\talert( 'The history will be preserved across sessions.\\nThis can have an impact on performance when working with textures.' );\r\n\r\n\t\t\tvar lastUndoCmd = history.undos[ history.undos.length - 1 ];\r\n\t\t\tvar lastUndoId = ( lastUndoCmd !== undefined ) ? lastUndoCmd.id : 0;\r\n\t\t\teditor.history.enableSerialization( lastUndoId );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tsignals.historyChanged.dispatch();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\tcontainer.add( persistent );\r\n\r\n\tcontainer.add( new UIBreak(), new UIBreak() );\r\n\r\n\tvar ignoreObjectSelectedSignal = false;\r\n\r\n\tvar outliner = new UIOutliner( editor );\r\n\toutliner.onChange( function () {\r\n\r\n\t\tignoreObjectSelectedSignal = true;\r\n\r\n\t\teditor.history.goToState( parseInt( outliner.getValue() ) );\r\n\r\n\t\tignoreObjectSelectedSignal = false;\r\n\r\n\t} );\r\n\tcontainer.add( outliner );\r\n\r\n\t//\r\n\r\n\tvar refreshUI = function () {\r\n\r\n\t\tvar options = [];\r\n\r\n\t\tfunction buildOption( object ) {\r\n\r\n\t\t\tvar option = document.createElement( 'div' );\r\n\t\t\toption.value = object.id;\r\n\r\n\t\t\treturn option;\r\n\r\n\t\t}\r\n\r\n\t\t( function addObjects( objects ) {\r\n\r\n\t\t\tfor ( var i = 0, l = objects.length; i < l; i ++ ) {\r\n\r\n\t\t\t\tvar object = objects[ i ];\r\n\r\n\t\t\t\tvar option = buildOption( object );\r\n\t\t\t\toption.innerHTML = '&nbsp;' + object.name;\r\n\r\n\t\t\t\toptions.push( option );\r\n\r\n\t\t\t}\r\n\r\n\t\t} )( history.undos );\r\n\r\n\r\n\t\t( function addObjects( objects ) {\r\n\r\n\t\t\tfor ( var i = objects.length - 1; i >= 0; i -- ) {\r\n\r\n\t\t\t\tvar object = objects[ i ];\r\n\r\n\t\t\t\tvar option = buildOption( object );\r\n\t\t\t\toption.innerHTML = '&nbsp;' + object.name;\r\n\t\t\t\toption.style.opacity = 0.3;\r\n\r\n\t\t\t\toptions.push( option );\r\n\r\n\t\t\t}\r\n\r\n\t\t} )( history.redos );\r\n\r\n\t\toutliner.setOptions( options );\r\n\r\n\t};\r\n\r\n\trefreshUI();\r\n\r\n\t// events\r\n\r\n\tsignals.editorCleared.add( refreshUI );\r\n\r\n\tsignals.historyChanged.add( refreshUI );\r\n\tsignals.historyChanged.add( function ( cmd ) {\r\n\r\n\t\tif ( ignoreObjectSelectedSignal === true ) return;\r\n\r\n\t\toutliner.setValue( cmd !== undefined ? cmd.id : null );\r\n\r\n\t} );\r\n\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarSettingsHistory };\r\n","import { UIPanel, UIRow, UISelect, UISpan, UIText } from './libs/ui.js';\r\n\r\nimport { SidebarSettingsViewport } from './Sidebar.Settings.Viewport.js';\r\nimport { SidebarSettingsShortcuts } from './Sidebar.Settings.Shortcuts.js';\r\nimport { SidebarSettingsHistory } from './Sidebar.Settings.History.js';\r\n\r\nfunction SidebarSettings( editor ) {\r\n\r\n\tvar config = editor.config;\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UISpan();\r\n\r\n\tvar settings = new UIPanel();\r\n\tsettings.setBorderTop( '0' );\r\n\tsettings.setPaddingTop( '20px' );\r\n\tcontainer.add( settings );\r\n\r\n\t// language\r\n\r\n\tvar options = {\r\n\t\ten: 'English',\r\n\t\tfr: 'Français',\r\n\t\tzh: '中文'\r\n\t};\r\n\r\n\tvar languageRow = new UIRow();\r\n\tvar language = new UISelect().setWidth( '150px' );\r\n\tlanguage.setOptions( options );\r\n\r\n\tif ( config.getKey( 'language' ) !== undefined ) {\r\n\r\n\t\tlanguage.setValue( config.getKey( 'language' ) );\r\n\r\n\t}\r\n\r\n\tlanguage.onChange( function () {\r\n\r\n\t\tvar value = this.getValue();\r\n\r\n\t\teditor.config.setKey( 'language', value );\r\n\r\n\t} );\r\n\r\n\tlanguageRow.add( new UIText( strings.getKey( 'sidebar/settings/language' ) ).setWidth( '90px' ) );\r\n\tlanguageRow.add( language );\r\n\r\n\tsettings.add( languageRow );\r\n\r\n\t//\r\n\r\n\tcontainer.add( new SidebarSettingsViewport( editor ) );\r\n\tcontainer.add( new SidebarSettingsShortcuts( editor ) );\r\n\tcontainer.add( new SidebarSettingsHistory( editor ) );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { SidebarSettings };\r\n","import { UITabbedPanel, UISpan } from './libs/ui.js';\r\n\r\nimport { SidebarScene } from './Sidebar.Scene.js';\r\nimport { SidebarProperties } from './Sidebar.Properties.js';\r\nimport { SidebarAnimation } from './Sidebar.Animation.js';\r\nimport { SidebarProject } from './Sidebar.Project.js';\r\nimport { SidebarSettings } from './Sidebar.Settings.js';\r\n\r\nfunction Sidebar( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UITabbedPanel();\r\n\tcontainer.setId( 'sidebar' );\r\n\r\n\tvar scene = new UISpan().add(\r\n\t\tnew SidebarScene( editor ),\r\n\t\tnew SidebarProperties( editor ),\r\n\t\tnew SidebarAnimation( editor ),\r\n\t);\r\n\tvar project = new SidebarProject( editor );\r\n\tvar settings = new SidebarSettings( editor );\r\n\r\n\tcontainer.addTab( 'scene', strings.getKey( 'sidebar/scene' ), scene );\r\n\tcontainer.addTab( 'project', strings.getKey( 'sidebar/project' ), project );\r\n\tcontainer.addTab( 'settings', strings.getKey( 'sidebar/settings' ), settings );\r\n\tcontainer.select( 'scene' );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { Sidebar };\r\n","import * as THREE from 'three'\r\n\r\nimport { UIPanel, UIRow, UIHorizontalRule } from './libs/ui.js';\r\n\r\nimport { AddObjectCommand } from './commands/AddObjectCommand.js';\r\n\r\nfunction MenubarAdd( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setClass( 'menu' );\r\n\r\n\tvar title = new UIPanel();\r\n\ttitle.setClass( 'title' );\r\n\ttitle.setTextContent( strings.getKey( 'menubar/add' ) );\r\n\tcontainer.add( title );\r\n\r\n\tvar options = new UIPanel();\r\n\toptions.setClass( 'options' );\r\n\tcontainer.add( options );\r\n\r\n\t// Group\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/add/group' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tvar mesh = new THREE.Group();\r\n\t\tmesh.name = 'Zone';\r\n\r\n\t\teditor.execute( new AddObjectCommand( editor, mesh ) );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t//\r\n\r\n\toptions.add( new UIHorizontalRule() );\r\n\r\n\t// Box\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/add/box' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tvar geometry = new THREE.BoxGeometry( 1, 1, 1, 1, 1, 1 );\r\n\t\tvar mesh = new THREE.Mesh( geometry, new THREE.MeshStandardMaterial() );\r\n\t\tmesh.name = 'Box';\r\n\r\n\t\teditor.execute( new AddObjectCommand( editor, mesh ) );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t\r\n\t// Sphere\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/add/sphere' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tvar geometry = new THREE.SphereGeometry( 1, 32, 16, 0, Math.PI * 2, 0, Math.PI );\r\n\t\tvar mesh = new THREE.Mesh( geometry, new THREE.MeshStandardMaterial() );\r\n\t\tmesh.name = 'Sphere';\r\n\r\n\t\teditor.execute( new AddObjectCommand( editor, mesh ) );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\t\r\n\r\n\toptions.add( new UIHorizontalRule() );\r\n\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { MenubarAdd };\r\n","import * as THREE from 'three';\r\n\r\nimport { UIPanel, UIRow, UIHorizontalRule } from './libs/ui.js';\r\n\r\nimport { AddObjectCommand } from './commands/AddObjectCommand.js';\r\nimport { RemoveObjectCommand } from './commands/RemoveObjectCommand.js';\r\nimport { SetPositionCommand } from './commands/SetPositionCommand.js';\r\n\r\nfunction MenubarEdit( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setClass( 'menu' );\r\n\r\n\tvar title = new UIPanel();\r\n\ttitle.setClass( 'title' );\r\n\ttitle.setTextContent( strings.getKey( 'menubar/edit' ) );\r\n\tcontainer.add( title );\r\n\r\n\tvar options = new UIPanel();\r\n\toptions.setClass( 'options' );\r\n\tcontainer.add( options );\r\n\r\n\t// Undo\r\n\r\n\tvar undo = new UIRow();\r\n\tundo.setClass( 'option' );\r\n\tundo.setTextContent( strings.getKey( 'menubar/edit/undo' ) );\r\n\tundo.onClick( function () {\r\n\r\n\t\teditor.undo();\r\n\r\n\t} );\r\n\toptions.add( undo );\r\n\r\n\t// Redo\r\n\r\n\tvar redo = new UIRow();\r\n\tredo.setClass( 'option' );\r\n\tredo.setTextContent( strings.getKey( 'menubar/edit/redo' ) );\r\n\tredo.onClick( function () {\r\n\r\n\t\teditor.redo();\r\n\r\n\t} );\r\n\toptions.add( redo );\r\n\r\n\t// Clear History\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/edit/clear_history' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tif ( window.confirm( 'The Undo/Redo History will be cleared. Are you sure?' ) ) {\r\n\r\n\t\t\teditor.history.clear();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\r\n\teditor.signals.historyChanged.add( function () {\r\n\r\n\t\tvar history = editor.history;\r\n\r\n\t\tundo.setClass( 'option' );\r\n\t\tredo.setClass( 'option' );\r\n\r\n\t\tif ( history.undos.length == 0 ) {\r\n\r\n\t\t\tundo.setClass( 'inactive' );\r\n\r\n\t\t}\r\n\r\n\t\tif ( history.redos.length == 0 ) {\r\n\r\n\t\t\tredo.setClass( 'inactive' );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n\t// ---\r\n\r\n\toptions.add( new UIHorizontalRule() );\r\n\r\n\t// Center\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/edit/center' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tvar object = editor.selected;\r\n\r\n\t\tif ( object === null || object.parent === null ) return; // avoid centering the camera or scene\r\n\r\n\t\tconst aabb = new THREE.Box3().setFromObject( object );\r\n\t\tconst center = aabb.getCenter( new THREE.Vector3() );\r\n\t\tconst newPosition = new THREE.Vector3();\r\n\r\n\t\tnewPosition.x = object.position.x + ( object.position.x - center.x );\r\n\t\tnewPosition.y = object.position.y + ( object.position.y - center.y );\r\n\t\tnewPosition.z = object.position.z + ( object.position.z - center.z );\r\n\r\n\t\teditor.execute( new SetPositionCommand( editor, object, newPosition ) );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t// Clone\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/edit/clone' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tvar object = editor.selected;\r\n\r\n\t\tif ( object === null || object.parent === null ) return; // avoid cloning the camera or scene\r\n\r\n\t\tobject = object.clone();\r\n\r\n\t\teditor.execute( new AddObjectCommand( editor, object ) );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t// Delete\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/edit/delete' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tvar object = editor.selected;\r\n\r\n\t\tif ( object !== null && object.parent !== null ) {\r\n\r\n\t\t\teditor.execute( new RemoveObjectCommand( editor, object ) );\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t//\r\n\r\n\toptions.add( new UIHorizontalRule() );\r\n\r\n\t// Set textures to sRGB. See #15903\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/edit/fixcolormaps' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\teditor.scene.traverse( fixColorMap );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\tvar colorMaps = [ 'map', 'envMap', 'emissiveMap' ];\r\n\r\n\tfunction fixColorMap( obj ) {\r\n\r\n\t\tvar material = obj.material;\r\n\r\n\t\tif ( material !== undefined ) {\r\n\r\n\t\t\tif ( Array.isArray( material ) === true ) {\r\n\r\n\t\t\t\tfor ( var i = 0; i < material.length; i ++ ) {\r\n\r\n\t\t\t\t\tfixMaterial( material[ i ] );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfixMaterial( material );\r\n\r\n\t\t\t}\r\n\r\n\t\t\teditor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction fixMaterial( material ) {\r\n\r\n\t\tvar needsUpdate = material.needsUpdate;\r\n\r\n\t\tfor ( var i = 0; i < colorMaps.length; i ++ ) {\r\n\r\n\t\t\tvar map = material[ colorMaps[ i ] ];\r\n\r\n\t\t\tif ( map ) {\r\n\r\n\t\t\t\tmap.encoding = THREE.sRGBEncoding;\r\n\t\t\t\tneedsUpdate = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tmaterial.needsUpdate = needsUpdate;\r\n\r\n\t}\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { MenubarEdit };\r\n","import { UIPanel, UIRow } from './libs/ui.js';\r\n\r\nfunction MenubarView( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setClass( 'menu' );\r\n\r\n\tvar title = new UIPanel();\r\n\ttitle.setClass( 'title' );\r\n\ttitle.setTextContent( strings.getKey( 'menubar/view' ) );\r\n\tcontainer.add( title );\r\n\r\n\tvar options = new UIPanel();\r\n\toptions.setClass( 'options' );\r\n\tcontainer.add( options );\r\n\r\n\t// Fullscreen\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/view/fullscreen' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tif ( document.fullscreenElement === null ) {\r\n\r\n\t\t\tdocument.documentElement.requestFullscreen();\r\n\r\n\t\t} else if ( document.exitFullscreen ) {\r\n\r\n\t\t\tdocument.exitFullscreen();\r\n\r\n\t\t}\r\n\r\n\t\t// Safari\r\n\r\n\t\tif ( document.webkitFullscreenElement === null ) {\r\n\r\n\t\t\tdocument.documentElement.webkitRequestFullscreen();\r\n\r\n\t\t} else if ( document.webkitExitFullscreen ) {\r\n\r\n\t\t\tdocument.webkitExitFullscreen();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t// VR (Work in progress)\r\n\r\n\tif ( 'xr' in navigator ) {\r\n\r\n\t\tnavigator.xr.isSessionSupported( 'immersive-vr' )\r\n\t\t\t.then( function ( supported ) {\r\n\r\n\t\t\t\tif ( supported ) {\r\n\r\n\t\t\t\t\tvar option = new UIRow();\r\n\t\t\t\t\toption.setClass( 'option' );\r\n\t\t\t\t\toption.setTextContent( 'VR' );\r\n\t\t\t\t\toption.onClick( function () {\r\n\r\n\t\t\t\t\t\teditor.signals.toggleVR.dispatch();\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\toptions.add( option );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t}\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { MenubarView };\r\n","import * as THREE from 'three';\r\n\r\n\r\nimport { UIPanel, UIRow, UIHorizontalRule } from './libs/ui.js';\r\n\r\nfunction MenubarFile( editor ) {\r\n\r\n\tvar config = editor.config;\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setClass( 'menu' );\r\n\r\n\tvar title = new UIPanel();\r\n\ttitle.setClass( 'title' );\r\n\ttitle.setTextContent( strings.getKey( 'menubar/file' ) );\r\n\tcontainer.add( title );\r\n\r\n\tvar options = new UIPanel();\r\n\toptions.setClass( 'options' );\r\n\tcontainer.add( options );\r\n\r\n\t// New\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/file/new' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tif ( window.confirm( 'Any unsaved data will be lost. Are you sure?' ) ) {\r\n\r\n\t\t\teditor.clear();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t//\r\n\r\n\toptions.add( new UIHorizontalRule() );\r\n\r\n\t// Import\r\n\r\n\tvar form = document.createElement( 'form' );\r\n\tform.style.display = 'none';\r\n\tdocument.body.appendChild( form );\r\n\r\n\tvar fileInput = document.createElement( 'input' );\r\n\tfileInput.multiple = true;\r\n\tfileInput.type = 'file';\r\n\tfileInput.addEventListener( 'change', function () {\r\n\r\n\t\teditor.loader.loadFiles( fileInput.files );\r\n\t\tform.reset();\r\n\r\n\t} );\r\n\tform.appendChild( fileInput );\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/file/import' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tfileInput.click();\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t//\r\n\r\n\toptions.add( new UIHorizontalRule() );\r\n\r\n\t// Export Geometry\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/file/export/geometry' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tvar object = editor.selected;\r\n\r\n\t\tif ( object === null ) {\r\n\r\n\t\t\talert( 'No object selected.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar geometry = object.geometry;\r\n\r\n\t\tif ( geometry === undefined ) {\r\n\r\n\t\t\talert( 'The selected object doesn\\'t have geometry.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar output = geometry.toJSON();\r\n\r\n\t\ttry {\r\n\r\n\t\t\toutput = JSON.stringify( output, null, '\\t' );\r\n\t\t\toutput = output.replace( /[\\n\\t]+([\\d\\.e\\-\\[\\]]+)/g, '$1' );\r\n\r\n\t\t} catch ( e ) {\r\n\r\n\t\t\toutput = JSON.stringify( output );\r\n\r\n\t\t}\r\n\r\n\t\tsaveString( output, 'geometry.json' );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t// Export Object\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/file/export/object' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tvar object = editor.selected;\r\n\r\n\t\tif ( object === null ) {\r\n\r\n\t\t\talert( 'No object selected' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar output = object.toJSON();\r\n\r\n\t\ttry {\r\n\r\n\t\t\toutput = JSON.stringify( output, null, '\\t' );\r\n\t\t\toutput = output.replace( /[\\n\\t]+([\\d\\.e\\-\\[\\]]+)/g, '$1' );\r\n\r\n\t\t} catch ( e ) {\r\n\r\n\t\t\toutput = JSON.stringify( output );\r\n\r\n\t\t}\r\n\r\n\t\tsaveString( output, 'model.json' );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t// Export Scene\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/file/export/scene' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\tvar output = editor.scene.toJSON();\r\n\r\n\t\ttry {\r\n\r\n\t\t\toutput = JSON.stringify( output, null, '\\t' );\r\n\t\t\toutput = output.replace( /[\\n\\t]+([\\d\\.e\\-\\[\\]]+)/g, '$1' );\r\n\r\n\t\t} catch ( e ) {\r\n\r\n\t\t\toutput = JSON.stringify( output );\r\n\r\n\t\t}\r\n\r\n\t\tsaveString( output, 'scene.json' );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t\r\n\r\n\t//\r\n\r\n\tvar link = document.createElement( 'a' );\r\n\tfunction save( blob, filename ) {\r\n\r\n\t\tif ( link.href ) {\r\n\r\n\t\t\tURL.revokeObjectURL( link.href );\r\n\r\n\t\t}\r\n\r\n\t\tlink.href = URL.createObjectURL( blob );\r\n\t\tlink.download = filename || 'data.json';\r\n\t\tlink.dispatchEvent( new MouseEvent( 'click' ) );\r\n\r\n\t}\r\n\r\n\tfunction saveArrayBuffer( buffer, filename ) {\r\n\r\n\t\tsave( new Blob( [ buffer ], { type: 'application/octet-stream' } ), filename );\r\n\r\n\t}\r\n\r\n\tfunction saveString( text, filename ) {\r\n\r\n\t\tsave( new Blob( [ text ], { type: 'text/plain' } ), filename );\r\n\r\n\t}\r\n\r\n\tfunction getAnimations( scene ) {\r\n\r\n\t\tvar animations = [];\r\n\r\n\t\tscene.traverse( function ( object ) {\r\n\r\n\t\t\tanimations.push( ... object.animations );\r\n\r\n\t\t} );\r\n\r\n\t\treturn animations;\r\n\r\n\t}\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { MenubarFile };\r\n","import { UIPanel, UIRow } from './libs/ui.js';\r\n\r\nfunction MenubarHelp( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setClass( 'menu' );\r\n\r\n\tvar title = new UIPanel();\r\n\ttitle.setClass( 'title' );\r\n\ttitle.setTextContent( strings.getKey( 'menubar/help' ) );\r\n\tcontainer.add( title );\r\n\r\n\tvar options = new UIPanel();\r\n\toptions.setClass( 'options' );\r\n\tcontainer.add( options );\r\n\r\n\t// Source code\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/help/source_code' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\twindow.open( 'https://github.com/mrdoob/three.js/tree/master/editor', '_blank' );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t/*\r\n\t// Icon\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/help/icons' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\twindow.open( 'https://www.flaticon.com/packs/interface-44', '_blank' );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\t*/\r\n\r\n\t// About\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/help/about' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\twindow.open( 'https://threejs.org', '_blank' );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\t// Manual\r\n\r\n\tvar option = new UIRow();\r\n\toption.setClass( 'option' );\r\n\toption.setTextContent( strings.getKey( 'menubar/help/manual' ) );\r\n\toption.onClick( function () {\r\n\r\n\t\twindow.open( 'https://github.com/mrdoob/three.js/wiki/Editor-Manual', '_blank' );\r\n\r\n\t} );\r\n\toptions.add( option );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { MenubarHelp };\r\n","import * as THREE from 'three'\r\n\r\nimport { UIPanel, UIText } from './libs/ui.js';\r\nimport { UIBoolean } from './libs/ui.three.js';\r\n\r\nfunction MenubarStatus( editor ) {\r\n\r\n\tvar strings = editor.strings;\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setClass( 'menu right' );\r\n\r\n\tvar autosave = new UIBoolean( editor.config.getKey( 'autosave' ), strings.getKey( 'menubar/status/autosave' ) );\r\n\tautosave.text.setColor( '#888' );\r\n\tautosave.onChange( function () {\r\n\r\n\t\tvar value = this.getValue();\r\n\r\n\t\teditor.config.setKey( 'autosave', value );\r\n\r\n\t\tif ( value === true ) {\r\n\r\n\t\t\teditor.signals.sceneGraphChanged.dispatch();\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\tcontainer.add( autosave );\r\n\r\n\teditor.signals.savingStarted.add( function () {\r\n\r\n\t\tautosave.text.setTextDecoration( 'underline' );\r\n\r\n\t} );\r\n\r\n\teditor.signals.savingFinished.add( function () {\r\n\r\n\t\tautosave.text.setTextDecoration( 'none' );\r\n\r\n\t} );\r\n\r\n\tvar version = new UIText( 'r' + THREE.REVISION );\r\n\tversion.setClass( 'title' );\r\n\tversion.setOpacity( 0.5 );\r\n\tcontainer.add( version );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { MenubarStatus };\r\n","import { UIPanel } from './libs/ui.js';\r\n\r\nimport { MenubarAdd } from './Menubar.Add.js';\r\nimport { MenubarEdit } from './Menubar.Edit.js';\r\nimport { MenubarView } from './Menubar.View.js';\r\nimport { MenubarFile } from './Menubar.File.js';\r\nimport { MenubarHelp } from './Menubar.Help.js';\r\nimport { MenubarStatus } from './Menubar.Status.js';\r\n\r\nfunction Menubar( editor ) {\r\n\r\n\tvar container = new UIPanel();\r\n\tcontainer.setId( 'menubar' );\r\n\r\n\tcontainer.add( new MenubarFile( editor ) );\r\n\tcontainer.add( new MenubarEdit( editor ) );\r\n\tcontainer.add( new MenubarAdd( editor ) );\r\n\tcontainer.add( new MenubarView( editor ) );\r\n\tcontainer.add( new MenubarHelp( editor ) );\r\n\r\n\tcontainer.add( new MenubarStatus( editor ) );\r\n\r\n\treturn container;\r\n\r\n}\r\n\r\nexport { Menubar };\r\n","import { UIElement } from './libs/ui.js';\r\n\r\nfunction Resizer( editor ) {\r\n\r\n\tconst signals = editor.signals;\r\n\r\n\tconst dom = document.createElement( 'div' );\r\n\tdom.id = 'resizer';\r\n\r\n\tfunction onPointerDown( event ) {\r\n\r\n\t\tif ( event.isPrimary === false ) return;\r\n\r\n\t\tdom.ownerDocument.addEventListener( 'pointermove', onPointerMove, false );\r\n\t\tdom.ownerDocument.addEventListener( 'pointerup', onPointerUp, false );\r\n\r\n\t}\r\n\r\n\tfunction onPointerUp( event ) {\r\n\r\n\t\tif ( event.isPrimary === false ) return;\r\n\r\n\t\tdom.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\r\n\t\tdom.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\r\n\r\n\t}\r\n\r\n\tfunction onPointerMove( event ) {\r\n\r\n\t\t// PointerEvent's movementX/movementY are 0 in WebKit\r\n\r\n\t\tif ( event.isPrimary === false ) return;\r\n\r\n\t\tconst rect = dom.getBoundingClientRect();\r\n\t\tconst x = ( document.body.offsetWidth - rect.right ) - event.movementX;\r\n\r\n\t\tdom.style.right = x + 'px';\r\n\r\n\t\tdocument.getElementById( 'sidebar' ).style.width = ( x + rect.width ) + 'px';\r\n\t\tdocument.getElementById( 'viewport' ).style.right = ( x + rect.width ) + 'px';\r\n\r\n\t\tsignals.windowResize.dispatch();\r\n\r\n\t}\r\n\r\n\tdom.addEventListener( 'pointerdown', onPointerDown, false );\r\n\r\n\treturn new UIElement( dom );\r\n\r\n}\r\n\r\nexport { Resizer };\r\n","import React, { useCallback, useEffect, useState } from 'react';\r\nimport { Signal } from 'signals';\r\nimport './SampleComponent.css';\r\n\r\ninterface SampleComponentProps {\r\n    signal: Signal;\r\n}\r\n\r\nfunction SampleComponent(props: SampleComponentProps) {\r\n    const [objectName, setObjectName] = useState();\r\n\r\n\r\n    const objectSelected = useCallback(\r\n        (object) => {\r\n            setObjectName(object?.name);\r\n        },\r\n        [],\r\n    );\r\n\r\n    useEffect(() => {\r\n        props.signal.add(objectSelected);\r\n        return () => {\r\n            props.signal.remove(objectSelected)\r\n        }\r\n    }, [objectSelected, props.signal]);  \r\n\r\n    return (\r\n        <div className=\"SampleComponent\">\r\n            Selected Name:{objectName}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default SampleComponent;\r\n","\r\n// ## License\r\n// \r\n// Copyright (c) 2011 Evan Wallace (http://madebyevan.com/), under the MIT license.\r\n// THREE.js rework by thrax\r\n\r\n// # class CSG\r\n// Holds a binary space partition tree representing a 3D solid. Two solids can\r\n// be combined using the `union()`, `subtract()`, and `intersect()` methods.\r\n\r\n\r\nclass CSG {\r\n    constructor() {\r\n        this.polygons = [];\r\n    }\r\n    clone() {\r\n        let csg = new CSG();\r\n        csg.polygons = this.polygons.map(function(p) {\r\n            return p.clone();\r\n        });\r\n        return csg;\r\n    }\r\n\r\n    toPolygons() {\r\n        return this.polygons;\r\n    }\r\n\r\n    union(csg) {\r\n        let a = new Node(this.clone().polygons);\r\n        let b = new Node(csg.clone().polygons);\r\n        a.clipTo(b);\r\n        b.clipTo(a);\r\n        b.invert();\r\n        b.clipTo(a);\r\n        b.invert();\r\n        a.build(b.allPolygons());\r\n        return CSG.fromPolygons(a.allPolygons());\r\n    }\r\n\r\n    subtract(csg) {\r\n        let a = new Node(this.clone().polygons);\r\n        let b = new Node(csg.clone().polygons);\r\n        a.invert();\r\n        a.clipTo(b);\r\n        b.clipTo(a);\r\n        b.invert();\r\n        b.clipTo(a);\r\n        b.invert();\r\n        a.build(b.allPolygons());\r\n        a.invert();\r\n        return CSG.fromPolygons(a.allPolygons());\r\n    }\r\n\r\n    intersect(csg) {\r\n        let a = new Node(this.clone().polygons);\r\n        let b = new Node(csg.clone().polygons);\r\n        a.invert();\r\n        b.clipTo(a);\r\n        b.invert();\r\n        a.clipTo(b);\r\n        b.clipTo(a);\r\n        a.build(b.allPolygons());\r\n        a.invert();\r\n        return CSG.fromPolygons(a.allPolygons());\r\n    }\r\n\r\n    // Return a new CSG solid with solid and empty space switched. This solid is\r\n    // not modified.\r\n    inverse() {\r\n        let csg = this.clone();\r\n        csg.polygons.forEach(p=>p.flip());\r\n        return csg;\r\n    }\r\n}\r\n\r\n// Construct a CSG solid from a list of `Polygon` instances.\r\nCSG.fromPolygons=function(polygons) {\r\n    let csg = new CSG();\r\n    csg.polygons = polygons;\r\n    return csg;\r\n};\r\n\r\n// # class Vector\r\n\r\n// Represents a 3D vector.\r\n// \r\n// Example usage:\r\n// \r\n//     new CSG.Vector(1, 2, 3);\r\n\r\n\r\n\r\nclass Vector {\r\n    constructor(x=0, y=0, z=0) {\r\n        this.x=x;\r\n        this.y=y;\r\n        this.z=z;\r\n    }\r\n    copy(v){\r\n        this.x=v.x;\r\n        this.y=v.y;\r\n        this.z=v.z;\r\n        return this;\r\n    }\r\n    clone() {\r\n        return new Vector(this.x,this.y,this.z);\r\n    }\r\n    negate() {\r\n        this.x*=-1;\r\n        this.y*=-1;\r\n        this.z*=-1;\r\n        return this;\r\n    }\r\n    add(a) {\r\n        this.x+=a.x;\r\n        this.y+=a.y;\r\n        this.z+=a.z;\r\n        return this;\r\n    }\r\n    sub(a) {\r\n        this.x-=a.x;\r\n        this.y-=a.y;\r\n        this.z-=a.z;\r\n        return this;\r\n    }\r\n    times(a) {\r\n        this.x*=a;\r\n        this.y*=a;\r\n        this.z*=a;\r\n        return this;\r\n    }\r\n    dividedBy(a) {\r\n        this.x/=a;\r\n        this.y/=a;\r\n        this.z/=a;\r\n        return this;\r\n    }\r\n    lerp(a, t) {\r\n        return this.add(tv0.copy(a).sub(this).times(t));\r\n    }\r\n    unit() {\r\n        return this.dividedBy(this.length());\r\n    }\r\n    length(){\r\n        return Math.sqrt((this.x**2)+(this.y**2)+(this.z**2));\r\n    }\r\n    normalize(){\r\n        return this.unit();\r\n    }\r\n    cross(b) {\r\n        let a = this;\r\n        const ax = a.x, ay = a.y, az = a.z;\r\n        const bx = b.x, by = b.y, bz = b.z;\r\n\r\n        this.x = ay * bz - az * by;\r\n        this.y = az * bx - ax * bz;\r\n        this.z = ax * by - ay * bx;\r\n\r\n        return this;\r\n    }\r\n    dot(b){\r\n        return (this.x*b.x)+(this.y*b.y)+(this.z*b.z);\r\n    }\r\n}\r\n\r\n//Temporaries used to avoid internal allocation..\r\nlet tv0=new Vector();\r\nlet tv1=new Vector();\r\n\r\n\r\n// # class Vertex\r\n\r\n// Represents a vertex of a polygon. Use your own vertex class instead of this\r\n// one to provide additional features like texture coordinates and vertex\r\n// colors. Custom vertex classes need to provide a `pos` property and `clone()`,\r\n// `flip()`, and `interpolate()` methods that behave analogous to the ones\r\n// defined by `CSG.Vertex`. This class provides `normal` so convenience\r\n// functions like `CSG.sphere()` can return a smooth vertex normal, but `normal`\r\n// is not used anywhere else.\r\n\r\nclass Vertex {\r\n\r\n    constructor(pos, normal, uv, color) {\r\n        this.pos = new Vector().copy(pos);\r\n        this.normal = new Vector().copy(normal);\r\n        this.uv = new Vector().copy(uv);\r\n        this.uv.z=0;\r\n        color && (this.color = new Vector().copy(color));\r\n    }\r\n\r\n    clone() {\r\n        return new Vertex(this.pos,this.normal,this.uv,this.color);\r\n    }\r\n\r\n    // Invert all orientation-specific data (e.g. vertex normal). Called when the\r\n    // orientation of a polygon is flipped.\r\n    flip() {\r\n        this.normal.negate();\r\n    }\r\n\r\n    // Create a new vertex between this vertex and `other` by linearly\r\n    // interpolating all properties using a parameter of `t`. Subclasses should\r\n    // override this to interpolate additional properties.\r\n    interpolate(other, t) {\r\n        return new Vertex(this.pos.clone().lerp(other.pos, t),this.normal.clone().lerp(other.normal, t),this.uv.clone().lerp(other.uv, t), this.color&&other.color&&this.color.clone().lerp(other.color,t));\r\n    }\r\n}\r\n\r\n// # class Plane\r\n\r\n// Represents a plane in 3D space.\r\n\r\nclass Plane {\r\n    constructor(normal, w) {\r\n        this.normal = normal;\r\n        this.w = w;\r\n    }\r\n\r\n    clone() {\r\n        return new Plane(this.normal.clone(),this.w);\r\n    }\r\n\r\n    flip() {\r\n        this.normal.negate();\r\n        this.w = -this.w;\r\n    }\r\n\r\n    // Split `polygon` by this plane if needed, then put the polygon or polygon\r\n    // fragments in the appropriate lists. Coplanar polygons go into either\r\n    // `coplanarFront` or `coplanarBack` depending on their orientation with\r\n    // respect to this plane. Polygons in front or in back of this plane go into\r\n    // either `front` or `back`.\r\n    splitPolygon(polygon, coplanarFront, coplanarBack, front, back) {\r\n        const COPLANAR = 0;\r\n        const FRONT = 1;\r\n        const BACK = 2;\r\n        const SPANNING = 3;\r\n\r\n        // Classify each point as well as the entire polygon into one of the above\r\n        // four classes.\r\n        let polygonType = 0;\r\n        let types = [];\r\n        for (let i = 0; i < polygon.vertices.length; i++) {\r\n            let t = this.normal.dot(polygon.vertices[i].pos) - this.w;\r\n            let type = (t < -Plane.EPSILON) ? BACK : (t > Plane.EPSILON) ? FRONT : COPLANAR;\r\n            polygonType |= type;\r\n            types.push(type);\r\n        }\r\n\r\n        // Put the polygon in the correct list, splitting it when necessary.\r\n        switch (polygonType) {\r\n        case COPLANAR:\r\n            (this.normal.dot(polygon.plane.normal) > 0 ? coplanarFront : coplanarBack).push(polygon);\r\n            break;\r\n        case FRONT:\r\n            front.push(polygon);\r\n            break;\r\n        case BACK:\r\n            back.push(polygon);\r\n            break;\r\n        case SPANNING:\r\n            let f = []\r\n                , b = [];\r\n            for (let i = 0; i < polygon.vertices.length; i++) {\r\n                let j = (i + 1) % polygon.vertices.length;\r\n                let ti = types[i]\r\n                    , tj = types[j];\r\n                let vi = polygon.vertices[i]\r\n                    , vj = polygon.vertices[j];\r\n                if (ti != BACK)\r\n                    f.push(vi);\r\n                if (ti != FRONT)\r\n                    b.push(ti != BACK ? vi.clone() : vi);\r\n                if ((ti | tj) == SPANNING) {\r\n                    let t = (this.w - this.normal.dot(vi.pos)) / this.normal.dot(tv0.copy(vj.pos).sub(vi.pos));\r\n                    let v = vi.interpolate(vj, t);\r\n                    f.push(v);\r\n                    b.push(v.clone());\r\n                }\r\n            }\r\n            if (f.length >= 3)\r\n                front.push(new Polygon(f,polygon.shared));\r\n            if (b.length >= 3)\r\n                back.push(new Polygon(b,polygon.shared));\r\n            break;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n// `Plane.EPSILON` is the tolerance used by `splitPolygon()` to decide if a\r\n// point is on the plane.\r\nPlane.EPSILON = 1e-5;\r\n\r\nPlane.fromPoints = function(a, b, c) {\r\n    let n = tv0.copy(b).sub(a).cross(tv1.copy(c).sub(a)).normalize();\r\n    return new Plane(n.clone(),n.dot(a));\r\n};\r\n\r\n\r\n// # class Polygon\r\n\r\n// Represents a convex polygon. The vertices used to initialize a polygon must\r\n// be coplanar and form a convex loop. They do not have to be `Vertex`\r\n// instances but they must behave similarly (duck typing can be used for\r\n// customization).\r\n// \r\n// Each convex polygon has a `shared` property, which is shared between all\r\n// polygons that are clones of each other or were split from the same polygon.\r\n// This can be used to define per-polygon properties (such as surface color).\r\n\r\nclass Polygon {\r\n    constructor(vertices, shared) {\r\n        this.vertices = vertices;\r\n        this.shared = shared;\r\n        this.plane = Plane.fromPoints(vertices[0].pos, vertices[1].pos, vertices[2].pos);\r\n    }\r\n    clone() {\r\n        return new Polygon(this.vertices.map(v=>v.clone()),this.shared);\r\n    }\r\n    flip() {\r\n        this.vertices.reverse().map(v=>v.flip());\r\n        this.plane.flip();\r\n    }\r\n}\r\n\r\n// # class Node\r\n\r\n// Holds a node in a BSP tree. A BSP tree is built from a collection of polygons\r\n// by picking a polygon to split along. That polygon (and all other coplanar\r\n// polygons) are added directly to that node and the other polygons are added to\r\n// the front and/or back subtrees. This is not a leafy BSP tree since there is\r\n// no distinction between internal and leaf nodes.\r\n\r\nclass Node {\r\n    constructor(polygons) {\r\n        this.plane = null;\r\n        this.front = null;\r\n        this.back = null;\r\n        this.polygons = [];\r\n        if (polygons)\r\n            this.build(polygons);\r\n    }\r\n    clone() {\r\n        let node = new Node();\r\n        node.plane = this.plane && this.plane.clone();\r\n        node.front = this.front && this.front.clone();\r\n        node.back = this.back && this.back.clone();\r\n        node.polygons = this.polygons.map(p=>p.clone());\r\n        return node;\r\n    }\r\n\r\n    // Convert solid space to empty space and empty space to solid space.\r\n    invert() {\r\n        for (let i = 0; i < this.polygons.length; i++)\r\n            this.polygons[i].flip();\r\n        \r\n        this.plane && this.plane.flip();\r\n        this.front && this.front.invert();\r\n        this.back && this.back.invert();\r\n        let temp = this.front;\r\n        this.front = this.back;\r\n        this.back = temp;\r\n    }\r\n\r\n    // Recursively remove all polygons in `polygons` that are inside this BSP\r\n    // tree.\r\n    clipPolygons(polygons) {\r\n        if (!this.plane)\r\n            return polygons.slice();\r\n        let front = []\r\n            , back = [];\r\n        for (let i = 0; i < polygons.length; i++) {\r\n            this.plane.splitPolygon(polygons[i], front, back, front, back);\r\n        }\r\n        if (this.front)\r\n            front = this.front.clipPolygons(front);\r\n        if (this.back)\r\n            back = this.back.clipPolygons(back);\r\n        else\r\n            back = [];\r\n        return front.concat(back);\r\n    }\r\n\r\n    // Remove all polygons in this BSP tree that are inside the other BSP tree\r\n    // `bsp`.\r\n    clipTo(bsp) {\r\n        this.polygons = bsp.clipPolygons(this.polygons);\r\n        if (this.front)\r\n            this.front.clipTo(bsp);\r\n        if (this.back)\r\n            this.back.clipTo(bsp);\r\n    }\r\n\r\n    // Return a list of all polygons in this BSP tree.\r\n    allPolygons() {\r\n        let polygons = this.polygons.slice();\r\n        if (this.front)\r\n            polygons = polygons.concat(this.front.allPolygons());\r\n        if (this.back)\r\n            polygons = polygons.concat(this.back.allPolygons());\r\n        return polygons;\r\n    }\r\n\r\n    // Build a BSP tree out of `polygons`. When called on an existing tree, the\r\n    // new polygons are filtered down to the bottom of the tree and become new\r\n    // nodes there. Each set of polygons is partitioned using the first polygon\r\n    // (no heuristic is used to pick a good split).\r\n    build(polygons) {\r\n        if (!polygons.length)\r\n            return;\r\n        if (!this.plane)\r\n            this.plane = polygons[0].plane.clone();\r\n        let front = []\r\n            , back = [];\r\n        for (let i = 0; i < polygons.length; i++) {\r\n            this.plane.splitPolygon(polygons[i], this.polygons, this.polygons, front, back);\r\n        }\r\n        if (front.length) {\r\n            if (!this.front)\r\n                this.front = new Node();\r\n            this.front.build(front);\r\n        }\r\n        if (back.length) {\r\n            if (!this.back)\r\n                this.back = new Node();\r\n            this.back.build(back);\r\n        }\r\n    }\r\n}\r\n\r\n\r\nCSG.fromJSON=function(json){\r\n    return CSG.fromPolygons(json.polygons.map(p=>new Polygon(p.vertices.map(v=> new Vertex(v.pos,v.normal,v.uv)),p.shared)));\r\n};\r\n\r\nexport {CSG,Vertex,Vector,Polygon,Plane};\r\n\r\n\r\n\r\n// Return a new CSG solid representing space in either this solid or in the\r\n// solid `csg`. Neither this solid nor the solid `csg` are modified.\r\n// \r\n//     A.union(B)\r\n// \r\n//     +-------+            +-------+\r\n//     |       |            |       |\r\n//     |   A   |            |       |\r\n//     |    +--+----+   =   |       +----+\r\n//     +----+--+    |       +----+       |\r\n//          |   B   |            |       |\r\n//          |       |            |       |\r\n//          +-------+            +-------+\r\n// \r\n// Return a new CSG solid representing space in this solid but not in the\r\n// solid `csg`. Neither this solid nor the solid `csg` are modified.\r\n// \r\n//     A.subtract(B)\r\n// \r\n//     +-------+            +-------+\r\n//     |       |            |       |\r\n//     |   A   |            |       |\r\n//     |    +--+----+   =   |    +--+\r\n//     +----+--+    |       +----+\r\n//          |   B   |\r\n//          |       |\r\n//          +-------+\r\n// \r\n// Return a new CSG solid representing space both this solid and in the\r\n// solid `csg`. Neither this solid nor the solid `csg` are modified.\r\n// \r\n//     A.intersect(B)\r\n// \r\n//     +-------+\r\n//     |       |\r\n//     |   A   |\r\n//     |    +--+----+   =   +--+\r\n//     +----+--+    |       +--+\r\n//          |   B   |\r\n//          |       |\r\n//          +-------+\r\n// \r\n\r\n","'use strict';\r\n\r\nimport * as THREE from 'three';\r\n\r\nimport { CSG, Vertex, Vector, Polygon } from './csg-lib.js';\r\n\r\nlet { BufferGeometry, Vector3, Vector2 } = THREE;\r\n\r\n\r\nCSG.fromGeometry = function (geom, objectIndex) {\r\n\r\n    let polys = [];\r\n    if (geom.isGeometry) {\r\n        let fs = geom.faces;\r\n        let vs = geom.vertices;\r\n        let fm = ['a', 'b', 'c'];\r\n        for (let i = 0; i < fs.length; i++) {\r\n            let f = fs[i];\r\n            let vertices = [];\r\n            for (let j = 0; j < 3; j++)\r\n                vertices.push(new Vertex(vs[f[fm[j]]], f.vertexNormals[j], geom.faceVertexUvs[0][i][j]));\r\n            polys.push(new Polygon(vertices, objectIndex));\r\n        }\r\n    } else if (geom.isBufferGeometry) {\r\n        let vertices, normals, uvs;\r\n        let posattr = geom.attributes.position;\r\n        let normalattr = geom.attributes.normal;\r\n        let uvattr = geom.attributes.uv;\r\n        let colorattr = geom.attributes.color;\r\n        let index;\r\n        if (geom.index)\r\n            index = geom.index.array;\r\n        else {\r\n            index = new Array((posattr.array.length / posattr.itemSize) | 0);\r\n            for (let i = 0; i < index.length; i++)\r\n                index[i] = i;\r\n        }\r\n        let triCount = (index.length / 3) | 0;\r\n        polys = new Array(triCount);\r\n        for (let i = 0, pli = 0, l = index.length; i < l; i += 3, pli++) {\r\n            let vertices = new Array(3);\r\n            for (let j = 0; j < 3; j++) {\r\n                let vi = index[i + j];\r\n                let vp = vi * 3;\r\n                let vt = vi * 2;\r\n                let x = posattr.array[vp];\r\n                let y = posattr.array[vp + 1];\r\n                let z = posattr.array[vp + 2];\r\n                let nx = normalattr.array[vp];\r\n                let ny = normalattr.array[vp + 1];\r\n                let nz = normalattr.array[vp + 2];\r\n                let u = uvattr.array[vt];\r\n                let v = uvattr.array[vt + 1];\r\n                vertices[j] = new Vertex({\r\n                    x,\r\n                    y,\r\n                    z\r\n                }, {\r\n                    x: nx,\r\n                    y: ny,\r\n                    z: nz\r\n                }, {\r\n                    x: u,\r\n                    y: v,\r\n                    z: 0\r\n                }, colorattr && { x: colorattr.array[vt], y: colorattr.array[vt + 1], z: colorattr.array[vt + 2] });\r\n            }\r\n            polys[pli] = new Polygon(vertices, objectIndex);\r\n        }\r\n    } else\r\n        console.error('Unsupported CSG input type:' + geom.type);\r\n    return CSG.fromPolygons(polys);\r\n};\r\n\r\nlet ttvv0 = new THREE.Vector3();\r\nlet tmpm3 = new THREE.Matrix3();\r\nCSG.fromMesh = function (mesh, objectIndex) {\r\n    let csg = CSG.fromGeometry(mesh.geometry, objectIndex);\r\n    tmpm3.getNormalMatrix(mesh.matrix);\r\n    for (let i = 0; i < csg.polygons.length; i++) {\r\n        let p = csg.polygons[i];\r\n        for (let j = 0; j < p.vertices.length; j++) {\r\n            let v = p.vertices[j];\r\n            v.pos.copy(ttvv0.copy(v.pos).applyMatrix4(mesh.matrix));\r\n            v.normal.copy(ttvv0.copy(v.normal).applyMatrix3(tmpm3));\r\n        }\r\n    }\r\n    return csg;\r\n};\r\n\r\nlet nbuf3 = (ct) => {\r\n    return {\r\n        top: 0,\r\n        array: new Float32Array(ct),\r\n        write: function (v) { (this.array[this.top++] = v.x); (this.array[this.top++] = v.y); (this.array[this.top++] = v.z); }\r\n    };\r\n};\r\nlet nbuf2 = (ct) => {\r\n    return {\r\n        top: 0,\r\n        array: new Float32Array(ct),\r\n        write: function (v) { (this.array[this.top++] = v.x); (this.array[this.top++] = v.y); }\r\n    };\r\n};\r\n\r\nCSG.toMesh = function (csg, toMatrix, toMaterial) {\r\n\r\n    let geom = CSG.toGeometry(csg, toMatrix);\r\n    let m = new THREE.Mesh(geom, toMaterial);\r\n    m.matrix.copy(toMatrix);\r\n    m.matrix.decompose(m.position, m.quaternion, m.scale);\r\n    m.rotation.setFromQuaternion(m.quaternion);\r\n    m.updateMatrixWorld();\r\n    m.castShadow = m.receiveShadow = true;\r\n    return m;\r\n};\r\n\r\nCSG.toGeometry = function (csg, toMatrix) {\r\n    let ps = csg.polygons;\r\n    let geom;\r\n    let g2;\r\n    if (1) { //BufferGeometry path\r\n        let triCount = 0;\r\n        ps.forEach(p => triCount += (p.vertices.length - 2));\r\n        geom = new THREE.BufferGeometry();\r\n\r\n        let vertices = nbuf3(triCount * 3 * 3);\r\n        let normals = nbuf3(triCount * 3 * 3);\r\n        let uvs = nbuf2(triCount * 2 * 3);\r\n        let colors;\r\n        let grps = [];\r\n        ps.forEach(p => {\r\n            let pvs = p.vertices;\r\n            let pvlen = pvs.length;\r\n            if (p.shared !== undefined) {\r\n                if (!grps[p.shared]) grps[p.shared] = [];\r\n            }\r\n            if (pvlen && pvs[0].color !== undefined) {\r\n                if (!colors) colors = nbuf3(triCount * 3 * 3);\r\n            }\r\n            for (let j = 3; j <= pvlen; j++) {\r\n                (p.shared !== undefined) && (grps[p.shared].push(vertices.top / 3, (vertices.top / 3) + 1, (vertices.top / 3) + 2));\r\n                vertices.write(pvs[0].pos);\r\n                vertices.write(pvs[j - 2].pos);\r\n                vertices.write(pvs[j - 1].pos);\r\n                normals.write(pvs[0].normal);\r\n                normals.write(pvs[j - 2].normal);\r\n                normals.write(pvs[j - 1].normal);\r\n                uvs.write(pvs[0].uv);\r\n                uvs.write(pvs[j - 2].uv);\r\n                uvs.write(pvs[j - 1].uv);\r\n                colors && (colors.write(pvs[0].color) || colors.write(pvs[j - 2].color) || colors.write(pvs[j - 1].color));\r\n            }\r\n        }\r\n        );\r\n        geom.setAttribute('position', new THREE.BufferAttribute(vertices.array, 3));\r\n        geom.setAttribute('normal', new THREE.BufferAttribute(normals.array, 3));\r\n        geom.setAttribute('uv', new THREE.BufferAttribute(uvs.array, 2));\r\n        colors && geom.setAttribute('color', new THREE.BufferAttribute(colors.array, 3));\r\n        if (grps.length) {\r\n            let index = [];\r\n            let gbase = 0;\r\n            for (let gi = 0; gi < grps.length; gi++) {\r\n                geom.addGroup(gbase, grps[gi].length, gi);\r\n                gbase += grps[gi].length;\r\n                index = index.concat(grps[gi]);\r\n            }\r\n            geom.setIndex(index);\r\n        }\r\n        g2 = geom;\r\n    }\r\n\r\n    let inv = new THREE.Matrix4().copy(toMatrix).invert();\r\n    geom.applyMatrix4(inv);\r\n    geom.computeBoundingSphere();\r\n    geom.computeBoundingBox();\r\n    return geom;\r\n};\r\n\r\n\r\nexport default CSG;\r\n","import { Operation } from \"../../components/ZoneManagerPanel/BooleanAlgebraRow\";\r\n\r\nexport default class ZoneConstructorController {\r\n    commonPrefix: number[];\r\n    tails: number[][];\r\n\r\n    parseOperation(op: Operation, geometry: number) {\r\n        switch (op) {\r\n            case \"intersection\":\r\n                this.extendPrefix(geometry);\r\n                break;\r\n            case \"left-subtraction\":\r\n                this.extendPrefix(-geometry);\r\n                break;\r\n            case \"right-subtraction\":\r\n                this.shiftTails(geometry);\r\n                console.log(this.commonPrefix, this.tails);\r\n                break;\r\n        }\r\n    }\r\n\r\n    extendPrefix(geometry: number) {\r\n        this.commonPrefix = [geometry, ...this.commonPrefix];\r\n    }\r\n\r\n    shiftTails(geometry: number) {\r\n        this.tails = [\r\n            ...this.commonPrefix.map((el) => [-el]),\r\n            ...this.tails.reduce((prev, el) => {\r\n                console.log(\"prev array\", prev);\r\n                if (prev.length === 0) return el.map((el2) => [-el2]);\r\n                return el.reduceRight((prev2, el2) => {\r\n                    return [\r\n                        ...prev2,\r\n                        ...prev.reduceRight((prev3, el3) => {\r\n                            if (el3.indexOf(-el2) !== -1) return prev3;\r\n                            return [...prev3, [...el3, -el2]];\r\n                        }, [] as number[][]),\r\n                    ];\r\n                }, [] as number[][]);\r\n            }, [] as number[][]),\r\n        ];\r\n        this.commonPrefix = [geometry];\r\n    }\r\n\r\n    toString() {\r\n        let prefix = this.commonPrefix.reduceRight((prev, el) => {\r\n            return prev + (el > 0 ? \"+\" + el : el) + \" \";\r\n        }, \"\") as string;\r\n        return (\r\n            this.tails.reduceRight((prev, el) => {\r\n                return (\r\n                    prev +\r\n                    el.reduce((prev1, el1) => {\r\n                        return (el1 > 0 ? \"+\" + el1 : el1) + \" \" + prev1;\r\n                    }, \"\" as string) +\r\n                    prefix +\r\n                    \"OR \"\r\n                );\r\n            }, \"\") + (this.tails.length === 0 ? prefix + \" OR\" : \"\")\r\n        ).slice(0, -4);\r\n    }\r\n\r\n    getDimension = (target: any) => {\r\n        if (!Array.isArray(target)) {\r\n            return target === null ? null : 0;\r\n        } else {\r\n            let dim = null;\r\n            target.every((el) => {\r\n                dim = this.getDimension(el);\r\n                return dim === null;\r\n            });\r\n            return dim === null ? dim : dim + 1;\r\n        }\r\n    };\r\n\r\n    constructor(\r\n        prefix?: number[] | number,\r\n        tails?: number[][] | number[] | number\r\n    ) {\r\n        if (prefix != null)\r\n            switch (this.getDimension(prefix)) {\r\n                case 0:\r\n                    this.commonPrefix = [prefix as number];\r\n                    break;\r\n                case 1:\r\n                    this.commonPrefix = prefix as number[];\r\n                    break;\r\n                default:\r\n                    this.commonPrefix = [];\r\n            }\r\n        else this.commonPrefix = [];\r\n\r\n        if (tails != null)\r\n            switch (this.getDimension(tails)) {\r\n                case 0:\r\n                    this.tails = [[tails as number]];\r\n                    break;\r\n                case 1:\r\n                    this.tails = [tails as number[]];\r\n                    break;\r\n                case 2:\r\n                    this.tails = tails as number[][];\r\n                    break;\r\n                default:\r\n                    this.tails = [];\r\n            }\r\n        else this.tails = [];\r\n    }\r\n}\r\n","import { AlgebraRow } from \"../../components/ZoneManagerPanel/BooleanAlgebraRow\";\r\nimport ZoneConstructorController from \"./ZoneConstructorController\";\r\n\r\nfunction parseRow(zoneOperationRow:AlgebraRow){\r\n    let controller:ZoneConstructorController;\r\n    if(zoneOperationRow.geometries?.[0]){\r\n        controller = new ZoneConstructorController([zoneOperationRow.geometries[0]],[])\r\n        zoneOperationRow.operations.every((op,id)=>{\r\n            let nextGeo: number;\r\n            if(!zoneOperationRow.geometries?.[id+1] || !op)\r\n                return false;\r\n            else{\r\n                nextGeo = zoneOperationRow.geometries?.[id+1] as number;\r\n                controller.parseOperation(op,nextGeo);\r\n                // console.log(controller.toString().slice(0,-3));\r\n            }\r\n            return true;\r\n        });\r\n        return controller.toString();\r\n    }\r\n    return \"\";\r\n}\r\nfunction parseZone(zoneOperationRows:AlgebraRow[]){\r\n    console.log(zoneOperationRows);\r\n    let result: string = \"\";\r\n    zoneOperationRows.forEach(el=>{result = result.concat(parseRow(el)+\" OR\")});\r\n    console.log(result.slice(0,-3));\r\n}\r\n\r\nexport { parseZone };\r\n\r\n","import { MenuItem, Select } from \"@material-ui/core\";\r\nimport { useState } from \"react\";\r\ntype GeometryInputProps = {\r\n    id: number,\r\n    geometries: THREE.Object3D[],\r\n    push: (uuid: number) => void\r\n    value?: number | null;\r\n}\r\n\r\n\r\nfunction GeometryInput(props: GeometryInputProps) {\r\n    const [selected, setSelected] = useState(props?.value ?? 0);\r\n\r\n    const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n        setSelected(event.target.value as number);\r\n        props.push(event.target.value as number);\r\n    };\r\n\r\n    return (\r\n        <Select\r\n            labelId={\"GeometryLabel\" + props.id}\r\n            id={\"GeometryInput\" + props.id} label={props.id}\r\n            className=\"geometrySelect\"\r\n            displayEmpty\r\n            value={selected}\r\n            onChange={handleChange}\r\n        >\r\n            <MenuItem disabled value={0}>\r\n                <em>Geometry</em>\r\n            </MenuItem>\r\n            {props.geometries.map((geo, index) => {\r\n                return (<MenuItem key={geo.id} value={geo.id}>{geo.name}</MenuItem>)\r\n            })}\r\n        </Select>\r\n    )\r\n}\r\nexport default GeometryInput;\r\n","import { MenuItem, Select } from \"@material-ui/core\";\r\nimport { useState } from \"react\";\r\n\r\ntype OperationInputProps = {\r\n    id: number,\r\n    push: (op:Operation) => void,\r\n    pop: () => void,\r\n    value?: Operation|null,\r\n    canClear?: boolean,\r\n}\r\ntype Operation = \"intersection\" | \"left-subtraction\" | \"right-subtraction\" \r\n\r\n\r\nfunction OperationInput(props: OperationInputProps) {\r\n    const [selected, setSelected] = useState<Operation|\"\">(props?.value??\"\");\r\n    const handleChange = (event: React.ChangeEvent<{ value: unknown }>) => {\r\n        setSelected(event.target.value as (\"\"|Operation));\r\n        if(event.target.value as string !== \"\")\r\n            props.push(event.target.value as Operation)\r\n        else\r\n            props.pop();\r\n    };\r\n    return (<Select \r\n        id={\"OperationInput\"+props.id} \r\n        label={props.id} \r\n        className=\"operationSelect\"\r\n        value={selected}\r\n        onChange={handleChange}\r\n    >\r\n        <MenuItem disabled value={0}>\r\n            <em>Operation</em>\r\n        </MenuItem>\r\n        {props.canClear && (<MenuItem value={\"\"}>\r\n            X\r\n        </MenuItem>)}\r\n        <MenuItem value={\"left-subtraction\"}><img src=\"./images/L.png\" alt=\"left subtraction\"/></MenuItem>\r\n        <MenuItem value={\"intersection\"}><img src=\"./images/S.png\" alt=\"intersection\"/></MenuItem>\r\n        <MenuItem value={\"right-subtraction\"}><img src=\"./images/R.png\" alt=\"right subtraction\"/></MenuItem>\r\n    </Select>)\r\n}\r\nexport default OperationInput;\r\n","import { Button } from \"@material-ui/core\";\r\nimport { Fragment, useEffect, useState } from \"react\";\r\nimport GeometryInput from \"./GeometryInput\";\r\nimport OperationInput from \"./OperationInput\";\r\n\r\ntype BooleanAlgebraRowProps = {\r\n    id: number,\r\n    del: () => void,\r\n    change: (row: AlgebraRow) => void,\r\n    value?: AlgebraRow,\r\n    possibleObjects: THREE.Object3D[]\r\n}\r\n\r\nexport type Operation = \"intersection\" | \"left-subtraction\" | \"right-subtraction\";\r\n\r\nexport type AlgebraRow = {\r\n    geometries: (number | null)[],\r\n    operations: (Operation | null)[]\r\n}\r\n\r\n\r\nfunction BooleanAlgebraRow(props: BooleanAlgebraRowProps) {\r\n    const [algebraRow, setAlgebraRow] = useState<AlgebraRow>(props.value ?? { geometries: [], operations: [] });\r\n\r\n    const pushGeometry = (index: number) => (id: number) => {\r\n        if (index === algebraRow.geometries.length)\r\n            setAlgebraRow((prev) => {\r\n                return {\r\n                    geometries: [\r\n                        ...prev.geometries,\r\n                        props.possibleObjects.find(el => el.id === id)?.id ?? null\r\n                    ],\r\n                    operations: prev.operations\r\n                }\r\n            })\r\n        else\r\n            setAlgebraRow((prev) => {\r\n                return {\r\n                    geometries: [\r\n                        ...prev.geometries.map((el, elIndex) => {\r\n                            return index === elIndex ? id : el\r\n                        }),\r\n                    ],\r\n                    operations: prev.operations\r\n                }\r\n            })\r\n    }\r\n    const removeOperation = (id: number) => () => {\r\n        setAlgebraRow((prev) => {\r\n            return {\r\n                geometries: [\r\n                    ...prev.geometries.slice(0, id + 1)\r\n                ],\r\n                operations: [\r\n                    ...prev.operations.slice(0, id)\r\n                ]\r\n            }\r\n        })\r\n    }\r\n\r\n    useEffect(() => {\r\n        props.change(algebraRow);\r\n    }, [algebraRow]);\r\n\r\n    useEffect(() => {\r\n        setAlgebraRow(props.value ?? { geometries: [], operations: [] });\r\n    }, [props]);\r\n    \r\n    const pushOperation = (id: number) => (op: Operation) => {\r\n        if (id === algebraRow.operations.length)\r\n            setAlgebraRow((prev) => {\r\n                return {\r\n                    geometries: prev.geometries,\r\n                    operations: [\r\n                        ...prev.operations,\r\n                        op\r\n                    ]\r\n                }\r\n            })\r\n        else\r\n            setAlgebraRow((prev) => {\r\n                return {\r\n                    geometries: prev.geometries,\r\n                    operations: [\r\n                        ...prev.operations.map((el, index) => {\r\n                            return index === id ? op : el\r\n                        }),\r\n                    ]\r\n                }\r\n            })\r\n    }\r\n    return (<div className=\"zoneManagerRow\">{algebraRow.geometries.map((geo, id) => {\r\n\r\n        return (<Fragment key={id} >\r\n            <GeometryInput\r\n                id={id}\r\n                geometries={props.possibleObjects}\r\n                push={pushGeometry(id)}\r\n                value={geo}\r\n            />\r\n            <OperationInput\r\n                id={id}\r\n                push={pushOperation(id)}\r\n                pop={removeOperation(id)}\r\n                value={algebraRow.operations?.[id]}\r\n                canClear={algebraRow.operations.length <= id + 1}\r\n            />\r\n        </Fragment>)\r\n    })}\r\n        {algebraRow.operations.length === algebraRow.geometries.length &&\r\n            (<GeometryInput\r\n                id={algebraRow.geometries.length}\r\n                geometries={props.possibleObjects}\r\n                push={pushGeometry(algebraRow.geometries.length)}\r\n            />)\r\n        }\r\n        <Button className=\"deleteButton\" onClick={props.del}>X</Button>\r\n    </div>)\r\n}\r\n\r\nexport default BooleanAlgebraRow;\r\n","import { Button } from \"@material-ui/core\";\r\nimport { useCallback, useEffect, useState } from \"react\";\r\nimport { Editor } from \"../../ThreeEditor/js/Editor\";\r\nimport { parseZone } from \"../../util/parseZone/parseZone\";\r\nimport BooleanAlgebraRow, { AlgebraRow } from \"./BooleanAlgebraRow\";\r\nimport \"./zoneManagerPanel.css\";\r\n\r\n\r\n\r\nfunction ZoneManagerPanel(props: { editor: Editor }) {\r\n    const [rows, setRows] = useState<AlgebraRow[]>([{ geometries: [], operations: [] }]);\r\n    const [allObjects, setAllObjects] = useState<THREE.Object3D[]>([]);\r\n\r\n\r\n    const changeRowValues = (rowId: number) => (row: AlgebraRow) => {\r\n        setRows((prev) => [...prev.map((el, id) => { return rowId === id ? row : el })]);\r\n    }\r\n    const addAlgebraRow = () => {\r\n        setRows((prev) => [...prev, { geometries: [], operations: [] }]);\r\n    };\r\n    const removeRow = (removeId: number) => () => {\r\n        setRows((prev) => {\r\n            let newRows = [...prev.filter((el, id) => id !== removeId)];\r\n            if(newRows.length === 0) newRows.push({ geometries: [], operations: [] });\r\n            return newRows;\r\n        });\r\n    }\r\n\r\n    const refreshObjectsList = useCallback(\r\n        () => {\r\n            setAllObjects([...props.editor.scene.children]);\r\n        },\r\n        [props]);\r\n\r\n    useEffect(() => {\r\n        refreshObjectsList();\r\n        props.editor.signals.objectAdded.add(refreshObjectsList);\r\n        props.editor.signals.objectRemoved.add(refreshObjectsList);\r\n        return () => {\r\n            props.editor.signals.objectAdded.remove(refreshObjectsList);\r\n            props.editor.signals.objectRemoved.remove(refreshObjectsList);\r\n        }\r\n    }, [props, refreshObjectsList]);\r\n\r\n    return (<div className=\"zoneManagerWrapper\">\r\n        {rows.map((row, id) => {\r\n            return (<BooleanAlgebraRow\r\n                key={id}\r\n                id={id}\r\n                del={removeRow(id)}\r\n                change={changeRowValues(id)}\r\n                value={row}\r\n                possibleObjects={allObjects}\r\n            ></BooleanAlgebraRow>)\r\n        })}\r\n        <Button className=\"addRowButton\" onClick={addAlgebraRow}>+</Button>\r\n        <Button className=\"parseZoneButton\" onClick={()=>parseZone(rows)}>Parse Zone</Button>\r\n    </div>);\r\n}\r\n\r\nexport default ZoneManagerPanel;\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { initEditor } from './main';\r\nimport './css/main.css';\r\nimport SampleComponent from './components/SampleComponent';\r\nimport { Editor } from './js/Editor';\r\nimport * as THREE from 'three';\r\nimport CSG from './js/libs/csg/three-csg';\r\nimport ZoneManagerPanel from '../components/ZoneManagerPanel/ZoneManagerPanel';\r\n\r\n\r\nfunction ThreeEditor() {\r\n  const containerEl = useRef(null);\r\n\r\n\r\n  const [editor, setEditor] = useState<Editor>();\r\n\r\n  useEffect(() => {\r\n    if (containerEl.current) {\r\n      const { editor, viewport, toolbar, sidebar, menubar, resizer } = initEditor(containerEl.current);\r\n      setEditor(editor);\r\n\r\n      // Make 2 box meshes..\r\n\r\n      let meshA = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 1));\r\n      let meshB = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 1));\r\n\r\n      //offset one of the boxes by half its width..\r\n\r\n      meshB.position.add(new THREE.Vector3(0.5, 0.5, 0.5));\r\n\r\n      //Make sure the .matrix of each mesh is current\r\n\r\n      meshA.updateMatrix();\r\n      meshB.updateMatrix();\r\n\r\n      //Create a bsp tree from each of the meshes\r\n\r\n      let bspA = CSG.fromMesh(meshA);\r\n      let bspB = CSG.fromMesh(meshB);\r\n\r\n      // Subtract one bsp from the other via .subtract... other supported modes are .union and .intersect\r\n\r\n      let bspResult = bspA.subtract(bspB);\r\n\r\n      //Get the resulting mesh from the result bsp, and assign meshA.material to the resulting mesh\r\n\r\n      let meshResult = CSG.toMesh(bspResult, meshA.matrix, meshA.material);\r\n\r\n      meshResult.name = 'meshResult';\r\n      meshResult.material = new THREE.MeshNormalMaterial();\r\n      editor.sceneHelpers.add(meshResult);\r\n    }\r\n    return () => {\r\n\r\n    }\r\n  }, [containerEl]);\r\n\r\n\r\n  return (\r\n    <div className=\"ThreeEditor\" ref={containerEl}>\r\n      {editor &&\r\n        <>\r\n          <SampleComponent signal={editor.signals.objectSelected} ></SampleComponent>\r\n          <ZoneManagerPanel editor={editor}></ZoneManagerPanel>\r\n        </>\r\n      }\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ThreeEditor;\r\n","import * as THREE from 'three';\r\n\r\nimport { Editor } from './js/Editor.js';\r\nimport { Viewport } from './js/Viewport.js';\r\nimport { Toolbar } from './js/Toolbar.js';\r\nimport { Sidebar } from './js/Sidebar.js';\r\nimport { Menubar } from './js/Menubar.js';\r\nimport { Resizer } from './js/Resizer.js';\r\n\r\n\r\nexport function initEditor(container) {\r\n\r\n    container = container || document.body;\r\n\r\n    window.URL = window.URL || window.webkitURL;\r\n    window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder;\r\n\r\n    Number.prototype.format = function () {\r\n\r\n        return this.toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1,');\r\n\r\n    };\r\n\r\n    //\r\n\r\n    var editor = new Editor();\r\n\r\n    window.editor = editor; // Expose editor to Console\r\n    window.THREE = THREE; // Expose THREE to APP Scripts and Console\r\n\r\n    var viewport = new Viewport(editor);\r\n    container.appendChild(viewport.dom);\r\n\r\n    var toolbar = new Toolbar(editor);\r\n    container.appendChild(toolbar.dom);\r\n\r\n    var sidebar = new Sidebar(editor);\r\n    container.appendChild(sidebar.dom);\r\n\r\n    var menubar = new Menubar(editor);\r\n    container.appendChild(menubar.dom);\r\n\r\n    var resizer = new Resizer(editor);\r\n    container.appendChild(resizer.dom);\r\n\r\n    //\r\n\r\n    editor.storage.init(function () {\r\n\r\n        editor.storage.get(function (state) {\r\n\r\n            if (isLoadingFromHash) return;\r\n\r\n            if (state !== undefined) {\r\n\r\n                editor.fromJSON(state);\r\n\r\n            }\r\n\r\n            var selected = editor.config.getKey('selected');\r\n\r\n            if (selected !== undefined) {\r\n\r\n                editor.selectByUuid(selected);\r\n\r\n            }\r\n\r\n        });\r\n\r\n        //\r\n\r\n        var timeout;\r\n\r\n        function saveState() {\r\n\r\n            if (editor.config.getKey('autosave') === false) {\r\n\r\n                return;\r\n\r\n            }\r\n\r\n            clearTimeout(timeout);\r\n\r\n            timeout = setTimeout(function () {\r\n\r\n                editor.signals.savingStarted.dispatch();\r\n\r\n                timeout = setTimeout(function () {\r\n\r\n                    editor.storage.set(editor.toJSON());\r\n\r\n                    editor.signals.savingFinished.dispatch();\r\n\r\n                }, 100);\r\n\r\n            }, 1000);\r\n\r\n        }\r\n\r\n        var signals = editor.signals;\r\n\r\n        signals.geometryChanged.add(saveState);\r\n        signals.objectAdded.add(saveState);\r\n        signals.objectChanged.add(saveState);\r\n        signals.objectRemoved.add(saveState);\r\n        signals.materialChanged.add(saveState);\r\n        signals.sceneBackgroundChanged.add(saveState);\r\n        signals.sceneEnvironmentChanged.add(saveState);\r\n        signals.sceneFogChanged.add(saveState);\r\n        signals.sceneGraphChanged.add(saveState);\r\n        signals.scriptChanged.add(saveState);\r\n        signals.historyChanged.add(saveState);\r\n\r\n    });\r\n\r\n    //\r\n\r\n    document.addEventListener('dragover', function (event) {\r\n\r\n        event.preventDefault();\r\n        event.dataTransfer.dropEffect = 'copy';\r\n\r\n    }, false);\r\n\r\n    document.addEventListener('drop', function (event) {\r\n\r\n        event.preventDefault();\r\n\r\n        if (event.dataTransfer.types[0] === 'text/plain') return; // Outliner drop\r\n\r\n        if (event.dataTransfer.items) {\r\n\r\n            // DataTransferItemList supports folders\r\n\r\n            editor.loader.loadItemList(event.dataTransfer.items);\r\n\r\n        } else {\r\n\r\n            editor.loader.loadFiles(event.dataTransfer.files);\r\n\r\n        }\r\n\r\n    }, false);\r\n\r\n    function onWindowResize() {\r\n\r\n        editor.signals.windowResize.dispatch();\r\n\r\n    }\r\n\r\n    window.addEventListener('resize', onWindowResize, false);\r\n\r\n    onWindowResize();\r\n\r\n    //\r\n\r\n    var isLoadingFromHash = false;\r\n    var hash = window.location.hash;\r\n\r\n    if (hash.substr(1, 5) === 'file=') {\r\n\r\n        var file = hash.substr(6);\r\n\r\n        if (window.confirm('Any unsaved data will be lost. Are you sure?')) {\r\n\r\n            var loader = new THREE.FileLoader();\r\n            loader.crossOrigin = '';\r\n            loader.load(file, function (text) {\r\n\r\n                editor.clear();\r\n                editor.fromJSON(JSON.parse(text));\r\n\r\n            });\r\n\r\n            isLoadingFromHash = true;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    return { editor, viewport, toolbar, sidebar, menubar, resizer }\r\n}\r\n\r\n","import React from 'react';\r\nimport './App.css';\r\nimport ThreeEditor from './ThreeEditor/ThreeEditor';\r\nimport JsRoot from './JsRoot/JsRoot';\r\nimport ZoneManagerPanel from './components/ZoneManagerPanel/ZoneManagerPanel';\r\n\r\n\r\n\r\nfunction App() {\r\n  return (<>\r\n    {/* <JsRoot></JsRoot> */}\r\n\r\n    <ThreeEditor></ThreeEditor>\r\n  </>);\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}